var mo=Object.defineProperty;var xo=(t,e,n)=>e in t?mo(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var kt=(t,e,n)=>xo(t,typeof e!="symbol"?e+"":e,n);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const i of o)if(i.type==="childList")for(const s of i.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&r(s)}).observe(document,{childList:!0,subtree:!0});function n(o){const i={};return o.integrity&&(i.integrity=o.integrity),o.referrerPolicy&&(i.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?i.credentials="include":o.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(o){if(o.ep)return;o.ep=!0;const i=n(o);fetch(o.href,i)}})();function Sn(t){if(!Number.isSafeInteger(t)||t<0)throw new Error(`Wrong positive integer: ${t}`)}function Wn(t,...e){if(!(t instanceof Uint8Array))throw new Error("Expected Uint8Array");if(e.length>0&&!e.includes(t.length))throw new Error(`Expected Uint8Array of length ${e}, not of length=${t.length}`)}function vo(t){if(typeof t!="function"||typeof t.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");Sn(t.outputLen),Sn(t.blockLen)}function Gt(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function Ao(t,e){Wn(t);const n=e.outputLen;if(t.length<n)throw new Error(`digestInto() expects output buffer of length at least ${n}`)}const ye=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */const zn=t=>t instanceof Uint8Array,we=t=>new DataView(t.buffer,t.byteOffset,t.byteLength),tt=(t,e)=>t<<32-e|t>>>e,Bo=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;if(!Bo)throw new Error("Non little-endian hardware is not supported");function So(t){if(typeof t!="string")throw new Error(`utf8ToBytes expected string, got ${typeof t}`);return new Uint8Array(new TextEncoder().encode(t))}function je(t){if(typeof t=="string"&&(t=So(t)),!zn(t))throw new Error(`expected Uint8Array, got ${typeof t}`);return t}function _o(...t){const e=new Uint8Array(t.reduce((r,o)=>r+o.length,0));let n=0;return t.forEach(r=>{if(!zn(r))throw new Error("Uint8Array expected");e.set(r,n),n+=r.length}),e}let Vn=class{clone(){return this._cloneInto()}};function Io(t){const e=r=>t().update(je(r)).digest(),n=t();return e.outputLen=n.outputLen,e.blockLen=n.blockLen,e.create=()=>t(),e}function Kn(t=32){if(ye&&typeof ye.getRandomValues=="function")return ye.getRandomValues(new Uint8Array(t));throw new Error("crypto.getRandomValues must be defined")}function Lo(t,e,n,r){if(typeof t.setBigUint64=="function")return t.setBigUint64(e,n,r);const o=BigInt(32),i=BigInt(4294967295),s=Number(n>>o&i),c=Number(n&i),a=r?4:0,l=r?0:4;t.setUint32(e+a,s,r),t.setUint32(e+l,c,r)}let $o=class extends Vn{constructor(e,n,r,o){super(),this.blockLen=e,this.outputLen=n,this.padOffset=r,this.isLE=o,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=we(this.buffer)}update(e){Gt(this);const{view:n,buffer:r,blockLen:o}=this;e=je(e);const i=e.length;for(let s=0;s<i;){const c=Math.min(o-this.pos,i-s);if(c===o){const a=we(e);for(;o<=i-s;s+=o)this.process(a,s);continue}r.set(e.subarray(s,s+c),this.pos),this.pos+=c,s+=c,this.pos===o&&(this.process(n,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){Gt(this),Ao(e,this),this.finished=!0;const{buffer:n,view:r,blockLen:o,isLE:i}=this;let{pos:s}=this;n[s++]=128,this.buffer.subarray(s).fill(0),this.padOffset>o-s&&(this.process(r,0),s=0);for(let f=s;f<o;f++)n[f]=0;Lo(r,o-8,BigInt(this.length*8),i),this.process(r,0);const c=we(e),a=this.outputLen;if(a%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const l=a/4,u=this.get();if(l>u.length)throw new Error("_sha2: outputLen bigger than state");for(let f=0;f<l;f++)c.setUint32(4*f,u[f],i)}digest(){const{buffer:e,outputLen:n}=this;this.digestInto(e);const r=e.slice(0,n);return this.destroy(),r}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:n,buffer:r,length:o,finished:i,destroyed:s,pos:c}=this;return e.length=o,e.pos=c,e.finished=i,e.destroyed=s,o%n&&e.buffer.set(r),e}};const ko=(t,e,n)=>t&e^~t&n,Uo=(t,e,n)=>t&e^t&n^e&n,To=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),ht=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),pt=new Uint32Array(64);let Ro=class extends $o{constructor(){super(64,32,8,!1),this.A=ht[0]|0,this.B=ht[1]|0,this.C=ht[2]|0,this.D=ht[3]|0,this.E=ht[4]|0,this.F=ht[5]|0,this.G=ht[6]|0,this.H=ht[7]|0}get(){const{A:e,B:n,C:r,D:o,E:i,F:s,G:c,H:a}=this;return[e,n,r,o,i,s,c,a]}set(e,n,r,o,i,s,c,a){this.A=e|0,this.B=n|0,this.C=r|0,this.D=o|0,this.E=i|0,this.F=s|0,this.G=c|0,this.H=a|0}process(e,n){for(let f=0;f<16;f++,n+=4)pt[f]=e.getUint32(n,!1);for(let f=16;f<64;f++){const w=pt[f-15],b=pt[f-2],y=tt(w,7)^tt(w,18)^w>>>3,d=tt(b,17)^tt(b,19)^b>>>10;pt[f]=d+pt[f-7]+y+pt[f-16]|0}let{A:r,B:o,C:i,D:s,E:c,F:a,G:l,H:u}=this;for(let f=0;f<64;f++){const w=tt(c,6)^tt(c,11)^tt(c,25),b=u+w+ko(c,a,l)+To[f]+pt[f]|0,d=(tt(r,2)^tt(r,13)^tt(r,22))+Uo(r,o,i)|0;u=l,l=a,a=c,c=s+b|0,s=i,i=o,o=r,r=b+d|0}r=r+this.A|0,o=o+this.B|0,i=i+this.C|0,s=s+this.D|0,c=c+this.E|0,a=a+this.F|0,l=l+this.G|0,u=u+this.H|0,this.set(r,o,i,s,c,a,l,u)}roundClean(){pt.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}};const Le=Io(()=>new Ro);/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Zn=BigInt(0),ee=BigInt(1),No=BigInt(2),ne=t=>t instanceof Uint8Array,Co=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function Rt(t){if(!ne(t))throw new Error("Uint8Array expected");let e="";for(let n=0;n<t.length;n++)e+=Co[t[n]];return e}function Fn(t){const e=t.toString(16);return e.length&1?`0${e}`:e}function De(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);return BigInt(t===""?"0":`0x${t}`)}function Nt(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);const e=t.length;if(e%2)throw new Error("padded hex string expected, got unpadded hex of length "+e);const n=new Uint8Array(e/2);for(let r=0;r<n.length;r++){const o=r*2,i=t.slice(o,o+2),s=Number.parseInt(i,16);if(Number.isNaN(s)||s<0)throw new Error("Invalid byte sequence");n[r]=s}return n}function Z(t){return De(Rt(t))}function We(t){if(!ne(t))throw new Error("Uint8Array expected");return De(Rt(Uint8Array.from(t).reverse()))}function Et(t,e){return Nt(t.toString(16).padStart(e*2,"0"))}function ze(t,e){return Et(t,e).reverse()}function Oo(t){return Nt(Fn(t))}function z(t,e,n){let r;if(typeof e=="string")try{r=Nt(e)}catch(i){throw new Error(`${t} must be valid hex string, got "${e}". Cause: ${i}`)}else if(ne(e))r=Uint8Array.from(e);else throw new Error(`${t} must be hex string or Uint8Array`);const o=r.length;if(typeof n=="number"&&o!==n)throw new Error(`${t} expected ${n} bytes, got ${o}`);return r}function Bt(...t){const e=new Uint8Array(t.reduce((r,o)=>r+o.length,0));let n=0;return t.forEach(r=>{if(!ne(r))throw new Error("Uint8Array expected");e.set(r,n),n+=r.length}),e}function Ho(t,e){if(t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}function Mo(t){if(typeof t!="string")throw new Error(`utf8ToBytes expected string, got ${typeof t}`);return new Uint8Array(new TextEncoder().encode(t))}function Po(t){let e;for(e=0;t>Zn;t>>=ee,e+=1);return e}function qo(t,e){return t>>BigInt(e)&ee}const jo=(t,e,n)=>t|(n?ee:Zn)<<BigInt(e),Ve=t=>(No<<BigInt(t-1))-ee,be=t=>new Uint8Array(t),_n=t=>Uint8Array.from(t);function Gn(t,e,n){if(typeof t!="number"||t<2)throw new Error("hashLen must be a number");if(typeof e!="number"||e<2)throw new Error("qByteLen must be a number");if(typeof n!="function")throw new Error("hmacFn must be a function");let r=be(t),o=be(t),i=0;const s=()=>{r.fill(1),o.fill(0),i=0},c=(...f)=>n(o,r,...f),a=(f=be())=>{o=c(_n([0]),f),r=c(),f.length!==0&&(o=c(_n([1]),f),r=c())},l=()=>{if(i++>=1e3)throw new Error("drbg: tried 1000 values");let f=0;const w=[];for(;f<e;){r=c();const b=r.slice();w.push(b),f+=r.length}return Bt(...w)};return(f,w)=>{s(),a(f);let b;for(;!(b=w(l()));)a();return s(),b}}const Do={bigint:t=>typeof t=="bigint",function:t=>typeof t=="function",boolean:t=>typeof t=="boolean",string:t=>typeof t=="string",stringOrUint8Array:t=>typeof t=="string"||t instanceof Uint8Array,isSafeInteger:t=>Number.isSafeInteger(t),array:t=>Array.isArray(t),field:(t,e)=>e.Fp.isValid(t),hash:t=>typeof t=="function"&&Number.isSafeInteger(t.outputLen)};function Vt(t,e,n={}){const r=(o,i,s)=>{const c=Do[i];if(typeof c!="function")throw new Error(`Invalid validator "${i}", expected function`);const a=t[o];if(!(s&&a===void 0)&&!c(a,t))throw new Error(`Invalid param ${String(o)}=${a} (${typeof a}), expected ${i}`)};for(const[o,i]of Object.entries(e))r(o,i,!1);for(const[o,i]of Object.entries(n))r(o,i,!0);return t}const Wo=Object.freeze(Object.defineProperty({__proto__:null,bitGet:qo,bitLen:Po,bitMask:Ve,bitSet:jo,bytesToHex:Rt,bytesToNumberBE:Z,bytesToNumberLE:We,concatBytes:Bt,createHmacDrbg:Gn,ensureBytes:z,equalBytes:Ho,hexToBytes:Nt,hexToNumber:De,numberToBytesBE:Et,numberToBytesLE:ze,numberToHexUnpadded:Fn,numberToVarBytesBE:Oo,utf8ToBytes:Mo,validateObject:Vt},Symbol.toStringTag,{value:"Module"}));/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const D=BigInt(0),j=BigInt(1),vt=BigInt(2),zo=BigInt(3),$e=BigInt(4),In=BigInt(5),Ln=BigInt(8);BigInt(9);BigInt(16);function W(t,e){const n=t%e;return n>=D?n:e+n}function Vo(t,e,n){if(n<=D||e<D)throw new Error("Expected power/modulo > 0");if(n===j)return D;let r=j;for(;e>D;)e&j&&(r=r*t%n),t=t*t%n,e>>=j;return r}function F(t,e,n){let r=t;for(;e-- >D;)r*=r,r%=n;return r}function ke(t,e){if(t===D||e<=D)throw new Error(`invert: expected positive integers, got n=${t} mod=${e}`);let n=W(t,e),r=e,o=D,i=j;for(;n!==D;){const c=r/n,a=r%n,l=o-i*c;r=n,n=a,o=i,i=l}if(r!==j)throw new Error("invert: does not exist");return W(o,e)}function Ko(t){const e=(t-j)/vt;let n,r,o;for(n=t-j,r=0;n%vt===D;n/=vt,r++);for(o=vt;o<t&&Vo(o,e,t)!==t-j;o++);if(r===1){const s=(t+j)/$e;return function(a,l){const u=a.pow(l,s);if(!a.eql(a.sqr(u),l))throw new Error("Cannot find square root");return u}}const i=(n+j)/vt;return function(c,a){if(c.pow(a,e)===c.neg(c.ONE))throw new Error("Cannot find square root");let l=r,u=c.pow(c.mul(c.ONE,o),n),f=c.pow(a,i),w=c.pow(a,n);for(;!c.eql(w,c.ONE);){if(c.eql(w,c.ZERO))return c.ZERO;let b=1;for(let d=c.sqr(w);b<l&&!c.eql(d,c.ONE);b++)d=c.sqr(d);const y=c.pow(u,j<<BigInt(l-b-1));u=c.sqr(y),f=c.mul(f,y),w=c.mul(w,u),l=b}return f}}function Zo(t){if(t%$e===zo){const e=(t+j)/$e;return function(r,o){const i=r.pow(o,e);if(!r.eql(r.sqr(i),o))throw new Error("Cannot find square root");return i}}if(t%Ln===In){const e=(t-In)/Ln;return function(r,o){const i=r.mul(o,vt),s=r.pow(i,e),c=r.mul(o,s),a=r.mul(r.mul(c,vt),s),l=r.mul(c,r.sub(a,r.ONE));if(!r.eql(r.sqr(l),o))throw new Error("Cannot find square root");return l}}return Ko(t)}const Fo=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function Go(t){const e={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},n=Fo.reduce((r,o)=>(r[o]="function",r),e);return Vt(t,n)}function Jo(t,e,n){if(n<D)throw new Error("Expected power > 0");if(n===D)return t.ONE;if(n===j)return e;let r=t.ONE,o=e;for(;n>D;)n&j&&(r=t.mul(r,o)),o=t.sqr(o),n>>=j;return r}function Yo(t,e){const n=new Array(e.length),r=e.reduce((i,s,c)=>t.is0(s)?i:(n[c]=i,t.mul(i,s)),t.ONE),o=t.inv(r);return e.reduceRight((i,s,c)=>t.is0(s)?i:(n[c]=t.mul(i,n[c]),t.mul(i,s)),o),n}function Jn(t,e){const n=e!==void 0?e:t.toString(2).length,r=Math.ceil(n/8);return{nBitLength:n,nByteLength:r}}function Xo(t,e,n=!1,r={}){if(t<=D)throw new Error(`Expected Field ORDER > 0, got ${t}`);const{nBitLength:o,nByteLength:i}=Jn(t,e);if(i>2048)throw new Error("Field lengths over 2048 bytes are not supported");const s=Zo(t),c=Object.freeze({ORDER:t,BITS:o,BYTES:i,MASK:Ve(o),ZERO:D,ONE:j,create:a=>W(a,t),isValid:a=>{if(typeof a!="bigint")throw new Error(`Invalid field element: expected bigint, got ${typeof a}`);return D<=a&&a<t},is0:a=>a===D,isOdd:a=>(a&j)===j,neg:a=>W(-a,t),eql:(a,l)=>a===l,sqr:a=>W(a*a,t),add:(a,l)=>W(a+l,t),sub:(a,l)=>W(a-l,t),mul:(a,l)=>W(a*l,t),pow:(a,l)=>Jo(c,a,l),div:(a,l)=>W(a*ke(l,t),t),sqrN:a=>a*a,addN:(a,l)=>a+l,subN:(a,l)=>a-l,mulN:(a,l)=>a*l,inv:a=>ke(a,t),sqrt:r.sqrt||(a=>s(c,a)),invertBatch:a=>Yo(c,a),cmov:(a,l,u)=>u?l:a,toBytes:a=>n?ze(a,i):Et(a,i),fromBytes:a=>{if(a.length!==i)throw new Error(`Fp.fromBytes: expected ${i}, got ${a.length}`);return n?We(a):Z(a)}});return Object.freeze(c)}function Yn(t){if(typeof t!="bigint")throw new Error("field order must be bigint");const e=t.toString(2).length;return Math.ceil(e/8)}function Xn(t){const e=Yn(t);return e+Math.ceil(e/2)}function Qo(t,e,n=!1){const r=t.length,o=Yn(e),i=Xn(e);if(r<16||r<i||r>1024)throw new Error(`expected ${i}-1024 bytes of input, got ${r}`);const s=n?Z(t):We(t),c=W(s,e-j)+j;return n?ze(c,o):Et(c,o)}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const ti=BigInt(0),Ee=BigInt(1);function ei(t,e){const n=(o,i)=>{const s=i.negate();return o?s:i},r=o=>{const i=Math.ceil(e/o)+1,s=2**(o-1);return{windows:i,windowSize:s}};return{constTimeNegate:n,unsafeLadder(o,i){let s=t.ZERO,c=o;for(;i>ti;)i&Ee&&(s=s.add(c)),c=c.double(),i>>=Ee;return s},precomputeWindow(o,i){const{windows:s,windowSize:c}=r(i),a=[];let l=o,u=l;for(let f=0;f<s;f++){u=l,a.push(u);for(let w=1;w<c;w++)u=u.add(l),a.push(u);l=u.double()}return a},wNAF(o,i,s){const{windows:c,windowSize:a}=r(o);let l=t.ZERO,u=t.BASE;const f=BigInt(2**o-1),w=2**o,b=BigInt(o);for(let y=0;y<c;y++){const d=y*a;let h=Number(s&f);s>>=b,h>a&&(h-=w,s+=Ee);const p=d,x=d+Math.abs(h)-1,S=y%2!==0,U=h<0;h===0?u=u.add(n(S,i[p])):l=l.add(n(U,i[x]))}return{p:l,f:u}},wNAFCached(o,i,s,c){const a=o._WINDOW_SIZE||1;let l=i.get(o);return l||(l=this.precomputeWindow(o,a),a!==1&&i.set(o,c(l))),this.wNAF(a,l,s)}}}function Qn(t){return Go(t.Fp),Vt(t,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...Jn(t.n,t.nBitLength),...t,p:t.Fp.ORDER})}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */function ni(t){const e=Qn(t);Vt(e,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});const{endo:n,Fp:r,a:o}=e;if(n){if(!r.eql(o,r.ZERO))throw new Error("Endomorphism can only be defined for Koblitz curves that have a=0");if(typeof n!="object"||typeof n.beta!="bigint"||typeof n.splitScalar!="function")throw new Error("Expected endomorphism with beta: bigint and splitScalar: function")}return Object.freeze({...e})}const{bytesToNumberBE:ri,hexToBytes:oi}=Wo,At={Err:class extends Error{constructor(e=""){super(e)}},_parseInt(t){const{Err:e}=At;if(t.length<2||t[0]!==2)throw new e("Invalid signature integer tag");const n=t[1],r=t.subarray(2,n+2);if(!n||r.length!==n)throw new e("Invalid signature integer: wrong length");if(r[0]&128)throw new e("Invalid signature integer: negative");if(r[0]===0&&!(r[1]&128))throw new e("Invalid signature integer: unnecessary leading zero");return{d:ri(r),l:t.subarray(n+2)}},toSig(t){const{Err:e}=At,n=typeof t=="string"?oi(t):t;if(!(n instanceof Uint8Array))throw new Error("ui8a expected");let r=n.length;if(r<2||n[0]!=48)throw new e("Invalid signature tag");if(n[1]!==r-2)throw new e("Invalid signature: incorrect length");const{d:o,l:i}=At._parseInt(n.subarray(2)),{d:s,l:c}=At._parseInt(i);if(c.length)throw new e("Invalid signature: left bytes after parsing");return{r:o,s}},hexFromSig(t){const e=l=>Number.parseInt(l[0],16)&8?"00"+l:l,n=l=>{const u=l.toString(16);return u.length&1?`0${u}`:u},r=e(n(t.s)),o=e(n(t.r)),i=r.length/2,s=o.length/2,c=n(i),a=n(s);return`30${n(s+i+4)}02${a}${o}02${c}${r}`}},ot=BigInt(0),G=BigInt(1);BigInt(2);const $n=BigInt(3);BigInt(4);function ii(t){const e=ni(t),{Fp:n}=e,r=e.toBytes||((y,d,h)=>{const p=d.toAffine();return Bt(Uint8Array.from([4]),n.toBytes(p.x),n.toBytes(p.y))}),o=e.fromBytes||(y=>{const d=y.subarray(1),h=n.fromBytes(d.subarray(0,n.BYTES)),p=n.fromBytes(d.subarray(n.BYTES,2*n.BYTES));return{x:h,y:p}});function i(y){const{a:d,b:h}=e,p=n.sqr(y),x=n.mul(p,y);return n.add(n.add(x,n.mul(y,d)),h)}if(!n.eql(n.sqr(e.Gy),i(e.Gx)))throw new Error("bad generator point: equation left != right");function s(y){return typeof y=="bigint"&&ot<y&&y<e.n}function c(y){if(!s(y))throw new Error("Expected valid bigint: 0 < bigint < curve.n")}function a(y){const{allowedPrivateKeyLengths:d,nByteLength:h,wrapPrivateKey:p,n:x}=e;if(d&&typeof y!="bigint"){if(y instanceof Uint8Array&&(y=Rt(y)),typeof y!="string"||!d.includes(y.length))throw new Error("Invalid key");y=y.padStart(h*2,"0")}let S;try{S=typeof y=="bigint"?y:Z(z("private key",y,h))}catch{throw new Error(`private key must be ${h} bytes, hex or bigint, not ${typeof y}`)}return p&&(S=W(S,x)),c(S),S}const l=new Map;function u(y){if(!(y instanceof f))throw new Error("ProjectivePoint expected")}class f{constructor(d,h,p){if(this.px=d,this.py=h,this.pz=p,d==null||!n.isValid(d))throw new Error("x required");if(h==null||!n.isValid(h))throw new Error("y required");if(p==null||!n.isValid(p))throw new Error("z required")}static fromAffine(d){const{x:h,y:p}=d||{};if(!d||!n.isValid(h)||!n.isValid(p))throw new Error("invalid affine point");if(d instanceof f)throw new Error("projective point not allowed");const x=S=>n.eql(S,n.ZERO);return x(h)&&x(p)?f.ZERO:new f(h,p,n.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(d){const h=n.invertBatch(d.map(p=>p.pz));return d.map((p,x)=>p.toAffine(h[x])).map(f.fromAffine)}static fromHex(d){const h=f.fromAffine(o(z("pointHex",d)));return h.assertValidity(),h}static fromPrivateKey(d){return f.BASE.multiply(a(d))}_setWindowSize(d){this._WINDOW_SIZE=d,l.delete(this)}assertValidity(){if(this.is0()){if(e.allowInfinityPoint&&!n.is0(this.py))return;throw new Error("bad point: ZERO")}const{x:d,y:h}=this.toAffine();if(!n.isValid(d)||!n.isValid(h))throw new Error("bad point: x or y not FE");const p=n.sqr(h),x=i(d);if(!n.eql(p,x))throw new Error("bad point: equation left != right");if(!this.isTorsionFree())throw new Error("bad point: not in prime-order subgroup")}hasEvenY(){const{y:d}=this.toAffine();if(n.isOdd)return!n.isOdd(d);throw new Error("Field doesn't support isOdd")}equals(d){u(d);const{px:h,py:p,pz:x}=this,{px:S,py:U,pz:L}=d,m=n.eql(n.mul(h,L),n.mul(S,x)),v=n.eql(n.mul(p,L),n.mul(U,x));return m&&v}negate(){return new f(this.px,n.neg(this.py),this.pz)}double(){const{a:d,b:h}=e,p=n.mul(h,$n),{px:x,py:S,pz:U}=this;let L=n.ZERO,m=n.ZERO,v=n.ZERO,A=n.mul(x,x),M=n.mul(S,S),k=n.mul(U,U),_=n.mul(x,S);return _=n.add(_,_),v=n.mul(x,U),v=n.add(v,v),L=n.mul(d,v),m=n.mul(p,k),m=n.add(L,m),L=n.sub(M,m),m=n.add(M,m),m=n.mul(L,m),L=n.mul(_,L),v=n.mul(p,v),k=n.mul(d,k),_=n.sub(A,k),_=n.mul(d,_),_=n.add(_,v),v=n.add(A,A),A=n.add(v,A),A=n.add(A,k),A=n.mul(A,_),m=n.add(m,A),k=n.mul(S,U),k=n.add(k,k),A=n.mul(k,_),L=n.sub(L,A),v=n.mul(k,M),v=n.add(v,v),v=n.add(v,v),new f(L,m,v)}add(d){u(d);const{px:h,py:p,pz:x}=this,{px:S,py:U,pz:L}=d;let m=n.ZERO,v=n.ZERO,A=n.ZERO;const M=e.a,k=n.mul(e.b,$n);let _=n.mul(h,S),C=n.mul(p,U),O=n.mul(x,L),q=n.add(h,p),g=n.add(S,U);q=n.mul(q,g),g=n.add(_,C),q=n.sub(q,g),g=n.add(h,x);let E=n.add(S,L);return g=n.mul(g,E),E=n.add(_,O),g=n.sub(g,E),E=n.add(p,x),m=n.add(U,L),E=n.mul(E,m),m=n.add(C,O),E=n.sub(E,m),A=n.mul(M,g),m=n.mul(k,O),A=n.add(m,A),m=n.sub(C,A),A=n.add(C,A),v=n.mul(m,A),C=n.add(_,_),C=n.add(C,_),O=n.mul(M,O),g=n.mul(k,g),C=n.add(C,O),O=n.sub(_,O),O=n.mul(M,O),g=n.add(g,O),_=n.mul(C,g),v=n.add(v,_),_=n.mul(E,g),m=n.mul(q,m),m=n.sub(m,_),_=n.mul(q,C),A=n.mul(E,A),A=n.add(A,_),new f(m,v,A)}subtract(d){return this.add(d.negate())}is0(){return this.equals(f.ZERO)}wNAF(d){return b.wNAFCached(this,l,d,h=>{const p=n.invertBatch(h.map(x=>x.pz));return h.map((x,S)=>x.toAffine(p[S])).map(f.fromAffine)})}multiplyUnsafe(d){const h=f.ZERO;if(d===ot)return h;if(c(d),d===G)return this;const{endo:p}=e;if(!p)return b.unsafeLadder(this,d);let{k1neg:x,k1:S,k2neg:U,k2:L}=p.splitScalar(d),m=h,v=h,A=this;for(;S>ot||L>ot;)S&G&&(m=m.add(A)),L&G&&(v=v.add(A)),A=A.double(),S>>=G,L>>=G;return x&&(m=m.negate()),U&&(v=v.negate()),v=new f(n.mul(v.px,p.beta),v.py,v.pz),m.add(v)}multiply(d){c(d);let h=d,p,x;const{endo:S}=e;if(S){const{k1neg:U,k1:L,k2neg:m,k2:v}=S.splitScalar(h);let{p:A,f:M}=this.wNAF(L),{p:k,f:_}=this.wNAF(v);A=b.constTimeNegate(U,A),k=b.constTimeNegate(m,k),k=new f(n.mul(k.px,S.beta),k.py,k.pz),p=A.add(k),x=M.add(_)}else{const{p:U,f:L}=this.wNAF(h);p=U,x=L}return f.normalizeZ([p,x])[0]}multiplyAndAddUnsafe(d,h,p){const x=f.BASE,S=(L,m)=>m===ot||m===G||!L.equals(x)?L.multiplyUnsafe(m):L.multiply(m),U=S(this,h).add(S(d,p));return U.is0()?void 0:U}toAffine(d){const{px:h,py:p,pz:x}=this,S=this.is0();d==null&&(d=S?n.ONE:n.inv(x));const U=n.mul(h,d),L=n.mul(p,d),m=n.mul(x,d);if(S)return{x:n.ZERO,y:n.ZERO};if(!n.eql(m,n.ONE))throw new Error("invZ was invalid");return{x:U,y:L}}isTorsionFree(){const{h:d,isTorsionFree:h}=e;if(d===G)return!0;if(h)return h(f,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){const{h:d,clearCofactor:h}=e;return d===G?this:h?h(f,this):this.multiplyUnsafe(e.h)}toRawBytes(d=!0){return this.assertValidity(),r(f,this,d)}toHex(d=!0){return Rt(this.toRawBytes(d))}}f.BASE=new f(e.Gx,e.Gy,n.ONE),f.ZERO=new f(n.ZERO,n.ONE,n.ZERO);const w=e.nBitLength,b=ei(f,e.endo?Math.ceil(w/2):w);return{CURVE:e,ProjectivePoint:f,normPrivateKeyToScalar:a,weierstrassEquation:i,isWithinCurveOrder:s}}function si(t){const e=Qn(t);return Vt(e,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...e})}function ai(t){const e=si(t),{Fp:n,n:r}=e,o=n.BYTES+1,i=2*n.BYTES+1;function s(g){return ot<g&&g<n.ORDER}function c(g){return W(g,r)}function a(g){return ke(g,r)}const{ProjectivePoint:l,normPrivateKeyToScalar:u,weierstrassEquation:f,isWithinCurveOrder:w}=ii({...e,toBytes(g,E,B){const $=E.toAffine(),I=n.toBytes($.x),T=Bt;return B?T(Uint8Array.from([E.hasEvenY()?2:3]),I):T(Uint8Array.from([4]),I,n.toBytes($.y))},fromBytes(g){const E=g.length,B=g[0],$=g.subarray(1);if(E===o&&(B===2||B===3)){const I=Z($);if(!s(I))throw new Error("Point is not on curve");const T=f(I);let H=n.sqrt(T);const N=(H&G)===G;return(B&1)===1!==N&&(H=n.neg(H)),{x:I,y:H}}else if(E===i&&B===4){const I=n.fromBytes($.subarray(0,n.BYTES)),T=n.fromBytes($.subarray(n.BYTES,2*n.BYTES));return{x:I,y:T}}else throw new Error(`Point of length ${E} was invalid. Expected ${o} compressed bytes or ${i} uncompressed bytes`)}}),b=g=>Rt(Et(g,e.nByteLength));function y(g){const E=r>>G;return g>E}function d(g){return y(g)?c(-g):g}const h=(g,E,B)=>Z(g.slice(E,B));class p{constructor(E,B,$){this.r=E,this.s=B,this.recovery=$,this.assertValidity()}static fromCompact(E){const B=e.nByteLength;return E=z("compactSignature",E,B*2),new p(h(E,0,B),h(E,B,2*B))}static fromDER(E){const{r:B,s:$}=At.toSig(z("DER",E));return new p(B,$)}assertValidity(){if(!w(this.r))throw new Error("r must be 0 < r < CURVE.n");if(!w(this.s))throw new Error("s must be 0 < s < CURVE.n")}addRecoveryBit(E){return new p(this.r,this.s,E)}recoverPublicKey(E){const{r:B,s:$,recovery:I}=this,T=v(z("msgHash",E));if(I==null||![0,1,2,3].includes(I))throw new Error("recovery id invalid");const H=I===2||I===3?B+e.n:B;if(H>=n.ORDER)throw new Error("recovery id 2 or 3 invalid");const N=I&1?"03":"02",J=l.fromHex(N+b(H)),ut=a(H),_t=c(-T*ut),Pt=c($*ut),dt=l.BASE.multiplyAndAddUnsafe(J,_t,Pt);if(!dt)throw new Error("point at infinify");return dt.assertValidity(),dt}hasHighS(){return y(this.s)}normalizeS(){return this.hasHighS()?new p(this.r,c(-this.s),this.recovery):this}toDERRawBytes(){return Nt(this.toDERHex())}toDERHex(){return At.hexFromSig({r:this.r,s:this.s})}toCompactRawBytes(){return Nt(this.toCompactHex())}toCompactHex(){return b(this.r)+b(this.s)}}const x={isValidPrivateKey(g){try{return u(g),!0}catch{return!1}},normPrivateKeyToScalar:u,randomPrivateKey:()=>{const g=Xn(e.n);return Qo(e.randomBytes(g),e.n)},precompute(g=8,E=l.BASE){return E._setWindowSize(g),E.multiply(BigInt(3)),E}};function S(g,E=!0){return l.fromPrivateKey(g).toRawBytes(E)}function U(g){const E=g instanceof Uint8Array,B=typeof g=="string",$=(E||B)&&g.length;return E?$===o||$===i:B?$===2*o||$===2*i:g instanceof l}function L(g,E,B=!0){if(U(g))throw new Error("first arg must be private key");if(!U(E))throw new Error("second arg must be public key");return l.fromHex(E).multiply(u(g)).toRawBytes(B)}const m=e.bits2int||function(g){const E=Z(g),B=g.length*8-e.nBitLength;return B>0?E>>BigInt(B):E},v=e.bits2int_modN||function(g){return c(m(g))},A=Ve(e.nBitLength);function M(g){if(typeof g!="bigint")throw new Error("bigint expected");if(!(ot<=g&&g<A))throw new Error(`bigint expected < 2^${e.nBitLength}`);return Et(g,e.nByteLength)}function k(g,E,B=_){if(["recovered","canonical"].some(xt=>xt in B))throw new Error("sign() legacy options not supported");const{hash:$,randomBytes:I}=e;let{lowS:T,prehash:H,extraEntropy:N}=B;T==null&&(T=!0),g=z("msgHash",g),H&&(g=z("prehashed msgHash",$(g)));const J=v(g),ut=u(E),_t=[M(ut),M(J)];if(N!=null){const xt=N===!0?I(n.BYTES):N;_t.push(z("extraEntropy",xt))}const Pt=Bt(..._t),dt=J;function ge(xt){const It=m(xt);if(!w(It))return;const vn=a(It),Lt=l.BASE.multiply(It).toAffine(),Y=c(Lt.x);if(Y===ot)return;const $t=c(vn*c(dt+Y*ut));if($t===ot)return;let An=(Lt.x===Y?0:2)|Number(Lt.y&G),Bn=$t;return T&&y($t)&&(Bn=d($t),An^=1),new p(Y,Bn,An)}return{seed:Pt,k2sig:ge}}const _={lowS:e.lowS,prehash:!1},C={lowS:e.lowS,prehash:!1};function O(g,E,B=_){const{seed:$,k2sig:I}=k(g,E,B),T=e;return Gn(T.hash.outputLen,T.nByteLength,T.hmac)($,I)}l.BASE._setWindowSize(8);function q(g,E,B,$=C){var Lt;const I=g;if(E=z("msgHash",E),B=z("publicKey",B),"strict"in $)throw new Error("options.strict was renamed to lowS");const{lowS:T,prehash:H}=$;let N,J;try{if(typeof I=="string"||I instanceof Uint8Array)try{N=p.fromDER(I)}catch(Y){if(!(Y instanceof At.Err))throw Y;N=p.fromCompact(I)}else if(typeof I=="object"&&typeof I.r=="bigint"&&typeof I.s=="bigint"){const{r:Y,s:$t}=I;N=new p(Y,$t)}else throw new Error("PARSE");J=l.fromHex(B)}catch(Y){if(Y.message==="PARSE")throw new Error("signature must be Signature instance, Uint8Array or hex string");return!1}if(T&&N.hasHighS())return!1;H&&(E=e.hash(E));const{r:ut,s:_t}=N,Pt=v(E),dt=a(_t),ge=c(Pt*dt),xt=c(ut*dt),It=(Lt=l.BASE.multiplyAndAddUnsafe(J,ge,xt))==null?void 0:Lt.toAffine();return It?c(It.x)===ut:!1}return{CURVE:e,getPublicKey:S,getSharedSecret:L,sign:O,verify:q,ProjectivePoint:l,Signature:p,utils:x}}let tr=class extends Vn{constructor(e,n){super(),this.finished=!1,this.destroyed=!1,vo(e);const r=je(n);if(this.iHash=e.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const o=this.blockLen,i=new Uint8Array(o);i.set(r.length>o?e.create().update(r).digest():r);for(let s=0;s<i.length;s++)i[s]^=54;this.iHash.update(i),this.oHash=e.create();for(let s=0;s<i.length;s++)i[s]^=106;this.oHash.update(i),i.fill(0)}update(e){return Gt(this),this.iHash.update(e),this}digestInto(e){Gt(this),Wn(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){const e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));const{oHash:n,iHash:r,finished:o,destroyed:i,blockLen:s,outputLen:c}=this;return e=e,e.finished=o,e.destroyed=i,e.blockLen=s,e.outputLen=c,e.oHash=n._cloneInto(e.oHash),e.iHash=r._cloneInto(e.iHash),e}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}};const er=(t,e,n)=>new tr(t,e).update(n).digest();er.create=(t,e)=>new tr(t,e);/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */function ci(t){return{hash:t,hmac:(e,...n)=>er(t,e,_o(...n)),randomBytes:Kn}}function fi(t,e){const n=r=>ai({...t,...ci(r)});return Object.freeze({...n(e),create:n})}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const re=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),Jt=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),nr=BigInt(1),Yt=BigInt(2),kn=(t,e)=>(t+e/Yt)/e;function rr(t){const e=re,n=BigInt(3),r=BigInt(6),o=BigInt(11),i=BigInt(22),s=BigInt(23),c=BigInt(44),a=BigInt(88),l=t*t*t%e,u=l*l*t%e,f=F(u,n,e)*u%e,w=F(f,n,e)*u%e,b=F(w,Yt,e)*l%e,y=F(b,o,e)*b%e,d=F(y,i,e)*y%e,h=F(d,c,e)*d%e,p=F(h,a,e)*h%e,x=F(p,c,e)*d%e,S=F(x,n,e)*u%e,U=F(S,s,e)*y%e,L=F(U,r,e)*l%e,m=F(L,Yt,e);if(!Ue.eql(Ue.sqr(m),t))throw new Error("Cannot find square root");return m}const Ue=Xo(re,void 0,void 0,{sqrt:rr}),Ot=fi({a:BigInt(0),b:BigInt(7),Fp:Ue,n:Jt,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:t=>{const e=Jt,n=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),r=-nr*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),o=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),i=n,s=BigInt("0x100000000000000000000000000000000"),c=kn(i*t,e),a=kn(-r*t,e);let l=W(t-c*n-a*o,e),u=W(-c*r-a*i,e);const f=l>s,w=u>s;if(f&&(l=e-l),w&&(u=e-u),l>s||u>s)throw new Error("splitScalar: Endomorphism failed, k="+t);return{k1neg:f,k1:l,k2neg:w,k2:u}}}},Le),oe=BigInt(0),or=t=>typeof t=="bigint"&&oe<t&&t<re,li=t=>typeof t=="bigint"&&oe<t&&t<Jt,Un={};function Xt(t,...e){let n=Un[t];if(n===void 0){const r=Le(Uint8Array.from(t,o=>o.charCodeAt(0)));n=Bt(r,r),Un[t]=n}return Le(Bt(n,...e))}const Ke=t=>t.toRawBytes(!0).slice(1),Te=t=>Et(t,32),me=t=>W(t,re),Dt=t=>W(t,Jt),Ze=Ot.ProjectivePoint,ui=(t,e,n)=>Ze.BASE.multiplyAndAddUnsafe(t,e,n);function Re(t){let e=Ot.utils.normPrivateKeyToScalar(t),n=Ze.fromPrivateKey(e);return{scalar:n.hasEvenY()?e:Dt(-e),bytes:Ke(n)}}function ir(t){if(!or(t))throw new Error("bad x: need 0 < x < p");const e=me(t*t),n=me(e*t+BigInt(7));let r=rr(n);r%Yt!==oe&&(r=me(-r));const o=new Ze(t,r,nr);return o.assertValidity(),o}function sr(...t){return Dt(Z(Xt("BIP0340/challenge",...t)))}function di(t){return Re(t).bytes}function hi(t,e,n=Kn(32)){const r=z("message",t),{bytes:o,scalar:i}=Re(e),s=z("auxRand",n,32),c=Te(i^Z(Xt("BIP0340/aux",s))),a=Xt("BIP0340/nonce",c,o,r),l=Dt(Z(a));if(l===oe)throw new Error("sign failed: k is zero");const{bytes:u,scalar:f}=Re(l),w=sr(u,o,r),b=new Uint8Array(64);if(b.set(u,0),b.set(Te(Dt(f+w*i)),32),!ar(b,r,o))throw new Error("sign: Invalid signature produced");return b}function ar(t,e,n){const r=z("signature",t,64),o=z("message",e),i=z("publicKey",n,32);try{const s=ir(Z(i)),c=Z(r.subarray(0,32));if(!or(c))return!1;const a=Z(r.subarray(32,64));if(!li(a))return!1;const l=sr(Te(c),Ke(s),o),u=ui(s,a,Dt(-l));return!(!u||!u.hasEvenY()||u.toAffine().x!==c)}catch{return!1}}const qt={getPublicKey:di,sign:hi,verify:ar,utils:{randomPrivateKey:Ot.utils.randomPrivateKey,lift_x:ir,pointToBytes:Ke,numberToBytesBE:Et,bytesToNumberBE:Z,taggedHash:Xt,mod:W}},xe=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Fe=t=>t instanceof Uint8Array,ve=t=>new DataView(t.buffer,t.byteOffset,t.byteLength),et=(t,e)=>t<<32-e|t>>>e,pi=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;if(!pi)throw new Error("Non little-endian hardware is not supported");const gi=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function V(t){if(!Fe(t))throw new Error("Uint8Array expected");let e="";for(let n=0;n<t.length;n++)e+=gi[t[n]];return e}function St(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);const e=t.length;if(e%2)throw new Error("padded hex string expected, got unpadded hex of length "+e);const n=new Uint8Array(e/2);for(let r=0;r<n.length;r++){const o=r*2,i=t.slice(o,o+2),s=Number.parseInt(i,16);if(Number.isNaN(s)||s<0)throw new Error("Invalid byte sequence");n[r]=s}return n}function yi(t){if(typeof t!="string")throw new Error(`utf8ToBytes expected string, got ${typeof t}`);return new Uint8Array(new TextEncoder().encode(t))}function Wt(t){if(typeof t=="string"&&(t=yi(t)),!Fe(t))throw new Error(`expected Uint8Array, got ${typeof t}`);return t}function ie(...t){const e=new Uint8Array(t.reduce((r,o)=>r+o.length,0));let n=0;return t.forEach(r=>{if(!Fe(r))throw new Error("Uint8Array expected");e.set(r,n),n+=r.length}),e}class cr{clone(){return this._cloneInto()}}function fr(t){const e=r=>t().update(Wt(r)).digest(),n=t();return e.outputLen=n.outputLen,e.blockLen=n.blockLen,e.create=()=>t(),e}function lr(t=32){if(xe&&typeof xe.getRandomValues=="function")return xe.getRandomValues(new Uint8Array(t));throw new Error("crypto.getRandomValues must be defined")}function Ne(t){if(!Number.isSafeInteger(t)||t<0)throw new Error(`Wrong positive integer: ${t}`)}function wi(t){if(typeof t!="boolean")throw new Error(`Expected boolean, not ${t}`)}function ur(t,...e){if(!(t instanceof Uint8Array))throw new Error("Expected Uint8Array");if(e.length>0&&!e.includes(t.length))throw new Error(`Expected Uint8Array of length ${e}, not of length=${t.length}`)}function bi(t){if(typeof t!="function"||typeof t.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");Ne(t.outputLen),Ne(t.blockLen)}function Ei(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function mi(t,e){ur(t);const n=e.outputLen;if(t.length<n)throw new Error(`digestInto() expects output buffer of length at least ${n}`)}const nt={number:Ne,bool:wi,bytes:ur,hash:bi,exists:Ei,output:mi};function xi(t,e,n,r){if(typeof t.setBigUint64=="function")return t.setBigUint64(e,n,r);const o=BigInt(32),i=BigInt(4294967295),s=Number(n>>o&i),c=Number(n&i),a=r?4:0,l=r?0:4;t.setUint32(e+a,s,r),t.setUint32(e+l,c,r)}class vi extends cr{constructor(e,n,r,o){super(),this.blockLen=e,this.outputLen=n,this.padOffset=r,this.isLE=o,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=ve(this.buffer)}update(e){nt.exists(this);const{view:n,buffer:r,blockLen:o}=this;e=Wt(e);const i=e.length;for(let s=0;s<i;){const c=Math.min(o-this.pos,i-s);if(c===o){const a=ve(e);for(;o<=i-s;s+=o)this.process(a,s);continue}r.set(e.subarray(s,s+c),this.pos),this.pos+=c,s+=c,this.pos===o&&(this.process(n,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){nt.exists(this),nt.output(e,this),this.finished=!0;const{buffer:n,view:r,blockLen:o,isLE:i}=this;let{pos:s}=this;n[s++]=128,this.buffer.subarray(s).fill(0),this.padOffset>o-s&&(this.process(r,0),s=0);for(let f=s;f<o;f++)n[f]=0;xi(r,o-8,BigInt(this.length*8),i),this.process(r,0);const c=ve(e),a=this.outputLen;if(a%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const l=a/4,u=this.get();if(l>u.length)throw new Error("_sha2: outputLen bigger than state");for(let f=0;f<l;f++)c.setUint32(4*f,u[f],i)}digest(){const{buffer:e,outputLen:n}=this;this.digestInto(e);const r=e.slice(0,n);return this.destroy(),r}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:n,buffer:r,length:o,finished:i,destroyed:s,pos:c}=this;return e.length=o,e.pos=c,e.finished=i,e.destroyed=s,o%n&&e.buffer.set(r),e}}const Ai=(t,e,n)=>t&e^~t&n,Bi=(t,e,n)=>t&e^t&n^e&n,Si=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),gt=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),yt=new Uint32Array(64);let dr=class extends vi{constructor(){super(64,32,8,!1),this.A=gt[0]|0,this.B=gt[1]|0,this.C=gt[2]|0,this.D=gt[3]|0,this.E=gt[4]|0,this.F=gt[5]|0,this.G=gt[6]|0,this.H=gt[7]|0}get(){const{A:e,B:n,C:r,D:o,E:i,F:s,G:c,H:a}=this;return[e,n,r,o,i,s,c,a]}set(e,n,r,o,i,s,c,a){this.A=e|0,this.B=n|0,this.C=r|0,this.D=o|0,this.E=i|0,this.F=s|0,this.G=c|0,this.H=a|0}process(e,n){for(let f=0;f<16;f++,n+=4)yt[f]=e.getUint32(n,!1);for(let f=16;f<64;f++){const w=yt[f-15],b=yt[f-2],y=et(w,7)^et(w,18)^w>>>3,d=et(b,17)^et(b,19)^b>>>10;yt[f]=d+yt[f-7]+y+yt[f-16]|0}let{A:r,B:o,C:i,D:s,E:c,F:a,G:l,H:u}=this;for(let f=0;f<64;f++){const w=et(c,6)^et(c,11)^et(c,25),b=u+w+Ai(c,a,l)+Si[f]+yt[f]|0,d=(et(r,2)^et(r,13)^et(r,22))+Bi(r,o,i)|0;u=l,l=a,a=c,c=s+b|0,s=i,i=o,o=r,r=b+d|0}r=r+this.A|0,o=o+this.B|0,i=i+this.C|0,s=s+this.D|0,c=c+this.E|0,a=a+this.F|0,l=l+this.G|0,u=u+this.H|0,this.set(r,o,i,s,c,a,l,u)}roundClean(){yt.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}};class _i extends dr{constructor(){super(),this.A=-1056596264,this.B=914150663,this.C=812702999,this.D=-150054599,this.E=-4191439,this.F=1750603025,this.G=1694076839,this.H=-1090891868,this.outputLen=28}}const Ht=fr(()=>new dr);fr(()=>new _i);/*! scure-base - MIT License (c) 2022 Paul Miller (paulmillr.com) */function Mt(t){if(!Number.isSafeInteger(t))throw new Error(`Wrong integer: ${t}`)}function ct(...t){const e=(o,i)=>s=>o(i(s)),n=Array.from(t).reverse().reduce((o,i)=>o?e(o,i.encode):i.encode,void 0),r=t.reduce((o,i)=>o?e(o,i.decode):i.decode,void 0);return{encode:n,decode:r}}function ft(t){return{encode:e=>{if(!Array.isArray(e)||e.length&&typeof e[0]!="number")throw new Error("alphabet.encode input should be an array of numbers");return e.map(n=>{if(Mt(n),n<0||n>=t.length)throw new Error(`Digit index outside alphabet: ${n} (alphabet: ${t.length})`);return t[n]})},decode:e=>{if(!Array.isArray(e)||e.length&&typeof e[0]!="string")throw new Error("alphabet.decode input should be array of strings");return e.map(n=>{if(typeof n!="string")throw new Error(`alphabet.decode: not string element=${n}`);const r=t.indexOf(n);if(r===-1)throw new Error(`Unknown letter: "${n}". Allowed: ${t}`);return r})}}}function lt(t=""){if(typeof t!="string")throw new Error("join separator should be string");return{encode:e=>{if(!Array.isArray(e)||e.length&&typeof e[0]!="string")throw new Error("join.encode input should be array of strings");for(let n of e)if(typeof n!="string")throw new Error(`join.encode: non-string input=${n}`);return e.join(t)},decode:e=>{if(typeof e!="string")throw new Error("join.decode input should be string");return e.split(t)}}}function se(t,e="="){if(Mt(t),typeof e!="string")throw new Error("padding chr should be string");return{encode(n){if(!Array.isArray(n)||n.length&&typeof n[0]!="string")throw new Error("padding.encode input should be array of strings");for(let r of n)if(typeof r!="string")throw new Error(`padding.encode: non-string input=${r}`);for(;n.length*t%8;)n.push(e);return n},decode(n){if(!Array.isArray(n)||n.length&&typeof n[0]!="string")throw new Error("padding.encode input should be array of strings");for(let o of n)if(typeof o!="string")throw new Error(`padding.decode: non-string input=${o}`);let r=n.length;if(r*t%8)throw new Error("Invalid padding: string should have whole number of bytes");for(;r>0&&n[r-1]===e;r--)if(!((r-1)*t%8))throw new Error("Invalid padding: string has too much padding");return n.slice(0,r)}}}function hr(t){if(typeof t!="function")throw new Error("normalize fn should be function");return{encode:e=>e,decode:e=>t(e)}}function Tn(t,e,n){if(e<2)throw new Error(`convertRadix: wrong from=${e}, base cannot be less than 2`);if(n<2)throw new Error(`convertRadix: wrong to=${n}, base cannot be less than 2`);if(!Array.isArray(t))throw new Error("convertRadix: data should be array");if(!t.length)return[];let r=0;const o=[],i=Array.from(t);for(i.forEach(s=>{if(Mt(s),s<0||s>=e)throw new Error(`Wrong integer: ${s}`)});;){let s=0,c=!0;for(let a=r;a<i.length;a++){const l=i[a],u=e*s+l;if(!Number.isSafeInteger(u)||e*s/e!==s||u-l!==e*s)throw new Error("convertRadix: carry overflow");if(s=u%n,i[a]=Math.floor(u/n),!Number.isSafeInteger(i[a])||i[a]*n+s!==u)throw new Error("convertRadix: carry overflow");if(c)i[a]?c=!1:r=a;else continue}if(o.push(s),c)break}for(let s=0;s<t.length-1&&t[s]===0;s++)o.push(0);return o.reverse()}const pr=(t,e)=>e?pr(e,t%e):t,Qt=(t,e)=>t+(e-pr(t,e));function Ce(t,e,n,r){if(!Array.isArray(t))throw new Error("convertRadix2: data should be array");if(e<=0||e>32)throw new Error(`convertRadix2: wrong from=${e}`);if(n<=0||n>32)throw new Error(`convertRadix2: wrong to=${n}`);if(Qt(e,n)>32)throw new Error(`convertRadix2: carry overflow from=${e} to=${n} carryBits=${Qt(e,n)}`);let o=0,i=0;const s=2**n-1,c=[];for(const a of t){if(Mt(a),a>=2**e)throw new Error(`convertRadix2: invalid data word=${a} from=${e}`);if(o=o<<e|a,i+e>32)throw new Error(`convertRadix2: carry overflow pos=${i} from=${e}`);for(i+=e;i>=n;i-=n)c.push((o>>i-n&s)>>>0);o&=2**i-1}if(o=o<<n-i&s,!r&&i>=e)throw new Error("Excess padding");if(!r&&o)throw new Error(`Non-zero padding: ${o}`);return r&&i>0&&c.push(o>>>0),c}function Ii(t){return Mt(t),{encode:e=>{if(!(e instanceof Uint8Array))throw new Error("radix.encode input should be Uint8Array");return Tn(Array.from(e),2**8,t)},decode:e=>{if(!Array.isArray(e)||e.length&&typeof e[0]!="number")throw new Error("radix.decode input should be array of strings");return Uint8Array.from(Tn(e,t,2**8))}}}function mt(t,e=!1){if(Mt(t),t<=0||t>32)throw new Error("radix2: bits should be in (0..32]");if(Qt(8,t)>32||Qt(t,8)>32)throw new Error("radix2: carry overflow");return{encode:n=>{if(!(n instanceof Uint8Array))throw new Error("radix2.encode input should be Uint8Array");return Ce(Array.from(n),8,t,!e)},decode:n=>{if(!Array.isArray(n)||n.length&&typeof n[0]!="number")throw new Error("radix2.decode input should be array of strings");return Uint8Array.from(Ce(n,t,8,e))}}}function Rn(t){if(typeof t!="function")throw new Error("unsafeWrapper fn should be function");return function(...e){try{return t.apply(null,e)}catch{}}}const Li=ct(mt(4),ft("0123456789ABCDEF"),lt("")),$i=ct(mt(5),ft("ABCDEFGHIJKLMNOPQRSTUVWXYZ234567"),se(5),lt(""));ct(mt(5),ft("0123456789ABCDEFGHIJKLMNOPQRSTUV"),se(5),lt(""));ct(mt(5),ft("0123456789ABCDEFGHJKMNPQRSTVWXYZ"),lt(""),hr(t=>t.toUpperCase().replace(/O/g,"0").replace(/[IL]/g,"1")));const at=ct(mt(6),ft("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"),se(6),lt("")),ki=ct(mt(6),ft("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"),se(6),lt("")),Ge=t=>ct(Ii(58),ft(t),lt("")),Oe=Ge("123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz");Ge("123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ");Ge("rpshnaf39wBUDNEGHJKLM4PQRST7VWXYZ2bcdeCg65jkm8oFqi1tuvAxyz");const Nn=[0,2,3,5,6,7,9,10,11],Ui={encode(t){let e="";for(let n=0;n<t.length;n+=8){const r=t.subarray(n,n+8);e+=Oe.encode(r).padStart(Nn[r.length],"1")}return e},decode(t){let e=[];for(let n=0;n<t.length;n+=11){const r=t.slice(n,n+11),o=Nn.indexOf(r.length),i=Oe.decode(r);for(let s=0;s<i.length-o;s++)if(i[s]!==0)throw new Error("base58xmr: wrong padding");e=e.concat(Array.from(i.slice(i.length-o)))}return Uint8Array.from(e)}},He=ct(ft("qpzry9x8gf2tvdw0s3jn54khce6mua7l"),lt("")),Cn=[996825010,642813549,513874426,1027748829,705979059];function jt(t){const e=t>>25;let n=(t&33554431)<<5;for(let r=0;r<Cn.length;r++)(e>>r&1)===1&&(n^=Cn[r]);return n}function On(t,e,n=1){const r=t.length;let o=1;for(let i=0;i<r;i++){const s=t.charCodeAt(i);if(s<33||s>126)throw new Error(`Invalid prefix (${t})`);o=jt(o)^s>>5}o=jt(o);for(let i=0;i<r;i++)o=jt(o)^t.charCodeAt(i)&31;for(let i of e)o=jt(o)^i;for(let i=0;i<6;i++)o=jt(o);return o^=n,He.encode(Ce([o%2**30],30,5,!1))}function gr(t){const e=t==="bech32"?1:734539939,n=mt(5),r=n.decode,o=n.encode,i=Rn(r);function s(u,f,w=90){if(typeof u!="string")throw new Error(`bech32.encode prefix should be string, not ${typeof u}`);if(!Array.isArray(f)||f.length&&typeof f[0]!="number")throw new Error(`bech32.encode words should be array of numbers, not ${typeof f}`);const b=u.length+7+f.length;if(w!==!1&&b>w)throw new TypeError(`Length ${b} exceeds limit ${w}`);return u=u.toLowerCase(),`${u}1${He.encode(f)}${On(u,f,e)}`}function c(u,f=90){if(typeof u!="string")throw new Error(`bech32.decode input should be string, not ${typeof u}`);if(u.length<8||f!==!1&&u.length>f)throw new TypeError(`Wrong string length: ${u.length} (${u}). Expected (8..${f})`);const w=u.toLowerCase();if(u!==w&&u!==u.toUpperCase())throw new Error("String must be lowercase or uppercase");u=w;const b=u.lastIndexOf("1");if(b===0||b===-1)throw new Error('Letter "1" must be present between prefix and data only');const y=u.slice(0,b),d=u.slice(b+1);if(d.length<6)throw new Error("Data must be at least 6 characters long");const h=He.decode(d).slice(0,-6),p=On(y,h,e);if(!d.endsWith(p))throw new Error(`Invalid checksum in ${u}: expected "${p}"`);return{prefix:y,words:h}}const a=Rn(c);function l(u){const{prefix:f,words:w}=c(u,!1);return{prefix:f,words:w,bytes:r(w)}}return{encode:s,decode:c,decodeToBytes:l,decodeUnsafe:a,fromWords:r,fromWordsUnsafe:i,toWords:o}}const Ct=gr("bech32");gr("bech32m");const Ti={encode:t=>new TextDecoder().decode(t),decode:t=>new TextEncoder().encode(t)},Ri=ct(mt(4),ft("0123456789abcdef"),lt(""),hr(t=>{if(typeof t!="string"||t.length%2)throw new TypeError(`hex.decode: expected string, got ${typeof t} with length ${t.length}`);return t.toLowerCase()})),Ni={utf8:Ti,hex:Ri,base16:Li,base32:$i,base64:at,base64url:ki,base58:Oe,base58xmr:Ui};`${Object.keys(Ni).join(", ")}`;function Ae(t){if(!Number.isSafeInteger(t)||t<0)throw new Error(`positive integer expected, not ${t}`)}function Hn(t){if(typeof t!="boolean")throw new Error(`boolean expected, not ${t}`)}function Ci(t){return t instanceof Uint8Array||t!=null&&typeof t=="object"&&t.constructor.name==="Uint8Array"}function it(t,...e){if(!Ci(t))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(t.length))throw new Error(`Uint8Array expected of length ${e}, not of length=${t.length}`)}/*! noble-ciphers - MIT License (c) 2023 Paul Miller (paulmillr.com) */const K=t=>new Uint32Array(t.buffer,t.byteOffset,Math.floor(t.byteLength/4)),Oi=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;if(!Oi)throw new Error("Non little-endian hardware is not supported");function Hi(t,e){if(e==null||typeof e!="object")throw new Error("options must be defined");return Object.assign(t,e)}function Mi(t,e){if(t.length!==e.length)return!1;let n=0;for(let r=0;r<t.length;r++)n|=t[r]^e[r];return n===0}const Pi=(t,e)=>(Object.assign(e,t),e),bt=16,qi=283;function Je(t){return t<<1^qi&-(t>>7)}function Tt(t,e){let n=0;for(;e>0;e>>=1)n^=t&-(e&1),t=Je(t);return n}const Me=(()=>{let t=new Uint8Array(256);for(let n=0,r=1;n<256;n++,r^=Je(r))t[n]=r;const e=new Uint8Array(256);e[0]=99;for(let n=0;n<255;n++){let r=t[255-n];r|=r<<8,e[t[n]]=(r^r>>4^r>>5^r>>6^r>>7^99)&255}return e})(),ji=Me.map((t,e)=>Me.indexOf(e)),Di=t=>t<<24|t>>>8,Be=t=>t<<8|t>>>24;function yr(t,e){if(t.length!==256)throw new Error("Wrong sbox length");const n=new Uint32Array(256).map((l,u)=>e(t[u])),r=n.map(Be),o=r.map(Be),i=o.map(Be),s=new Uint32Array(256*256),c=new Uint32Array(256*256),a=new Uint16Array(256*256);for(let l=0;l<256;l++)for(let u=0;u<256;u++){const f=l*256+u;s[f]=n[l]^r[u],c[f]=o[l]^i[u],a[f]=t[l]<<8|t[u]}return{sbox:t,sbox2:a,T0:n,T1:r,T2:o,T3:i,T01:s,T23:c}}const Ye=yr(Me,t=>Tt(t,3)<<24|t<<16|t<<8|Tt(t,2)),wr=yr(ji,t=>Tt(t,11)<<24|Tt(t,13)<<16|Tt(t,9)<<8|Tt(t,14)),Wi=(()=>{const t=new Uint8Array(16);for(let e=0,n=1;e<16;e++,n=Je(n))t[e]=n;return t})();function br(t){it(t);const e=t.length;if(![16,24,32].includes(e))throw new Error(`aes: wrong key size: should be 16, 24 or 32, got: ${e}`);const{sbox2:n}=Ye,r=K(t),o=r.length,i=c=>rt(n,c,c,c,c),s=new Uint32Array(e+28);s.set(r);for(let c=o;c<s.length;c++){let a=s[c-1];c%o===0?a=i(Di(a))^Wi[c/o-1]:o>6&&c%o===4&&(a=i(a)),s[c]=s[c-o]^a}return s}function zi(t){const e=br(t),n=e.slice(),r=e.length,{sbox2:o}=Ye,{T0:i,T1:s,T2:c,T3:a}=wr;for(let l=0;l<r;l+=4)for(let u=0;u<4;u++)n[l+u]=e[r-l-4+u];e.fill(0);for(let l=4;l<r-4;l++){const u=n[l],f=rt(o,u,u,u,u);n[l]=i[f&255]^s[f>>>8&255]^c[f>>>16&255]^a[f>>>24]}return n}function wt(t,e,n,r,o,i){return t[n<<8&65280|r>>>8&255]^e[o>>>8&65280|i>>>24&255]}function rt(t,e,n,r,o){return t[e&255|n&65280]|t[r>>>16&255|o>>>16&65280]<<16}function Mn(t,e,n,r,o){const{sbox2:i,T01:s,T23:c}=Ye;let a=0;e^=t[a++],n^=t[a++],r^=t[a++],o^=t[a++];const l=t.length/4-2;for(let y=0;y<l;y++){const d=t[a++]^wt(s,c,e,n,r,o),h=t[a++]^wt(s,c,n,r,o,e),p=t[a++]^wt(s,c,r,o,e,n),x=t[a++]^wt(s,c,o,e,n,r);e=d,n=h,r=p,o=x}const u=t[a++]^rt(i,e,n,r,o),f=t[a++]^rt(i,n,r,o,e),w=t[a++]^rt(i,r,o,e,n),b=t[a++]^rt(i,o,e,n,r);return{s0:u,s1:f,s2:w,s3:b}}function Vi(t,e,n,r,o){const{sbox2:i,T01:s,T23:c}=wr;let a=0;e^=t[a++],n^=t[a++],r^=t[a++],o^=t[a++];const l=t.length/4-2;for(let y=0;y<l;y++){const d=t[a++]^wt(s,c,e,o,r,n),h=t[a++]^wt(s,c,n,e,o,r),p=t[a++]^wt(s,c,r,n,e,o),x=t[a++]^wt(s,c,o,r,n,e);e=d,n=h,r=p,o=x}const u=t[a++]^rt(i,e,o,r,n),f=t[a++]^rt(i,n,e,o,r),w=t[a++]^rt(i,r,n,e,o),b=t[a++]^rt(i,o,r,n,e);return{s0:u,s1:f,s2:w,s3:b}}function Er(t,e){if(!e)return new Uint8Array(t);if(it(e),e.length<t)throw new Error(`aes: wrong destination length, expected at least ${t}, got: ${e.length}`);return e}function Ki(t){if(it(t),t.length%bt!==0)throw new Error(`aes/(cbc-ecb).decrypt ciphertext should consist of blocks with size ${bt}`)}function Zi(t,e,n){let r=t.length;const o=r%bt;if(!e&&o!==0)throw new Error("aec/(cbc-ecb): unpadded plaintext with disabled padding");const i=K(t);if(e){let a=bt-o;a||(a=bt),r=r+a}const s=Er(r,n),c=K(s);return{b:i,o:c,out:s}}function Fi(t,e){if(!e)return t;const n=t.length;if(!n)throw new Error("aes/pcks5: empty ciphertext not allowed");const r=t[n-1];if(r<=0||r>16)throw new Error(`aes/pcks5: wrong padding byte: ${r}`);const o=t.subarray(0,-r);for(let i=0;i<r;i++)if(t[n-i-1]!==r)throw new Error("aes/pcks5: wrong padding");return o}function Gi(t){const e=new Uint8Array(16),n=K(e);e.set(t);const r=bt-t.length;for(let o=bt-r;o<bt;o++)e[o]=r;return n}const mr=Pi({blockSize:16,nonceLength:16},function(e,n,r={}){it(e),it(n,16);const o=!r.disablePadding;return{encrypt:(i,s)=>{const c=br(e),{b:a,o:l,out:u}=Zi(i,o,s),f=K(n);let w=f[0],b=f[1],y=f[2],d=f[3],h=0;for(;h+4<=a.length;)w^=a[h+0],b^=a[h+1],y^=a[h+2],d^=a[h+3],{s0:w,s1:b,s2:y,s3:d}=Mn(c,w,b,y,d),l[h++]=w,l[h++]=b,l[h++]=y,l[h++]=d;if(o){const p=Gi(i.subarray(h*4));w^=p[0],b^=p[1],y^=p[2],d^=p[3],{s0:w,s1:b,s2:y,s3:d}=Mn(c,w,b,y,d),l[h++]=w,l[h++]=b,l[h++]=y,l[h++]=d}return c.fill(0),u},decrypt:(i,s)=>{Ki(i);const c=zi(e),a=K(n),l=Er(i.length,s),u=K(i),f=K(l);let w=a[0],b=a[1],y=a[2],d=a[3];for(let h=0;h+4<=u.length;){const p=w,x=b,S=y,U=d;w=u[h+0],b=u[h+1],y=u[h+2],d=u[h+3];const{s0:L,s1:m,s2:v,s3:A}=Vi(c,w,b,y,d);f[h++]=L^p,f[h++]=m^x,f[h++]=v^S,f[h++]=A^U}return c.fill(0),Fi(l,o)}}}),xr=t=>Uint8Array.from(t.split("").map(e=>e.charCodeAt(0))),Ji=xr("expand 16-byte k"),Yi=xr("expand 32-byte k"),Xi=K(Ji),vr=K(Yi);vr.slice();function R(t,e){return t<<e|t>>>32-e}function Pe(t){return t.byteOffset%4===0}const Kt=64,Qi=16,Ar=2**32-1,Pn=new Uint32Array;function ts(t,e,n,r,o,i,s,c){const a=o.length,l=new Uint8Array(Kt),u=K(l),f=Pe(o)&&Pe(i),w=f?K(o):Pn,b=f?K(i):Pn;for(let y=0;y<a;s++){if(t(e,n,r,u,s,c),s>=Ar)throw new Error("arx: counter overflow");const d=Math.min(Kt,a-y);if(f&&d===Kt){const h=y/4;if(y%4!==0)throw new Error("arx: invalid block position");for(let p=0,x;p<Qi;p++)x=h+p,b[x]=w[x]^u[p];y+=Kt;continue}for(let h=0,p;h<d;h++)p=y+h,i[p]=o[p]^l[h];y+=d}}function es(t,e){const{allowShortKeys:n,extendNonceFn:r,counterLength:o,counterRight:i,rounds:s}=Hi({allowShortKeys:!1,counterLength:8,counterRight:!1,rounds:20},e);if(typeof t!="function")throw new Error("core must be a function");return Ae(o),Ae(s),Hn(i),Hn(n),(c,a,l,u,f=0)=>{it(c),it(a),it(l);const w=l.length;if(u||(u=new Uint8Array(w)),it(u),Ae(f),f<0||f>=Ar)throw new Error("arx: counter overflow");if(u.length<w)throw new Error(`arx: output (${u.length}) is shorter than data (${w})`);const b=[];let y=c.length,d,h;if(y===32)d=c.slice(),b.push(d),h=vr;else if(y===16&&n)d=new Uint8Array(32),d.set(c),d.set(c,16),h=Xi,b.push(d);else throw new Error(`arx: invalid 32-byte key, got length=${y}`);Pe(a)||(a=a.slice(),b.push(a));const p=K(d);if(r){if(a.length!==24)throw new Error("arx: extended nonce must be 24 bytes");r(h,p,K(a.subarray(0,16)),p),a=a.subarray(16)}const x=16-o;if(x!==a.length)throw new Error(`arx: nonce must be ${x} or 16 bytes`);if(x!==12){const U=new Uint8Array(12);U.set(a,i?0:12-a.length),a=U,b.push(a)}const S=K(a);for(ts(t,h,p,S,l,u,f,s);b.length>0;)b.pop().fill(0);return u}}function ns(t,e,n,r,o,i=20){let s=t[0],c=t[1],a=t[2],l=t[3],u=e[0],f=e[1],w=e[2],b=e[3],y=e[4],d=e[5],h=e[6],p=e[7],x=o,S=n[0],U=n[1],L=n[2],m=s,v=c,A=a,M=l,k=u,_=f,C=w,O=b,q=y,g=d,E=h,B=p,$=x,I=S,T=U,H=L;for(let J=0;J<i;J+=2)m=m+k|0,$=R($^m,16),q=q+$|0,k=R(k^q,12),m=m+k|0,$=R($^m,8),q=q+$|0,k=R(k^q,7),v=v+_|0,I=R(I^v,16),g=g+I|0,_=R(_^g,12),v=v+_|0,I=R(I^v,8),g=g+I|0,_=R(_^g,7),A=A+C|0,T=R(T^A,16),E=E+T|0,C=R(C^E,12),A=A+C|0,T=R(T^A,8),E=E+T|0,C=R(C^E,7),M=M+O|0,H=R(H^M,16),B=B+H|0,O=R(O^B,12),M=M+O|0,H=R(H^M,8),B=B+H|0,O=R(O^B,7),m=m+_|0,H=R(H^m,16),E=E+H|0,_=R(_^E,12),m=m+_|0,H=R(H^m,8),E=E+H|0,_=R(_^E,7),v=v+C|0,$=R($^v,16),B=B+$|0,C=R(C^B,12),v=v+C|0,$=R($^v,8),B=B+$|0,C=R(C^B,7),A=A+O|0,I=R(I^A,16),q=q+I|0,O=R(O^q,12),A=A+O|0,I=R(I^A,8),q=q+I|0,O=R(O^q,7),M=M+k|0,T=R(T^M,16),g=g+T|0,k=R(k^g,12),M=M+k|0,T=R(T^M,8),g=g+T|0,k=R(k^g,7);let N=0;r[N++]=s+m|0,r[N++]=c+v|0,r[N++]=a+A|0,r[N++]=l+M|0,r[N++]=u+k|0,r[N++]=f+_|0,r[N++]=w+C|0,r[N++]=b+O|0,r[N++]=y+q|0,r[N++]=d+g|0,r[N++]=h+E|0,r[N++]=p+B|0,r[N++]=x+$|0,r[N++]=S+I|0,r[N++]=U+T|0,r[N++]=L+H|0}const Br=es(ns,{counterRight:!1,counterLength:4,allowShortKeys:!1});class Sr extends cr{constructor(e,n){super(),this.finished=!1,this.destroyed=!1,nt.hash(e);const r=Wt(n);if(this.iHash=e.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const o=this.blockLen,i=new Uint8Array(o);i.set(r.length>o?e.create().update(r).digest():r);for(let s=0;s<i.length;s++)i[s]^=54;this.iHash.update(i),this.oHash=e.create();for(let s=0;s<i.length;s++)i[s]^=106;this.oHash.update(i),i.fill(0)}update(e){return nt.exists(this),this.iHash.update(e),this}digestInto(e){nt.exists(this),nt.bytes(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){const e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));const{oHash:n,iHash:r,finished:o,destroyed:i,blockLen:s,outputLen:c}=this;return e=e,e.finished=o,e.destroyed=i,e.blockLen=s,e.outputLen=c,e.oHash=n._cloneInto(e.oHash),e.iHash=r._cloneInto(e.iHash),e}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}const ae=(t,e,n)=>new Sr(t,e).update(n).digest();ae.create=(t,e)=>new Sr(t,e);function rs(t,e,n){return nt.hash(t),ae(t,Wt(n),Wt(e))}const Se=new Uint8Array([0]),qn=new Uint8Array;function os(t,e,n,r=32){if(nt.hash(t),nt.number(r),r>255*t.outputLen)throw new Error("Length should be <= 255*HashLen");const o=Math.ceil(r/t.outputLen);n===void 0&&(n=qn);const i=new Uint8Array(o*t.outputLen),s=ae.create(t,e),c=s._cloneInto(),a=new Uint8Array(s.outputLen);for(let l=0;l<o;l++)Se[0]=l+1,c.update(l===0?qn:a).update(n).update(Se).digestInto(a),i.set(a,t.outputLen*l),s._cloneInto(c);return s.destroy(),c.destroy(),a.fill(0),Se.fill(0),i.slice(0,r)}var is=Object.defineProperty,P=(t,e)=>{for(var n in e)is(t,n,{get:e[n],enumerable:!0})},Ut=Symbol("verified"),ss=t=>t instanceof Object;function Xe(t){if(!ss(t)||typeof t.kind!="number"||typeof t.content!="string"||typeof t.created_at!="number"||typeof t.pubkey!="string"||!t.pubkey.match(/^[a-f0-9]{64}$/)||!Array.isArray(t.tags))return!1;for(let e=0;e<t.tags.length;e++){let n=t.tags[e];if(!Array.isArray(n))return!1;for(let r=0;r<n.length;r++)if(typeof n[r]!="string")return!1}return!0}var as={};P(as,{Queue:()=>us,QueueNode:()=>_r,binarySearch:()=>Qe,bytesToHex:()=>V,hexToBytes:()=>St,insertEventIntoAscendingList:()=>ls,insertEventIntoDescendingList:()=>fs,normalizeURL:()=>cs,utf8Decoder:()=>st,utf8Encoder:()=>X});var st=new TextDecoder("utf-8"),X=new TextEncoder;function cs(t){try{t.indexOf("://")===-1&&(t="wss://"+t);let e=new URL(t);return e.pathname=e.pathname.replace(/\/+/g,"/"),e.pathname.endsWith("/")&&(e.pathname=e.pathname.slice(0,-1)),(e.port==="80"&&e.protocol==="ws:"||e.port==="443"&&e.protocol==="wss:")&&(e.port=""),e.searchParams.sort(),e.hash="",e.toString()}catch{throw new Error(`Invalid URL: ${t}`)}}function fs(t,e){const[n,r]=Qe(t,o=>e.id===o.id?0:e.created_at===o.created_at?-1:o.created_at-e.created_at);return r||t.splice(n,0,e),t}function ls(t,e){const[n,r]=Qe(t,o=>e.id===o.id?0:e.created_at===o.created_at?-1:e.created_at-o.created_at);return r||t.splice(n,0,e),t}function Qe(t,e){let n=0,r=t.length-1;for(;n<=r;){const o=Math.floor((n+r)/2),i=e(t[o]);if(i===0)return[o,!0];i<0?r=o-1:n=o+1}return[n,!1]}var _r=class{constructor(t){kt(this,"value");kt(this,"next",null);kt(this,"prev",null);this.value=t}},us=class{constructor(){kt(this,"first");kt(this,"last");this.first=null,this.last=null}enqueue(t){const e=new _r(t);return this.last?this.last===this.first?(this.last=e,this.last.prev=this.first,this.first.next=e):(e.prev=this.last,this.last.next=e,this.last=e):(this.first=e,this.last=e),!0}dequeue(){if(!this.first)return null;if(this.first===this.last){const e=this.first;return this.first=null,this.last=null,e.value}const t=this.first;return this.first=t.next,this.first&&(this.first.prev=null),t.value}},ds=class{generateSecretKey(){return qt.utils.randomPrivateKey()}getPublicKey(t){return V(qt.getPublicKey(t))}finalizeEvent(t,e){const n=t;return n.pubkey=V(qt.getPublicKey(e)),n.id=Ft(n),n.sig=V(qt.sign(Ft(n),e)),n[Ut]=!0,n}verifyEvent(t){if(typeof t[Ut]=="boolean")return t[Ut];const e=Ft(t);if(e!==t.id)return t[Ut]=!1,!1;try{const n=qt.verify(t.sig,e,t.pubkey);return t[Ut]=n,n}catch{return t[Ut]=!1,!1}}};function hs(t){if(!Xe(t))throw new Error("can't serialize event with wrong or missing properties");return JSON.stringify([0,t.pubkey,t.created_at,t.kind,t.tags,t.content])}function Ft(t){let e=Ht(X.encode(hs(t)));return V(e)}var ce=new ds,Ir=ce.generateSecretKey,fe=ce.getPublicKey,Q=ce.finalizeEvent,le=ce.verifyEvent,ps={};P(ps,{Application:()=>ha,BadgeAward:()=>vs,BadgeDefinition:()=>sa,BlockedRelaysList:()=>zs,BookmarkList:()=>js,Bookmarksets:()=>ra,Calendar:()=>ma,CalendarEventRSVP:()=>xa,ChannelCreation:()=>Rr,ChannelHideMessage:()=>Or,ChannelMessage:()=>Cr,ChannelMetadata:()=>Nr,ChannelMuteUser:()=>Hr,ClassifiedListing:()=>ya,ClientAuth:()=>Pr,CommunitiesList:()=>Ds,CommunityDefinition:()=>Ba,CommunityPostApproval:()=>ks,Contacts:()=>Es,CreateOrUpdateProduct:()=>fa,CreateOrUpdateStall:()=>ca,Curationsets:()=>oa,Date:()=>ba,DirectMessageRelaysList:()=>Fs,DraftClassifiedListing:()=>wa,DraftLong:()=>ua,Emojisets:()=>da,EncryptedDirectMessage:()=>ms,EventDeletion:()=>xs,FileMetadata:()=>Bs,FileServerPreference:()=>Gs,Followsets:()=>ta,GenericRepost:()=>on,Genericlists:()=>ea,GiftWrap:()=>Mr,HTTPAuth:()=>sn,Handlerinformation:()=>Aa,Handlerrecommendation:()=>va,Highlights:()=>Hs,InterestsList:()=>Ks,Interestsets:()=>aa,JobFeedback:()=>Rs,JobRequest:()=>Us,JobResult:()=>Ts,Label:()=>$s,LightningPubRPC:()=>Ys,LiveChatMessage:()=>Ss,LiveEvent:()=>pa,LongFormArticle:()=>la,Metadata:()=>ws,Mutelist:()=>Ms,NWCWalletInfo:()=>Js,NWCWalletRequest:()=>qr,NWCWalletResponse:()=>Xs,NostrConnect:()=>Qs,OpenTimestamps:()=>As,Pinlist:()=>Ps,PrivateDirectMessage:()=>Tr,ProblemTracker:()=>_s,ProfileBadges:()=>ia,PublicChatsList:()=>Ws,Reaction:()=>rn,RecommendRelay:()=>bs,RelayList:()=>qs,Relaysets:()=>na,Report:()=>Is,Reporting:()=>Ls,Repost:()=>nn,Seal:()=>Ur,SearchRelaysList:()=>Vs,ShortTextNote:()=>kr,Time:()=>Ea,UserEmojiList:()=>Zs,UserStatuses:()=>ga,Zap:()=>Os,ZapGoal:()=>Ns,ZapRequest:()=>Cs,classifyKind:()=>gs,isAddressableKind:()=>en,isEphemeralKind:()=>$r,isKind:()=>ys,isRegularKind:()=>Lr,isReplaceableKind:()=>tn});function Lr(t){return 1e3<=t&&t<1e4||[1,2,4,5,6,7,8,16,40,41,42,43,44].includes(t)}function tn(t){return[0,3].includes(t)||1e4<=t&&t<2e4}function $r(t){return 2e4<=t&&t<3e4}function en(t){return 3e4<=t&&t<4e4}function gs(t){return Lr(t)?"regular":tn(t)?"replaceable":$r(t)?"ephemeral":en(t)?"parameterized":"unknown"}function ys(t,e){const n=e instanceof Array?e:[e];return Xe(t)&&n.includes(t.kind)||!1}var ws=0,kr=1,bs=2,Es=3,ms=4,xs=5,nn=6,rn=7,vs=8,Ur=13,Tr=14,on=16,Rr=40,Nr=41,Cr=42,Or=43,Hr=44,As=1040,Mr=1059,Bs=1063,Ss=1311,_s=1971,Is=1984,Ls=1984,$s=1985,ks=4550,Us=5999,Ts=6999,Rs=7e3,Ns=9041,Cs=9734,Os=9735,Hs=9802,Ms=1e4,Ps=10001,qs=10002,js=10003,Ds=10004,Ws=10005,zs=10006,Vs=10007,Ks=10015,Zs=10030,Fs=10050,Gs=10096,Js=13194,Ys=21e3,Pr=22242,qr=23194,Xs=23195,Qs=24133,sn=27235,ta=3e4,ea=30001,na=30002,ra=30003,oa=30004,ia=30008,sa=30009,aa=30015,ca=30017,fa=30018,la=30023,ua=30024,da=30030,ha=30078,pa=30311,ga=30315,ya=30402,wa=30403,ba=31922,Ea=31923,ma=31924,xa=31925,va=31989,Aa=31990,Ba=34550,Sa={};P(Sa,{getHex64:()=>an,getInt:()=>jr,getSubscriptionId:()=>_a,matchEventId:()=>Ia,matchEventKind:()=>$a,matchEventPubkey:()=>La});function an(t,e){let n=e.length+3,r=t.indexOf(`"${e}":`)+n,o=t.slice(r).indexOf('"')+r+1;return t.slice(o,o+64)}function jr(t,e){let n=e.length,r=t.indexOf(`"${e}":`)+n+3,o=t.slice(r),i=Math.min(o.indexOf(","),o.indexOf("}"));return parseInt(o.slice(0,i),10)}function _a(t){let e=t.slice(0,22).indexOf('"EVENT"');if(e===-1)return null;let n=t.slice(e+7+1).indexOf('"');if(n===-1)return null;let r=e+7+1+n,o=t.slice(r+1,80).indexOf('"');if(o===-1)return null;let i=r+1+o;return t.slice(r+1,i)}function Ia(t,e){return e===an(t,"id")}function La(t,e){return e===an(t,"pubkey")}function $a(t,e){return e===jr(t,"kind")}var ka={};P(ka,{makeAuthEvent:()=>Ua});function Ua(t,e){return{kind:Pr,created_at:Math.floor(Date.now()/1e3),tags:[["relay",t],["challenge",e]],content:""}}var Ta;try{Ta=WebSocket}catch{}var Ra;try{Ra=WebSocket}catch{}var zt={};P(zt,{BECH32_REGEX:()=>Dr,Bech32MaxSize:()=>cn,NostrTypeGuard:()=>Na,decode:()=>ue,decodeNostrURI:()=>Oa,encodeBytes:()=>he,naddrEncode:()=>Da,neventEncode:()=>ja,noteEncode:()=>Pa,nprofileEncode:()=>qa,npubEncode:()=>Ma,nsecEncode:()=>Ha});var Na={isNProfile:t=>/^nprofile1[a-z\d]+$/.test(t||""),isNEvent:t=>/^nevent1[a-z\d]+$/.test(t||""),isNAddr:t=>/^naddr1[a-z\d]+$/.test(t||""),isNSec:t=>/^nsec1[a-z\d]{58}$/.test(t||""),isNPub:t=>/^npub1[a-z\d]{58}$/.test(t||""),isNote:t=>/^note1[a-z\d]+$/.test(t||""),isNcryptsec:t=>/^ncryptsec1[a-z\d]+$/.test(t||"")},cn=5e3,Dr=/[\x21-\x7E]{1,83}1[023456789acdefghjklmnpqrstuvwxyz]{6,}/;function Ca(t){const e=new Uint8Array(4);return e[0]=t>>24&255,e[1]=t>>16&255,e[2]=t>>8&255,e[3]=t&255,e}function Oa(t){try{return t.startsWith("nostr:")&&(t=t.substring(6)),ue(t)}catch{return{type:"invalid",data:null}}}function ue(t){var o,i,s,c,a,l,u;let{prefix:e,words:n}=Ct.decode(t,cn),r=new Uint8Array(Ct.fromWords(n));switch(e){case"nprofile":{let f=_e(r);if(!((o=f[0])!=null&&o[0]))throw new Error("missing TLV 0 for nprofile");if(f[0][0].length!==32)throw new Error("TLV 0 should be 32 bytes");return{type:"nprofile",data:{pubkey:V(f[0][0]),relays:f[1]?f[1].map(w=>st.decode(w)):[]}}}case"nevent":{let f=_e(r);if(!((i=f[0])!=null&&i[0]))throw new Error("missing TLV 0 for nevent");if(f[0][0].length!==32)throw new Error("TLV 0 should be 32 bytes");if(f[2]&&f[2][0].length!==32)throw new Error("TLV 2 should be 32 bytes");if(f[3]&&f[3][0].length!==4)throw new Error("TLV 3 should be 4 bytes");return{type:"nevent",data:{id:V(f[0][0]),relays:f[1]?f[1].map(w=>st.decode(w)):[],author:(s=f[2])!=null&&s[0]?V(f[2][0]):void 0,kind:(c=f[3])!=null&&c[0]?parseInt(V(f[3][0]),16):void 0}}}case"naddr":{let f=_e(r);if(!((a=f[0])!=null&&a[0]))throw new Error("missing TLV 0 for naddr");if(!((l=f[2])!=null&&l[0]))throw new Error("missing TLV 2 for naddr");if(f[2][0].length!==32)throw new Error("TLV 2 should be 32 bytes");if(!((u=f[3])!=null&&u[0]))throw new Error("missing TLV 3 for naddr");if(f[3][0].length!==4)throw new Error("TLV 3 should be 4 bytes");return{type:"naddr",data:{identifier:st.decode(f[0][0]),pubkey:V(f[2][0]),kind:parseInt(V(f[3][0]),16),relays:f[1]?f[1].map(w=>st.decode(w)):[]}}}case"nsec":return{type:e,data:r};case"npub":case"note":return{type:e,data:V(r)};default:throw new Error(`unknown prefix ${e}`)}}function _e(t){let e={},n=t;for(;n.length>0;){let r=n[0],o=n[1],i=n.slice(2,2+o);if(n=n.slice(2+o),i.length<o)throw new Error(`not enough data to read on TLV ${r}`);e[r]=e[r]||[],e[r].push(i)}return e}function Ha(t){return he("nsec",t)}function Ma(t){return he("npub",St(t))}function Pa(t){return he("note",St(t))}function de(t,e){let n=Ct.toWords(e);return Ct.encode(t,n,cn)}function he(t,e){return de(t,e)}function qa(t){let e=fn({0:[St(t.pubkey)],1:(t.relays||[]).map(n=>X.encode(n))});return de("nprofile",e)}function ja(t){let e;t.kind!==void 0&&(e=Ca(t.kind));let n=fn({0:[St(t.id)],1:(t.relays||[]).map(r=>X.encode(r)),2:t.author?[St(t.author)]:[],3:e?[new Uint8Array(e)]:[]});return de("nevent",n)}function Da(t){let e=new ArrayBuffer(4);new DataView(e).setUint32(0,t.kind,!1);let n=fn({0:[X.encode(t.identifier)],1:(t.relays||[]).map(r=>X.encode(r)),2:[St(t.pubkey)],3:[new Uint8Array(e)]});return de("naddr",n)}function fn(t){let e=[];return Object.entries(t).reverse().forEach(([n,r])=>{r.forEach(o=>{let i=new Uint8Array(o.length+2);i.set([parseInt(n)],0),i.set([o.length],1),i.set(o,2),e.push(i)})}),ie(...e)}var Wa={};P(Wa,{decrypt:()=>za,encrypt:()=>Wr});function Wr(t,e,n){const r=t instanceof Uint8Array?V(t):t,o=Ot.getSharedSecret(r,"02"+e),i=zr(o);let s=Uint8Array.from(lr(16)),c=X.encode(n),a=mr(i,s).encrypt(c),l=at.encode(new Uint8Array(a)),u=at.encode(new Uint8Array(s.buffer));return`${l}?iv=${u}`}function za(t,e,n){const r=t instanceof Uint8Array?V(t):t;let[o,i]=n.split("?iv="),s=Ot.getSharedSecret(r,"02"+e),c=zr(s),a=at.decode(i),l=at.decode(o),u=mr(c,a).decrypt(l);return st.decode(u)}function zr(t){return t.slice(1,33)}var Va={};P(Va,{NIP05_REGEX:()=>ln,isNip05:()=>Ka,isValid:()=>Ga,queryProfile:()=>Vr,searchDomain:()=>Fa,useFetchImplementation:()=>Za});var ln=/^(?:([\w.+-]+)@)?([\w_-]+(\.[\w_-]+)+)$/,Ka=t=>ln.test(t||""),pe;try{pe=fetch}catch{}function Za(t){pe=t}async function Fa(t,e=""){try{const n=`https://${t}/.well-known/nostr.json?name=${e}`,r=await pe(n,{redirect:"manual"});if(r.status!==200)throw Error("Wrong response code");return(await r.json()).names}catch{return{}}}async function Vr(t){var o;const e=t.match(ln);if(!e)return null;const[,n="_",r]=e;try{const i=`https://${r}/.well-known/nostr.json?name=${n}`,s=await pe(i,{redirect:"manual"});if(s.status!==200)throw Error("Wrong response code");const c=await s.json(),a=c.names[n];return a?{pubkey:a,relays:(o=c.relays)==null?void 0:o[a]}:null}catch{return null}}async function Ga(t,e){const n=await Vr(e);return n?n.pubkey===t:!1}var Ja={};P(Ja,{parse:()=>Ya});function Ya(t){const e={reply:void 0,root:void 0,mentions:[],profiles:[],quotes:[]};let n,r;for(let o=t.tags.length-1;o>=0;o--){const i=t.tags[o];if(i[0]==="e"&&i[1]){const[s,c,a,l,u]=i,f={id:c,relays:a?[a]:[],author:u};if(l==="root"){e.root=f;continue}if(l==="reply"){e.reply=f;continue}if(l==="mention"){e.mentions.push(f);continue}n?r=f:n=f,e.mentions.push(f);continue}if(i[0]==="q"&&i[1]){const[s,c,a]=i;e.quotes.push({id:c,relays:a?[a]:[]})}if(i[0]==="p"&&i[1]){e.profiles.push({pubkey:i[1],relays:i[2]?[i[2]]:[]});continue}}return e.root||(e.root=r||n||e.reply),e.reply||(e.reply=n||e.root),[e.reply,e.root].forEach(o=>{if(!o)return;let i=e.mentions.indexOf(o);if(i!==-1&&e.mentions.splice(i,1),o.author){let s=e.profiles.find(c=>c.pubkey===o.author);s&&s.relays&&(o.relays||(o.relays=[]),s.relays.forEach(c=>{var a;((a=o.relays)==null?void 0:a.indexOf(c))===-1&&o.relays.push(c)}),s.relays=o.relays)}}),e.mentions.forEach(o=>{if(o.author){let i=e.profiles.find(s=>s.pubkey===o.author);i&&i.relays&&(o.relays||(o.relays=[]),i.relays.forEach(s=>{o.relays.indexOf(s)===-1&&o.relays.push(s)}),i.relays=o.relays)}}),e}var Xa={};P(Xa,{fetchRelayInformation:()=>tc,useFetchImplementation:()=>Qa});var Kr;try{Kr=fetch}catch{}function Qa(t){Kr=t}async function tc(t){return await(await fetch(t.replace("ws://","http://").replace("wss://","https://"),{headers:{Accept:"application/nostr+json"}})).json()}var ec={};P(ec,{fastEventHash:()=>Fr,getPow:()=>Zr,minePow:()=>nc});function Zr(t){let e=0;for(let n=0;n<64;n+=8){const r=parseInt(t.substring(n,n+8),16);if(r===0)e+=32;else{e+=Math.clz32(r);break}}return e}function nc(t,e){let n=0;const r=t,o=["nonce",n.toString(),e.toString()];for(r.tags.push(o);;){const i=Math.floor(new Date().getTime()/1e3);if(i!==r.created_at&&(n=0,r.created_at=i),o[1]=(++n).toString(),r.id=Fr(r),Zr(r.id)>=e)break}return r}function Fr(t){return V(Ht(X.encode(JSON.stringify([0,t.pubkey,t.created_at,t.kind,t.tags,t.content]))))}var rc={};P(rc,{unwrapEvent:()=>gc,unwrapManyEvents:()=>yc,wrapEvent:()=>ao,wrapManyEvents:()=>pc});var oc={};P(oc,{createRumor:()=>ro,createSeal:()=>oo,createWrap:()=>io,unwrapEvent:()=>gn,unwrapManyEvents:()=>so,wrapEvent:()=>te,wrapManyEvents:()=>dc});var ic={};P(ic,{decrypt:()=>pn,encrypt:()=>hn,getConversationKey:()=>un,v2:()=>lc});var Gr=1,Jr=65535;function un(t,e){const n=Ot.getSharedSecret(t,"02"+e).subarray(1,33);return rs(Ht,n,"nip44-v2")}function Yr(t,e){const n=os(Ht,t,e,76);return{chacha_key:n.subarray(0,32),chacha_nonce:n.subarray(32,44),hmac_key:n.subarray(44,76)}}function dn(t){if(!Number.isSafeInteger(t)||t<1)throw new Error("expected positive integer");if(t<=32)return 32;const e=1<<Math.floor(Math.log2(t-1))+1,n=e<=256?32:e/8;return n*(Math.floor((t-1)/n)+1)}function sc(t){if(!Number.isSafeInteger(t)||t<Gr||t>Jr)throw new Error("invalid plaintext size: must be between 1 and 65535 bytes");const e=new Uint8Array(2);return new DataView(e.buffer).setUint16(0,t,!1),e}function ac(t){const e=X.encode(t),n=e.length,r=sc(n),o=new Uint8Array(dn(n)-n);return ie(r,e,o)}function cc(t){const e=new DataView(t.buffer).getUint16(0),n=t.subarray(2,2+e);if(e<Gr||e>Jr||n.length!==e||t.length!==2+dn(e))throw new Error("invalid padding");return st.decode(n)}function Xr(t,e,n){if(n.length!==32)throw new Error("AAD associated data must be 32 bytes");const r=ie(n,e);return ae(Ht,t,r)}function fc(t){if(typeof t!="string")throw new Error("payload must be a valid string");const e=t.length;if(e<132||e>87472)throw new Error("invalid payload length: "+e);if(t[0]==="#")throw new Error("unknown encryption version");let n;try{n=at.decode(t)}catch(i){throw new Error("invalid base64: "+i.message)}const r=n.length;if(r<99||r>65603)throw new Error("invalid data length: "+r);const o=n[0];if(o!==2)throw new Error("unknown encryption version "+o);return{nonce:n.subarray(1,33),ciphertext:n.subarray(33,-32),mac:n.subarray(-32)}}function hn(t,e,n=lr(32)){const{chacha_key:r,chacha_nonce:o,hmac_key:i}=Yr(e,n),s=ac(t),c=Br(r,o,s),a=Xr(i,c,n);return at.encode(ie(new Uint8Array([2]),n,c,a))}function pn(t,e){const{nonce:n,ciphertext:r,mac:o}=fc(t),{chacha_key:i,chacha_nonce:s,hmac_key:c}=Yr(e,n),a=Xr(c,r,n);if(!Mi(a,o))throw new Error("invalid MAC");const l=Br(i,s,r);return cc(l)}var lc={utils:{getConversationKey:un,calcPaddedLen:dn},encrypt:hn,decrypt:pn},uc=2*24*60*60,Qr=()=>Math.round(Date.now()/1e3),to=()=>Math.round(Qr()-Math.random()*uc),eo=(t,e)=>un(t,e),no=(t,e,n)=>hn(JSON.stringify(t),eo(e,n)),jn=(t,e)=>JSON.parse(pn(t.content,eo(e,t.pubkey)));function ro(t,e){const n={created_at:Qr(),content:"",tags:[],...t,pubkey:fe(e)};return n.id=Ft(n),n}function oo(t,e,n){return Q({kind:Ur,content:no(t,e,n),created_at:to(),tags:[]},e)}function io(t,e){const n=Ir();return Q({kind:Mr,content:no(t,n,e),created_at:to(),tags:[["p",e]]},n)}function te(t,e,n){const r=ro(t,e),o=oo(r,e,n);return io(o,n)}function dc(t,e,n){if(!n||n.length===0)throw new Error("At least one recipient is required.");const r=fe(e),o=[te(t,e,r)];return n.forEach(i=>{o.push(te(t,e,i))}),o}function gn(t,e){const n=jn(t,e);return jn(n,e)}function so(t,e){let n=[];return t.forEach(r=>{n.push(gn(r,e))}),n.sort((r,o)=>r.created_at-o.created_at),n}function hc(t,e,n,r){const o={created_at:Math.ceil(Date.now()/1e3),kind:Tr,tags:[],content:e};return(Array.isArray(t)?t:[t]).forEach(({publicKey:s,relayUrl:c})=>{o.tags.push(c?["p",s,c]:["p",s])}),r&&o.tags.push(["e",r.eventId,r.relayUrl||"","reply"]),n&&o.tags.push(["subject",n]),o}function ao(t,e,n,r,o){const i=hc(e,n,r,o);return te(i,t,e.publicKey)}function pc(t,e,n,r,o){if(!e||e.length===0)throw new Error("At least one recipient is required.");return[{publicKey:fe(t)},...e].map(s=>ao(t,s,n,r,o))}var gc=gn,yc=so,wc={};P(wc,{finishRepostEvent:()=>bc,getRepostedEvent:()=>Ec,getRepostedEventPointer:()=>co});function bc(t,e,n,r){var s;let o;const i=[...t.tags??[],["e",e.id,n],["p",e.pubkey]];return e.kind===kr?o=nn:(o=on,i.push(["k",String(e.kind)])),Q({kind:o,tags:i,content:t.content===""||(s=e.tags)!=null&&s.find(c=>c[0]==="-")?"":JSON.stringify(e),created_at:t.created_at},r)}function co(t){if(![nn,on].includes(t.kind))return;let e,n;for(let r=t.tags.length-1;r>=0&&(e===void 0||n===void 0);r--){const o=t.tags[r];o.length>=2&&(o[0]==="e"&&e===void 0?e=o:o[0]==="p"&&n===void 0&&(n=o))}if(e!==void 0)return{id:e[1],relays:[e[2],n==null?void 0:n[2]].filter(r=>typeof r=="string"),author:n==null?void 0:n[1]}}function Ec(t,{skipVerification:e}={}){const n=co(t);if(n===void 0||t.content==="")return;let r;try{r=JSON.parse(t.content)}catch{return}if(r.id===n.id&&!(!e&&!le(r)))return r}var mc={};P(mc,{NOSTR_URI_REGEX:()=>yn,parse:()=>vc,test:()=>xc});var yn=new RegExp(`nostr:(${Dr.source})`);function xc(t){return typeof t=="string"&&new RegExp(`^${yn.source}$`).test(t)}function vc(t){const e=t.match(new RegExp(`^${yn.source}$`));if(!e)throw new Error(`Invalid Nostr URI: ${t}`);return{uri:e[0],value:e[1],decoded:ue(e[1])}}var Ac={};P(Ac,{finishReactionEvent:()=>Bc,getReactedEventPointer:()=>Sc});function Bc(t,e,n){const r=e.tags.filter(o=>o.length>=2&&(o[0]==="e"||o[0]==="p"));return Q({...t,kind:rn,tags:[...t.tags??[],...r,["e",e.id],["p",e.pubkey]],content:t.content??"+"},n)}function Sc(t){if(t.kind!==rn)return;let e,n;for(let r=t.tags.length-1;r>=0&&(e===void 0||n===void 0);r--){const o=t.tags[r];o.length>=2&&(o[0]==="e"&&e===void 0?e=o:o[0]==="p"&&n===void 0&&(n=o))}if(!(e===void 0||n===void 0))return{id:e[1],relays:[e[2],n[2]].filter(r=>r!==void 0),author:n[1]}}var _c={};P(_c,{parse:()=>Lc});var Ic=/\W/m,Dn=/\W |\W$|$|,| /m;function*Lc(t){const e=t.length;let n=0,r=0;for(;r<e;){let o=t.indexOf(":",r);if(o===-1)break;if(t.substring(o-5,o)==="nostr"){const i=t.substring(o+60).match(Ic),s=i?o+60+i.index:e;try{let c,{data:a,type:l}=ue(t.substring(o+1,s));switch(l){case"npub":c={pubkey:a};break;case"nsec":case"note":r=s+1;continue;default:c=a}n!==o-5&&(yield{type:"text",text:t.substring(n,o-5)}),yield{type:"reference",pointer:c},r=s,n=r;continue}catch{r=o+1;continue}}else if(t.substring(o-5,o)==="https"||t.substring(o-4,o)==="http"){const i=t.substring(o+4).match(Dn),s=i?o+4+i.index:e,c=t[o-1]==="s"?5:4;try{let a=new URL(t.substring(o-c,s));if(a.hostname.indexOf(".")===-1)throw new Error("invalid url");if(n!==o-c&&(yield{type:"text",text:t.substring(n,o-c)}),a.pathname.endsWith(".png")||a.pathname.endsWith(".jpg")||a.pathname.endsWith(".jpeg")||a.pathname.endsWith(".gif")||a.pathname.endsWith(".webp")){yield{type:"image",url:a.toString()},r=s,n=r;continue}if(a.pathname.endsWith(".mp4")||a.pathname.endsWith(".avi")||a.pathname.endsWith(".webm")||a.pathname.endsWith(".mkv")){yield{type:"video",url:a.toString()},r=s,n=r;continue}if(a.pathname.endsWith(".mp3")||a.pathname.endsWith(".aac")||a.pathname.endsWith(".ogg")||a.pathname.endsWith(".opus")){yield{type:"audio",url:a.toString()},r=s,n=r;continue}yield{type:"url",url:a.toString()},r=s,n=r;continue}catch{r=s+1;continue}}else if(t.substring(o-3,o)==="wss"||t.substring(o-2,o)==="ws"){const i=t.substring(o+4).match(Dn),s=i?o+4+i.index:e,c=t[o-1]==="s"?3:2;try{let a=new URL(t.substring(o-c,s));if(a.hostname.indexOf(".")===-1)throw new Error("invalid ws url");n!==o-c&&(yield{type:"text",text:t.substring(n,o-c)}),yield{type:"relay",url:a.toString()},r=s,n=r;continue}catch{r=s+1;continue}}else{r=o+1;continue}}n!==e&&(yield{type:"text",text:t.substring(n)})}var $c={};P($c,{channelCreateEvent:()=>kc,channelHideMessageEvent:()=>Rc,channelMessageEvent:()=>Tc,channelMetadataEvent:()=>Uc,channelMuteUserEvent:()=>Nc});var kc=(t,e)=>{let n;if(typeof t.content=="object")n=JSON.stringify(t.content);else if(typeof t.content=="string")n=t.content;else return;return Q({kind:Rr,tags:[...t.tags??[]],content:n,created_at:t.created_at},e)},Uc=(t,e)=>{let n;if(typeof t.content=="object")n=JSON.stringify(t.content);else if(typeof t.content=="string")n=t.content;else return;return Q({kind:Nr,tags:[["e",t.channel_create_event_id],...t.tags??[]],content:n,created_at:t.created_at},e)},Tc=(t,e)=>{const n=[["e",t.channel_create_event_id,t.relay_url,"root"]];return t.reply_to_channel_message_event_id&&n.push(["e",t.reply_to_channel_message_event_id,t.relay_url,"reply"]),Q({kind:Cr,tags:[...n,...t.tags??[]],content:t.content,created_at:t.created_at},e)},Rc=(t,e)=>{let n;if(typeof t.content=="object")n=JSON.stringify(t.content);else if(typeof t.content=="string")n=t.content;else return;return Q({kind:Or,tags:[["e",t.channel_message_event_id],...t.tags??[]],content:n,created_at:t.created_at},e)},Nc=(t,e)=>{let n;if(typeof t.content=="object")n=JSON.stringify(t.content);else if(typeof t.content=="string")n=t.content;else return;return Q({kind:Hr,tags:[["p",t.pubkey_to_mute],...t.tags??[]],content:n,created_at:t.created_at},e)},Cc={};P(Cc,{EMOJI_SHORTCODE_REGEX:()=>fo,matchAll:()=>Oc,regex:()=>wn,replaceAll:()=>Hc});var fo=/:(\w+):/,wn=()=>new RegExp(`\\B${fo.source}\\B`,"g");function*Oc(t){const e=t.matchAll(wn());for(const n of e)try{const[r,o]=n;yield{shortcode:r,name:o,start:n.index,end:n.index+r.length}}catch{}}function Hc(t,e){return t.replaceAll(wn(),(n,r)=>e({shortcode:n,name:r}))}var Mc={};P(Mc,{useFetchImplementation:()=>Pc,validateGithub:()=>qc});var bn;try{bn=fetch}catch{}function Pc(t){bn=t}async function qc(t,e,n){try{return await(await bn(`https://gist.github.com/${e}/${n}/raw`)).text()===`Verifying that I control the following Nostr public key: ${t}`}catch{return!1}}var jc={};P(jc,{makeNwcRequestEvent:()=>Wc,parseConnectionString:()=>Dc});function Dc(t){const{host:e,pathname:n,searchParams:r}=new URL(t),o=n||e,i=r.get("relay"),s=r.get("secret");if(!o||!i||!s)throw new Error("invalid connection string");return{pubkey:o,relay:i,secret:s}}async function Wc(t,e,n){const o=Wr(e,t,JSON.stringify({method:"pay_invoice",params:{invoice:n}})),i={kind:qr,created_at:Math.round(Date.now()/1e3),content:o,tags:[["p",t]]};return Q(i,e)}var zc={};P(zc,{normalizeIdentifier:()=>Vc});function Vc(t){return t=t.trim().toLowerCase(),t=t.normalize("NFKC"),Array.from(t).map(e=>new RegExp("\\p{Letter}","u").test(e)||new RegExp("\\p{Number}","u").test(e)?e:"-").join("")}var Kc={};P(Kc,{getSatoshisAmountFromBolt11:()=>Xc,getZapEndpoint:()=>Fc,makeZapReceipt:()=>Yc,makeZapRequest:()=>Gc,useFetchImplementation:()=>Zc,validateZapRequest:()=>Jc});var En;try{En=fetch}catch{}function Zc(t){En=t}async function Fc(t){try{let e="",{lud06:n,lud16:r}=JSON.parse(t.content);if(n){let{words:s}=Ct.decode(n,1e3),c=Ct.fromWords(s);e=st.decode(c)}else if(r){let[s,c]=r.split("@");e=new URL(`/.well-known/lnurlp/${s}`,`https://${c}`).toString()}else return null;let i=await(await En(e)).json();if(i.allowsNostr&&i.nostrPubkey)return i.callback}catch{}return null}function Gc(t){let e={kind:9734,created_at:Math.round(Date.now()/1e3),content:t.comment||"",tags:[["p","pubkey"in t?t.pubkey:t.event.pubkey],["amount",t.amount.toString()],["relays",...t.relays]]};if("event"in t){if(tn(t.event.kind)){const n=["a",`${t.event.kind}:${t.event.pubkey}:`];e.tags.push(n)}else if(en(t.event.kind)){let n=t.event.tags.find(([o,i])=>o==="d"&&i);if(!n)throw new Error("d tag not found or is empty");const r=["a",`${t.event.kind}:${t.event.pubkey}:${n[1]}`];e.tags.push(r)}e.tags.push(["k",t.event.kind.toString()])}return e}function Jc(t){let e;try{e=JSON.parse(t)}catch{return"Invalid zap request JSON."}if(!Xe(e))return"Zap request is not a valid Nostr event.";if(!le(e))return"Invalid signature on zap request.";let n=e.tags.find(([i,s])=>i==="p"&&s);if(!n)return"Zap request doesn't have a 'p' tag.";if(!n[1].match(/^[a-f0-9]{64}$/))return"Zap request 'p' tag is not valid hex.";let r=e.tags.find(([i,s])=>i==="e"&&s);return r&&!r[1].match(/^[a-f0-9]{64}$/)?"Zap request 'e' tag is not valid hex.":e.tags.find(([i,s])=>i==="relays"&&s)?null:"Zap request doesn't have a 'relays' tag."}function Yc({zapRequest:t,preimage:e,bolt11:n,paidAt:r}){let o=JSON.parse(t),i=o.tags.filter(([c])=>c==="e"||c==="p"||c==="a"),s={kind:9735,created_at:Math.round(r.getTime()/1e3),content:"",tags:[...i,["P",o.pubkey],["bolt11",n],["description",t]]};return e&&s.tags.push(["preimage",e]),s}function Xc(t){if(t.length<50)return 0;t=t.substring(0,50);const e=t.lastIndexOf("1");if(e===-1)return 0;const n=t.substring(0,e);if(!n.startsWith("lnbc"))return 0;const r=n.substring(4);if(r.length<1)return 0;const o=r[r.length-1],i=o.charCodeAt(0)-48,s=i>=0&&i<=9;let c=r.length-1;if(s&&c++,c<1)return 0;const a=parseInt(r.substring(0,c));switch(o){case"m":return a*1e5;case"u":return a*100;case"n":return a/10;case"p":return a/1e4;default:return a*1e8}}var Qc={};P(Qc,{getToken:()=>tf,hashPayload:()=>mn,unpackEventFromToken:()=>uo,validateEvent:()=>bo,validateEventKind:()=>po,validateEventMethodTag:()=>yo,validateEventPayloadTag:()=>wo,validateEventTimestamp:()=>ho,validateEventUrlTag:()=>go,validateToken:()=>ef});var lo="Nostr ";async function tf(t,e,n,r=!1,o){const i={kind:sn,tags:[["u",t],["method",e]],created_at:Math.round(new Date().getTime()/1e3),content:""};o&&i.tags.push(["payload",mn(o)]);const s=await n(i);return(r?lo:"")+at.encode(X.encode(JSON.stringify(s)))}async function ef(t,e,n){const r=await uo(t).catch(i=>{throw i});return await bo(r,e,n).catch(i=>{throw i})}async function uo(t){if(!t)throw new Error("Missing token");t=t.replace(lo,"");const e=st.decode(at.decode(t));if(!e||e.length===0||!e.startsWith("{"))throw new Error("Invalid token");return JSON.parse(e)}function ho(t){return t.created_at?Math.round(new Date().getTime()/1e3)-t.created_at<60:!1}function po(t){return t.kind===sn}function go(t,e){const n=t.tags.find(r=>r[0]==="u");return n?n.length>0&&n[1]===e:!1}function yo(t,e){const n=t.tags.find(r=>r[0]==="method");return n?n.length>0&&n[1].toLowerCase()===e.toLowerCase():!1}function mn(t){const e=Ht(X.encode(JSON.stringify(t)));return V(e)}function wo(t,e){const n=t.tags.find(o=>o[0]==="payload");if(!n)return!1;const r=mn(e);return n.length>0&&n[1]===r}async function bo(t,e,n,r){if(!le(t))throw new Error("Invalid nostr event, signature invalid");if(!po(t))throw new Error("Invalid nostr event, kind invalid");if(!ho(t))throw new Error("Invalid nostr event, created_at timestamp invalid");if(!go(t,e))throw new Error("Invalid nostr event, url tag invalid");if(!yo(t,n))throw new Error("Invalid nostr event, method tag invalid");if(r&&typeof r=="object"&&Object.keys(r).length>0&&!wo(t,r))throw new Error("Invalid nostr event, payload tag does not match request body hash");return!0}const xn={keyFromNsec:t=>({pub:nf(t),sec:t,sign:e=>Eo(e,t)}),randomKey:()=>{const t=zt.nsecEncode(Ir());return xn.keyFromNsec(t)},checkEvent:t=>le(t)};function nf(t){const e=zt.decode(t);if(e.type!=="nsec")throw new Error("Invalid secret key");const n=zt.npubEncode(fe(e.data));if(n.startsWith("npub1"))return n;throw new Error("Invalid public key")}const Eo=(t,e)=>{let n={kind:1,tags:[],content:t,created_at:Math.floor(Date.now()/1e3)};return Q(n,zt.decode(e).data)},qe=async t=>{const e=await crypto.subtle.digest("SHA-256",new TextEncoder().encode(t));return Array.from(new Uint8Array(e)).map(r=>r.toString(16).padStart(2,"0")).join("")};function rf(t){return{getCtx:t.getCtx.toString(),api:Object.fromEntries(Object.entries(t.api).map(([e,n])=>[e,n.toString()]))}}async function of(t){const e=await qe(JSON.stringify(t)),n={};for(const[r,o]of Object.entries(t.api))n[r]=await qe(o+e);return{hash:e,apiHashes:n}}async function sf(t,e,n){async function r(s){const c=Eo(JSON.stringify(s),n.sec),a=await fetch(t,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(c)});if(!a.ok)console.error(await a.text());else return a.json()}const o=rf(e),i=await of(o);return await r({pubkey:n.pub,tag:"publish",app:o}),await r({pubkey:n.pub,tag:"host",hash:i.hash,allowed:!0}),async(s,c,a=null)=>{const l=await qe(c.toString()+i.hash);if(!Object.values(i.apiHashes).includes(l))throw new Error("illegal lambda");const u={tag:"call",pubkey:n.pub,app:i.hash,lam:l,host:s,argument:a};return await r(u)}}const Ie={getCtx:()=>({msgs:t=>t.store("msgs",!0)}),api:{putMsg:(t,e,n,r)=>{t.msgs(n).update(o=>[...o??[],[e.pubkey,r]])},seeMsgs:(t,e,n,r)=>t.msgs(e).get()??[]}};localStorage.setItem("key",localStorage.getItem("key")??xn.randomKey().sec);const Zt=xn.keyFromNsec(localStorage.getItem("key")),af="https://lamboxserver.duckdns.org";sf(af,Ie,Zt).then(async t=>{await t(Zt.pub,Ie.api.putMsg,"hello, self");const e=await t(Zt.pub,Ie.api.seeMsgs,Zt.pub);console.log(e)}).catch(console.error);
