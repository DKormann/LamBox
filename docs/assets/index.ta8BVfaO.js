var Lo=Object.defineProperty;var ko=(t,e,n)=>e in t?Lo(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var gt=(t,e,n)=>ko(t,typeof e!="symbol"?e+"":e,n);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const s of o)if(s.type==="childList")for(const i of s.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&r(i)}).observe(document,{childList:!0,subtree:!0});function n(o){const s={};return o.integrity&&(s.integrity=o.integrity),o.referrerPolicy&&(s.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?s.credentials="include":o.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(o){if(o.ep)return;o.ep=!0;const s=n(o);fetch(o.href,s)}})();function Ln(t){if(!Number.isSafeInteger(t)||t<0)throw new Error(`Wrong positive integer: ${t}`)}function Gn(t,...e){if(!(t instanceof Uint8Array))throw new Error("Expected Uint8Array");if(e.length>0&&!e.includes(t.length))throw new Error(`Expected Uint8Array of length ${e}, not of length=${t.length}`)}function Uo(t){if(typeof t!="function"||typeof t.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");Ln(t.outputLen),Ln(t.blockLen)}function Qt(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function $o(t,e){Gn(t);const n=e.outputLen;if(t.length<n)throw new Error(`digestInto() expects output buffer of length at least ${n}`)}const xe=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Jn=t=>t instanceof Uint8Array,Ae=t=>new DataView(t.buffer,t.byteOffset,t.byteLength),nt=(t,e)=>t<<32-e|t>>>e,To=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;if(!To)throw new Error("Non little-endian hardware is not supported");function Co(t){if(typeof t!="string")throw new Error(`utf8ToBytes expected string, got ${typeof t}`);return new Uint8Array(new TextEncoder().encode(t))}function Ke(t){if(typeof t=="string"&&(t=Co(t)),!Jn(t))throw new Error(`expected Uint8Array, got ${typeof t}`);return t}function No(...t){const e=new Uint8Array(t.reduce((r,o)=>r+o.length,0));let n=0;return t.forEach(r=>{if(!Jn(r))throw new Error("Uint8Array expected");e.set(r,n),n+=r.length}),e}let Yn=class{clone(){return this._cloneInto()}};function Ro(t){const e=r=>t().update(Ke(r)).digest(),n=t();return e.outputLen=n.outputLen,e.blockLen=n.blockLen,e.create=()=>t(),e}function Xn(t=32){if(xe&&typeof xe.getRandomValues=="function")return xe.getRandomValues(new Uint8Array(t));throw new Error("crypto.getRandomValues must be defined")}function Oo(t,e,n,r){if(typeof t.setBigUint64=="function")return t.setBigUint64(e,n,r);const o=BigInt(32),s=BigInt(4294967295),i=Number(n>>o&s),c=Number(n&s),a=r?4:0,f=r?0:4;t.setUint32(e+a,i,r),t.setUint32(e+f,c,r)}let Ho=class extends Yn{constructor(e,n,r,o){super(),this.blockLen=e,this.outputLen=n,this.padOffset=r,this.isLE=o,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=Ae(this.buffer)}update(e){Qt(this);const{view:n,buffer:r,blockLen:o}=this;e=Ke(e);const s=e.length;for(let i=0;i<s;){const c=Math.min(o-this.pos,s-i);if(c===o){const a=Ae(e);for(;o<=s-i;i+=o)this.process(a,i);continue}r.set(e.subarray(i,i+c),this.pos),this.pos+=c,i+=c,this.pos===o&&(this.process(n,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){Qt(this),$o(e,this),this.finished=!0;const{buffer:n,view:r,blockLen:o,isLE:s}=this;let{pos:i}=this;n[i++]=128,this.buffer.subarray(i).fill(0),this.padOffset>o-i&&(this.process(r,0),i=0);for(let l=i;l<o;l++)n[l]=0;Oo(r,o-8,BigInt(this.length*8),s),this.process(r,0);const c=Ae(e),a=this.outputLen;if(a%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const f=a/4,u=this.get();if(f>u.length)throw new Error("_sha2: outputLen bigger than state");for(let l=0;l<f;l++)c.setUint32(4*l,u[l],s)}digest(){const{buffer:e,outputLen:n}=this;this.digestInto(e);const r=e.slice(0,n);return this.destroy(),r}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:n,buffer:r,length:o,finished:s,destroyed:i,pos:c}=this;return e.length=o,e.pos=c,e.finished=s,e.destroyed=i,o%n&&e.buffer.set(r),e}};const Mo=(t,e,n)=>t&e^~t&n,Po=(t,e,n)=>t&e^t&n^e&n,qo=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),yt=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),wt=new Uint32Array(64);let jo=class extends Ho{constructor(){super(64,32,8,!1),this.A=yt[0]|0,this.B=yt[1]|0,this.C=yt[2]|0,this.D=yt[3]|0,this.E=yt[4]|0,this.F=yt[5]|0,this.G=yt[6]|0,this.H=yt[7]|0}get(){const{A:e,B:n,C:r,D:o,E:s,F:i,G:c,H:a}=this;return[e,n,r,o,s,i,c,a]}set(e,n,r,o,s,i,c,a){this.A=e|0,this.B=n|0,this.C=r|0,this.D=o|0,this.E=s|0,this.F=i|0,this.G=c|0,this.H=a|0}process(e,n){for(let l=0;l<16;l++,n+=4)wt[l]=e.getUint32(n,!1);for(let l=16;l<64;l++){const b=wt[l-15],h=wt[l-2],g=nt(b,7)^nt(b,18)^b>>>3,d=nt(h,17)^nt(h,19)^h>>>10;wt[l]=d+wt[l-7]+g+wt[l-16]|0}let{A:r,B:o,C:s,D:i,E:c,F:a,G:f,H:u}=this;for(let l=0;l<64;l++){const b=nt(c,6)^nt(c,11)^nt(c,25),h=u+b+Mo(c,a,f)+qo[l]+wt[l]|0,d=(nt(r,2)^nt(r,13)^nt(r,22))+Po(r,o,s)|0;u=f,f=a,a=c,c=i+h|0,i=s,s=o,o=r,r=h+d|0}r=r+this.A|0,o=o+this.B|0,s=s+this.C|0,i=i+this.D|0,c=c+this.E|0,a=a+this.F|0,f=f+this.G|0,u=u+this.H|0,this.set(r,o,s,i,c,a,f,u)}roundClean(){wt.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}};const Ce=Ro(()=>new jo);/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Qn=BigInt(0),ae=BigInt(1),Do=BigInt(2),ce=t=>t instanceof Uint8Array,Wo=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function Ht(t){if(!ce(t))throw new Error("Uint8Array expected");let e="";for(let n=0;n<t.length;n++)e+=Wo[t[n]];return e}function tr(t){const e=t.toString(16);return e.length&1?`0${e}`:e}function Ve(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);return BigInt(t===""?"0":`0x${t}`)}function Mt(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);const e=t.length;if(e%2)throw new Error("padded hex string expected, got unpadded hex of length "+e);const n=new Uint8Array(e/2);for(let r=0;r<n.length;r++){const o=r*2,s=t.slice(o,o+2),i=Number.parseInt(s,16);if(Number.isNaN(i)||i<0)throw new Error("Invalid byte sequence");n[r]=i}return n}function Z(t){return Ve(Ht(t))}function Fe(t){if(!ce(t))throw new Error("Uint8Array expected");return Ve(Ht(Uint8Array.from(t).reverse()))}function xt(t,e){return Mt(t.toString(16).padStart(e*2,"0"))}function Ze(t,e){return xt(t,e).reverse()}function zo(t){return Mt(tr(t))}function z(t,e,n){let r;if(typeof e=="string")try{r=Mt(e)}catch(s){throw new Error(`${t} must be valid hex string, got "${e}". Cause: ${s}`)}else if(ce(e))r=Uint8Array.from(e);else throw new Error(`${t} must be hex string or Uint8Array`);const o=r.length;if(typeof n=="number"&&o!==n)throw new Error(`${t} expected ${n} bytes, got ${o}`);return r}function It(...t){const e=new Uint8Array(t.reduce((r,o)=>r+o.length,0));let n=0;return t.forEach(r=>{if(!ce(r))throw new Error("Uint8Array expected");e.set(r,n),n+=r.length}),e}function Ko(t,e){if(t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}function Vo(t){if(typeof t!="string")throw new Error(`utf8ToBytes expected string, got ${typeof t}`);return new Uint8Array(new TextEncoder().encode(t))}function Fo(t){let e;for(e=0;t>Qn;t>>=ae,e+=1);return e}function Zo(t,e){return t>>BigInt(e)&ae}const Go=(t,e,n)=>t|(n?ae:Qn)<<BigInt(e),Ge=t=>(Do<<BigInt(t-1))-ae,Be=t=>new Uint8Array(t),kn=t=>Uint8Array.from(t);function er(t,e,n){if(typeof t!="number"||t<2)throw new Error("hashLen must be a number");if(typeof e!="number"||e<2)throw new Error("qByteLen must be a number");if(typeof n!="function")throw new Error("hmacFn must be a function");let r=Be(t),o=Be(t),s=0;const i=()=>{r.fill(1),o.fill(0),s=0},c=(...l)=>n(o,r,...l),a=(l=Be())=>{o=c(kn([0]),l),r=c(),l.length!==0&&(o=c(kn([1]),l),r=c())},f=()=>{if(s++>=1e3)throw new Error("drbg: tried 1000 values");let l=0;const b=[];for(;l<e;){r=c();const h=r.slice();b.push(h),l+=r.length}return It(...b)};return(l,b)=>{i(),a(l);let h;for(;!(h=b(f()));)a();return i(),h}}const Jo={bigint:t=>typeof t=="bigint",function:t=>typeof t=="function",boolean:t=>typeof t=="boolean",string:t=>typeof t=="string",stringOrUint8Array:t=>typeof t=="string"||t instanceof Uint8Array,isSafeInteger:t=>Number.isSafeInteger(t),array:t=>Array.isArray(t),field:(t,e)=>e.Fp.isValid(t),hash:t=>typeof t=="function"&&Number.isSafeInteger(t.outputLen)};function Jt(t,e,n={}){const r=(o,s,i)=>{const c=Jo[s];if(typeof c!="function")throw new Error(`Invalid validator "${s}", expected function`);const a=t[o];if(!(i&&a===void 0)&&!c(a,t))throw new Error(`Invalid param ${String(o)}=${a} (${typeof a}), expected ${s}`)};for(const[o,s]of Object.entries(e))r(o,s,!1);for(const[o,s]of Object.entries(n))r(o,s,!0);return t}const Yo=Object.freeze(Object.defineProperty({__proto__:null,bitGet:Zo,bitLen:Fo,bitMask:Ge,bitSet:Go,bytesToHex:Ht,bytesToNumberBE:Z,bytesToNumberLE:Fe,concatBytes:It,createHmacDrbg:er,ensureBytes:z,equalBytes:Ko,hexToBytes:Mt,hexToNumber:Ve,numberToBytesBE:xt,numberToBytesLE:Ze,numberToHexUnpadded:tr,numberToVarBytesBE:zo,utf8ToBytes:Vo,validateObject:Jt},Symbol.toStringTag,{value:"Module"}));/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const D=BigInt(0),j=BigInt(1),St=BigInt(2),Xo=BigInt(3),Ne=BigInt(4),Un=BigInt(5),$n=BigInt(8);BigInt(9);BigInt(16);function W(t,e){const n=t%e;return n>=D?n:e+n}function Qo(t,e,n){if(n<=D||e<D)throw new Error("Expected power/modulo > 0");if(n===j)return D;let r=j;for(;e>D;)e&j&&(r=r*t%n),t=t*t%n,e>>=j;return r}function J(t,e,n){let r=t;for(;e-- >D;)r*=r,r%=n;return r}function Re(t,e){if(t===D||e<=D)throw new Error(`invert: expected positive integers, got n=${t} mod=${e}`);let n=W(t,e),r=e,o=D,s=j;for(;n!==D;){const c=r/n,a=r%n,f=o-s*c;r=n,n=a,o=s,s=f}if(r!==j)throw new Error("invert: does not exist");return W(o,e)}function ts(t){const e=(t-j)/St;let n,r,o;for(n=t-j,r=0;n%St===D;n/=St,r++);for(o=St;o<t&&Qo(o,e,t)!==t-j;o++);if(r===1){const i=(t+j)/Ne;return function(a,f){const u=a.pow(f,i);if(!a.eql(a.sqr(u),f))throw new Error("Cannot find square root");return u}}const s=(n+j)/St;return function(c,a){if(c.pow(a,e)===c.neg(c.ONE))throw new Error("Cannot find square root");let f=r,u=c.pow(c.mul(c.ONE,o),n),l=c.pow(a,s),b=c.pow(a,n);for(;!c.eql(b,c.ONE);){if(c.eql(b,c.ZERO))return c.ZERO;let h=1;for(let d=c.sqr(b);h<f&&!c.eql(d,c.ONE);h++)d=c.sqr(d);const g=c.pow(u,j<<BigInt(f-h-1));u=c.sqr(g),l=c.mul(l,g),b=c.mul(b,u),f=h}return l}}function es(t){if(t%Ne===Xo){const e=(t+j)/Ne;return function(r,o){const s=r.pow(o,e);if(!r.eql(r.sqr(s),o))throw new Error("Cannot find square root");return s}}if(t%$n===Un){const e=(t-Un)/$n;return function(r,o){const s=r.mul(o,St),i=r.pow(s,e),c=r.mul(o,i),a=r.mul(r.mul(c,St),i),f=r.mul(c,r.sub(a,r.ONE));if(!r.eql(r.sqr(f),o))throw new Error("Cannot find square root");return f}}return ts(t)}const ns=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function rs(t){const e={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},n=ns.reduce((r,o)=>(r[o]="function",r),e);return Jt(t,n)}function os(t,e,n){if(n<D)throw new Error("Expected power > 0");if(n===D)return t.ONE;if(n===j)return e;let r=t.ONE,o=e;for(;n>D;)n&j&&(r=t.mul(r,o)),o=t.sqr(o),n>>=j;return r}function ss(t,e){const n=new Array(e.length),r=e.reduce((s,i,c)=>t.is0(i)?s:(n[c]=s,t.mul(s,i)),t.ONE),o=t.inv(r);return e.reduceRight((s,i,c)=>t.is0(i)?s:(n[c]=t.mul(s,n[c]),t.mul(s,i)),o),n}function nr(t,e){const n=e!==void 0?e:t.toString(2).length,r=Math.ceil(n/8);return{nBitLength:n,nByteLength:r}}function is(t,e,n=!1,r={}){if(t<=D)throw new Error(`Expected Field ORDER > 0, got ${t}`);const{nBitLength:o,nByteLength:s}=nr(t,e);if(s>2048)throw new Error("Field lengths over 2048 bytes are not supported");const i=es(t),c=Object.freeze({ORDER:t,BITS:o,BYTES:s,MASK:Ge(o),ZERO:D,ONE:j,create:a=>W(a,t),isValid:a=>{if(typeof a!="bigint")throw new Error(`Invalid field element: expected bigint, got ${typeof a}`);return D<=a&&a<t},is0:a=>a===D,isOdd:a=>(a&j)===j,neg:a=>W(-a,t),eql:(a,f)=>a===f,sqr:a=>W(a*a,t),add:(a,f)=>W(a+f,t),sub:(a,f)=>W(a-f,t),mul:(a,f)=>W(a*f,t),pow:(a,f)=>os(c,a,f),div:(a,f)=>W(a*Re(f,t),t),sqrN:a=>a*a,addN:(a,f)=>a+f,subN:(a,f)=>a-f,mulN:(a,f)=>a*f,inv:a=>Re(a,t),sqrt:r.sqrt||(a=>i(c,a)),invertBatch:a=>ss(c,a),cmov:(a,f,u)=>u?f:a,toBytes:a=>n?Ze(a,s):xt(a,s),fromBytes:a=>{if(a.length!==s)throw new Error(`Fp.fromBytes: expected ${s}, got ${a.length}`);return n?Fe(a):Z(a)}});return Object.freeze(c)}function rr(t){if(typeof t!="bigint")throw new Error("field order must be bigint");const e=t.toString(2).length;return Math.ceil(e/8)}function or(t){const e=rr(t);return e+Math.ceil(e/2)}function as(t,e,n=!1){const r=t.length,o=rr(e),s=or(e);if(r<16||r<s||r>1024)throw new Error(`expected ${s}-1024 bytes of input, got ${r}`);const i=n?Z(t):Fe(t),c=W(i,e-j)+j;return n?Ze(c,o):xt(c,o)}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const cs=BigInt(0),Se=BigInt(1);function ls(t,e){const n=(o,s)=>{const i=s.negate();return o?i:s},r=o=>{const s=Math.ceil(e/o)+1,i=2**(o-1);return{windows:s,windowSize:i}};return{constTimeNegate:n,unsafeLadder(o,s){let i=t.ZERO,c=o;for(;s>cs;)s&Se&&(i=i.add(c)),c=c.double(),s>>=Se;return i},precomputeWindow(o,s){const{windows:i,windowSize:c}=r(s),a=[];let f=o,u=f;for(let l=0;l<i;l++){u=f,a.push(u);for(let b=1;b<c;b++)u=u.add(f),a.push(u);f=u.double()}return a},wNAF(o,s,i){const{windows:c,windowSize:a}=r(o);let f=t.ZERO,u=t.BASE;const l=BigInt(2**o-1),b=2**o,h=BigInt(o);for(let g=0;g<c;g++){const d=g*a;let p=Number(i&l);i>>=h,p>a&&(p-=b,i+=Se);const y=d,v=d+Math.abs(p)-1,S=g%2!==0,$=p<0;p===0?u=u.add(n(S,s[y])):f=f.add(n($,s[v]))}return{p:f,f:u}},wNAFCached(o,s,i,c){const a=o._WINDOW_SIZE||1;let f=s.get(o);return f||(f=this.precomputeWindow(o,a),a!==1&&s.set(o,c(f))),this.wNAF(a,f,i)}}}function sr(t){return rs(t.Fp),Jt(t,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...nr(t.n,t.nBitLength),...t,p:t.Fp.ORDER})}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */function fs(t){const e=sr(t);Jt(e,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});const{endo:n,Fp:r,a:o}=e;if(n){if(!r.eql(o,r.ZERO))throw new Error("Endomorphism can only be defined for Koblitz curves that have a=0");if(typeof n!="object"||typeof n.beta!="bigint"||typeof n.splitScalar!="function")throw new Error("Expected endomorphism with beta: bigint and splitScalar: function")}return Object.freeze({...e})}const{bytesToNumberBE:us,hexToBytes:ds}=Yo,_t={Err:class extends Error{constructor(e=""){super(e)}},_parseInt(t){const{Err:e}=_t;if(t.length<2||t[0]!==2)throw new e("Invalid signature integer tag");const n=t[1],r=t.subarray(2,n+2);if(!n||r.length!==n)throw new e("Invalid signature integer: wrong length");if(r[0]&128)throw new e("Invalid signature integer: negative");if(r[0]===0&&!(r[1]&128))throw new e("Invalid signature integer: unnecessary leading zero");return{d:us(r),l:t.subarray(n+2)}},toSig(t){const{Err:e}=_t,n=typeof t=="string"?ds(t):t;if(!(n instanceof Uint8Array))throw new Error("ui8a expected");let r=n.length;if(r<2||n[0]!=48)throw new e("Invalid signature tag");if(n[1]!==r-2)throw new e("Invalid signature: incorrect length");const{d:o,l:s}=_t._parseInt(n.subarray(2)),{d:i,l:c}=_t._parseInt(s);if(c.length)throw new e("Invalid signature: left bytes after parsing");return{r:o,s:i}},hexFromSig(t){const e=f=>Number.parseInt(f[0],16)&8?"00"+f:f,n=f=>{const u=f.toString(16);return u.length&1?`0${u}`:u},r=e(n(t.s)),o=e(n(t.r)),s=r.length/2,i=o.length/2,c=n(s),a=n(i);return`30${n(i+s+4)}02${a}${o}02${c}${r}`}},it=BigInt(0),Y=BigInt(1);BigInt(2);const Tn=BigInt(3);BigInt(4);function hs(t){const e=fs(t),{Fp:n}=e,r=e.toBytes||((g,d,p)=>{const y=d.toAffine();return It(Uint8Array.from([4]),n.toBytes(y.x),n.toBytes(y.y))}),o=e.fromBytes||(g=>{const d=g.subarray(1),p=n.fromBytes(d.subarray(0,n.BYTES)),y=n.fromBytes(d.subarray(n.BYTES,2*n.BYTES));return{x:p,y}});function s(g){const{a:d,b:p}=e,y=n.sqr(g),v=n.mul(y,g);return n.add(n.add(v,n.mul(g,d)),p)}if(!n.eql(n.sqr(e.Gy),s(e.Gx)))throw new Error("bad generator point: equation left != right");function i(g){return typeof g=="bigint"&&it<g&&g<e.n}function c(g){if(!i(g))throw new Error("Expected valid bigint: 0 < bigint < curve.n")}function a(g){const{allowedPrivateKeyLengths:d,nByteLength:p,wrapPrivateKey:y,n:v}=e;if(d&&typeof g!="bigint"){if(g instanceof Uint8Array&&(g=Ht(g)),typeof g!="string"||!d.includes(g.length))throw new Error("Invalid key");g=g.padStart(p*2,"0")}let S;try{S=typeof g=="bigint"?g:Z(z("private key",g,p))}catch{throw new Error(`private key must be ${p} bytes, hex or bigint, not ${typeof g}`)}return y&&(S=W(S,v)),c(S),S}const f=new Map;function u(g){if(!(g instanceof l))throw new Error("ProjectivePoint expected")}class l{constructor(d,p,y){if(this.px=d,this.py=p,this.pz=y,d==null||!n.isValid(d))throw new Error("x required");if(p==null||!n.isValid(p))throw new Error("y required");if(y==null||!n.isValid(y))throw new Error("z required")}static fromAffine(d){const{x:p,y}=d||{};if(!d||!n.isValid(p)||!n.isValid(y))throw new Error("invalid affine point");if(d instanceof l)throw new Error("projective point not allowed");const v=S=>n.eql(S,n.ZERO);return v(p)&&v(y)?l.ZERO:new l(p,y,n.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(d){const p=n.invertBatch(d.map(y=>y.pz));return d.map((y,v)=>y.toAffine(p[v])).map(l.fromAffine)}static fromHex(d){const p=l.fromAffine(o(z("pointHex",d)));return p.assertValidity(),p}static fromPrivateKey(d){return l.BASE.multiply(a(d))}_setWindowSize(d){this._WINDOW_SIZE=d,f.delete(this)}assertValidity(){if(this.is0()){if(e.allowInfinityPoint&&!n.is0(this.py))return;throw new Error("bad point: ZERO")}const{x:d,y:p}=this.toAffine();if(!n.isValid(d)||!n.isValid(p))throw new Error("bad point: x or y not FE");const y=n.sqr(p),v=s(d);if(!n.eql(y,v))throw new Error("bad point: equation left != right");if(!this.isTorsionFree())throw new Error("bad point: not in prime-order subgroup")}hasEvenY(){const{y:d}=this.toAffine();if(n.isOdd)return!n.isOdd(d);throw new Error("Field doesn't support isOdd")}equals(d){u(d);const{px:p,py:y,pz:v}=this,{px:S,py:$,pz:L}=d,E=n.eql(n.mul(p,L),n.mul(S,v)),x=n.eql(n.mul(y,L),n.mul($,v));return E&&x}negate(){return new l(this.px,n.neg(this.py),this.pz)}double(){const{a:d,b:p}=e,y=n.mul(p,Tn),{px:v,py:S,pz:$}=this;let L=n.ZERO,E=n.ZERO,x=n.ZERO,A=n.mul(v,v),M=n.mul(S,S),U=n.mul($,$),_=n.mul(v,S);return _=n.add(_,_),x=n.mul(v,$),x=n.add(x,x),L=n.mul(d,x),E=n.mul(y,U),E=n.add(L,E),L=n.sub(M,E),E=n.add(M,E),E=n.mul(L,E),L=n.mul(_,L),x=n.mul(y,x),U=n.mul(d,U),_=n.sub(A,U),_=n.mul(d,_),_=n.add(_,x),x=n.add(A,A),A=n.add(x,A),A=n.add(A,U),A=n.mul(A,_),E=n.add(E,A),U=n.mul(S,$),U=n.add(U,U),A=n.mul(U,_),L=n.sub(L,A),x=n.mul(U,M),x=n.add(x,x),x=n.add(x,x),new l(L,E,x)}add(d){u(d);const{px:p,py:y,pz:v}=this,{px:S,py:$,pz:L}=d;let E=n.ZERO,x=n.ZERO,A=n.ZERO;const M=e.a,U=n.mul(e.b,Tn);let _=n.mul(p,S),R=n.mul(y,$),O=n.mul(v,L),q=n.add(p,y),w=n.add(S,$);q=n.mul(q,w),w=n.add(_,R),q=n.sub(q,w),w=n.add(p,v);let m=n.add(S,L);return w=n.mul(w,m),m=n.add(_,O),w=n.sub(w,m),m=n.add(y,v),E=n.add($,L),m=n.mul(m,E),E=n.add(R,O),m=n.sub(m,E),A=n.mul(M,w),E=n.mul(U,O),A=n.add(E,A),E=n.sub(R,A),A=n.add(R,A),x=n.mul(E,A),R=n.add(_,_),R=n.add(R,_),O=n.mul(M,O),w=n.mul(U,w),R=n.add(R,O),O=n.sub(_,O),O=n.mul(M,O),w=n.add(w,O),_=n.mul(R,w),x=n.add(x,_),_=n.mul(m,w),E=n.mul(q,E),E=n.sub(E,_),_=n.mul(q,R),A=n.mul(m,A),A=n.add(A,_),new l(E,x,A)}subtract(d){return this.add(d.negate())}is0(){return this.equals(l.ZERO)}wNAF(d){return h.wNAFCached(this,f,d,p=>{const y=n.invertBatch(p.map(v=>v.pz));return p.map((v,S)=>v.toAffine(y[S])).map(l.fromAffine)})}multiplyUnsafe(d){const p=l.ZERO;if(d===it)return p;if(c(d),d===Y)return this;const{endo:y}=e;if(!y)return h.unsafeLadder(this,d);let{k1neg:v,k1:S,k2neg:$,k2:L}=y.splitScalar(d),E=p,x=p,A=this;for(;S>it||L>it;)S&Y&&(E=E.add(A)),L&Y&&(x=x.add(A)),A=A.double(),S>>=Y,L>>=Y;return v&&(E=E.negate()),$&&(x=x.negate()),x=new l(n.mul(x.px,y.beta),x.py,x.pz),E.add(x)}multiply(d){c(d);let p=d,y,v;const{endo:S}=e;if(S){const{k1neg:$,k1:L,k2neg:E,k2:x}=S.splitScalar(p);let{p:A,f:M}=this.wNAF(L),{p:U,f:_}=this.wNAF(x);A=h.constTimeNegate($,A),U=h.constTimeNegate(E,U),U=new l(n.mul(U.px,S.beta),U.py,U.pz),y=A.add(U),v=M.add(_)}else{const{p:$,f:L}=this.wNAF(p);y=$,v=L}return l.normalizeZ([y,v])[0]}multiplyAndAddUnsafe(d,p,y){const v=l.BASE,S=(L,E)=>E===it||E===Y||!L.equals(v)?L.multiplyUnsafe(E):L.multiply(E),$=S(this,p).add(S(d,y));return $.is0()?void 0:$}toAffine(d){const{px:p,py:y,pz:v}=this,S=this.is0();d==null&&(d=S?n.ONE:n.inv(v));const $=n.mul(p,d),L=n.mul(y,d),E=n.mul(v,d);if(S)return{x:n.ZERO,y:n.ZERO};if(!n.eql(E,n.ONE))throw new Error("invZ was invalid");return{x:$,y:L}}isTorsionFree(){const{h:d,isTorsionFree:p}=e;if(d===Y)return!0;if(p)return p(l,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){const{h:d,clearCofactor:p}=e;return d===Y?this:p?p(l,this):this.multiplyUnsafe(e.h)}toRawBytes(d=!0){return this.assertValidity(),r(l,this,d)}toHex(d=!0){return Ht(this.toRawBytes(d))}}l.BASE=new l(e.Gx,e.Gy,n.ONE),l.ZERO=new l(n.ZERO,n.ONE,n.ZERO);const b=e.nBitLength,h=ls(l,e.endo?Math.ceil(b/2):b);return{CURVE:e,ProjectivePoint:l,normPrivateKeyToScalar:a,weierstrassEquation:s,isWithinCurveOrder:i}}function ps(t){const e=sr(t);return Jt(e,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...e})}function gs(t){const e=ps(t),{Fp:n,n:r}=e,o=n.BYTES+1,s=2*n.BYTES+1;function i(w){return it<w&&w<n.ORDER}function c(w){return W(w,r)}function a(w){return Re(w,r)}const{ProjectivePoint:f,normPrivateKeyToScalar:u,weierstrassEquation:l,isWithinCurveOrder:b}=hs({...e,toBytes(w,m,B){const k=m.toAffine(),I=n.toBytes(k.x),T=It;return B?T(Uint8Array.from([m.hasEvenY()?2:3]),I):T(Uint8Array.from([4]),I,n.toBytes(k.y))},fromBytes(w){const m=w.length,B=w[0],k=w.subarray(1);if(m===o&&(B===2||B===3)){const I=Z(k);if(!i(I))throw new Error("Point is not on curve");const T=l(I);let H=n.sqrt(T);const N=(H&Y)===Y;return(B&1)===1!==N&&(H=n.neg(H)),{x:I,y:H}}else if(m===s&&B===4){const I=n.fromBytes(k.subarray(0,n.BYTES)),T=n.fromBytes(k.subarray(n.BYTES,2*n.BYTES));return{x:I,y:T}}else throw new Error(`Point of length ${m} was invalid. Expected ${o} compressed bytes or ${s} uncompressed bytes`)}}),h=w=>Ht(xt(w,e.nByteLength));function g(w){const m=r>>Y;return w>m}function d(w){return g(w)?c(-w):w}const p=(w,m,B)=>Z(w.slice(m,B));class y{constructor(m,B,k){this.r=m,this.s=B,this.recovery=k,this.assertValidity()}static fromCompact(m){const B=e.nByteLength;return m=z("compactSignature",m,B*2),new y(p(m,0,B),p(m,B,2*B))}static fromDER(m){const{r:B,s:k}=_t.toSig(z("DER",m));return new y(B,k)}assertValidity(){if(!b(this.r))throw new Error("r must be 0 < r < CURVE.n");if(!b(this.s))throw new Error("s must be 0 < s < CURVE.n")}addRecoveryBit(m){return new y(this.r,this.s,m)}recoverPublicKey(m){const{r:B,s:k,recovery:I}=this,T=x(z("msgHash",m));if(I==null||![0,1,2,3].includes(I))throw new Error("recovery id invalid");const H=I===2||I===3?B+e.n:B;if(H>=n.ORDER)throw new Error("recovery id 2 or 3 invalid");const N=I&1?"03":"02",X=f.fromHex(N+h(H)),ht=a(H),kt=c(-T*ht),Wt=c(k*ht),pt=f.BASE.multiplyAndAddUnsafe(X,kt,Wt);if(!pt)throw new Error("point at infinify");return pt.assertValidity(),pt}hasHighS(){return g(this.s)}normalizeS(){return this.hasHighS()?new y(this.r,c(-this.s),this.recovery):this}toDERRawBytes(){return Mt(this.toDERHex())}toDERHex(){return _t.hexFromSig({r:this.r,s:this.s})}toCompactRawBytes(){return Mt(this.toCompactHex())}toCompactHex(){return h(this.r)+h(this.s)}}const v={isValidPrivateKey(w){try{return u(w),!0}catch{return!1}},normPrivateKeyToScalar:u,randomPrivateKey:()=>{const w=or(e.n);return as(e.randomBytes(w),e.n)},precompute(w=8,m=f.BASE){return m._setWindowSize(w),m.multiply(BigInt(3)),m}};function S(w,m=!0){return f.fromPrivateKey(w).toRawBytes(m)}function $(w){const m=w instanceof Uint8Array,B=typeof w=="string",k=(m||B)&&w.length;return m?k===o||k===s:B?k===2*o||k===2*s:w instanceof f}function L(w,m,B=!0){if($(w))throw new Error("first arg must be private key");if(!$(m))throw new Error("second arg must be public key");return f.fromHex(m).multiply(u(w)).toRawBytes(B)}const E=e.bits2int||function(w){const m=Z(w),B=w.length*8-e.nBitLength;return B>0?m>>BigInt(B):m},x=e.bits2int_modN||function(w){return c(E(w))},A=Ge(e.nBitLength);function M(w){if(typeof w!="bigint")throw new Error("bigint expected");if(!(it<=w&&w<A))throw new Error(`bigint expected < 2^${e.nBitLength}`);return xt(w,e.nByteLength)}function U(w,m,B=_){if(["recovered","canonical"].some(Bt=>Bt in B))throw new Error("sign() legacy options not supported");const{hash:k,randomBytes:I}=e;let{lowS:T,prehash:H,extraEntropy:N}=B;T==null&&(T=!0),w=z("msgHash",w),H&&(w=z("prehashed msgHash",k(w)));const X=x(w),ht=u(m),kt=[M(ht),M(X)];if(N!=null){const Bt=N===!0?I(n.BYTES):N;kt.push(z("extraEntropy",Bt))}const Wt=It(...kt),pt=X;function ve(Bt){const Ut=E(Bt);if(!b(Ut))return;const Sn=a(Ut),$t=f.BASE.multiply(Ut).toAffine(),Q=c($t.x);if(Q===it)return;const Tt=c(Sn*c(pt+Q*ht));if(Tt===it)return;let _n=($t.x===Q?0:2)|Number($t.y&Y),In=Tt;return T&&g(Tt)&&(In=d(Tt),_n^=1),new y(Q,In,_n)}return{seed:Wt,k2sig:ve}}const _={lowS:e.lowS,prehash:!1},R={lowS:e.lowS,prehash:!1};function O(w,m,B=_){const{seed:k,k2sig:I}=U(w,m,B),T=e;return er(T.hash.outputLen,T.nByteLength,T.hmac)(k,I)}f.BASE._setWindowSize(8);function q(w,m,B,k=R){var $t;const I=w;if(m=z("msgHash",m),B=z("publicKey",B),"strict"in k)throw new Error("options.strict was renamed to lowS");const{lowS:T,prehash:H}=k;let N,X;try{if(typeof I=="string"||I instanceof Uint8Array)try{N=y.fromDER(I)}catch(Q){if(!(Q instanceof _t.Err))throw Q;N=y.fromCompact(I)}else if(typeof I=="object"&&typeof I.r=="bigint"&&typeof I.s=="bigint"){const{r:Q,s:Tt}=I;N=new y(Q,Tt)}else throw new Error("PARSE");X=f.fromHex(B)}catch(Q){if(Q.message==="PARSE")throw new Error("signature must be Signature instance, Uint8Array or hex string");return!1}if(T&&N.hasHighS())return!1;H&&(m=e.hash(m));const{r:ht,s:kt}=N,Wt=x(m),pt=a(kt),ve=c(Wt*pt),Bt=c(ht*pt),Ut=($t=f.BASE.multiplyAndAddUnsafe(X,ve,Bt))==null?void 0:$t.toAffine();return Ut?c(Ut.x)===ht:!1}return{CURVE:e,getPublicKey:S,getSharedSecret:L,sign:O,verify:q,ProjectivePoint:f,Signature:y,utils:v}}let ir=class extends Yn{constructor(e,n){super(),this.finished=!1,this.destroyed=!1,Uo(e);const r=Ke(n);if(this.iHash=e.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const o=this.blockLen,s=new Uint8Array(o);s.set(r.length>o?e.create().update(r).digest():r);for(let i=0;i<s.length;i++)s[i]^=54;this.iHash.update(s),this.oHash=e.create();for(let i=0;i<s.length;i++)s[i]^=106;this.oHash.update(s),s.fill(0)}update(e){return Qt(this),this.iHash.update(e),this}digestInto(e){Qt(this),Gn(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){const e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));const{oHash:n,iHash:r,finished:o,destroyed:s,blockLen:i,outputLen:c}=this;return e=e,e.finished=o,e.destroyed=s,e.blockLen=i,e.outputLen=c,e.oHash=n._cloneInto(e.oHash),e.iHash=r._cloneInto(e.iHash),e}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}};const ar=(t,e,n)=>new ir(t,e).update(n).digest();ar.create=(t,e)=>new ir(t,e);/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */function ys(t){return{hash:t,hmac:(e,...n)=>ar(t,e,No(...n)),randomBytes:Xn}}function ws(t,e){const n=r=>gs({...t,...ys(r)});return Object.freeze({...n(e),create:n})}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const le=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),te=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),cr=BigInt(1),ee=BigInt(2),Cn=(t,e)=>(t+e/ee)/e;function lr(t){const e=le,n=BigInt(3),r=BigInt(6),o=BigInt(11),s=BigInt(22),i=BigInt(23),c=BigInt(44),a=BigInt(88),f=t*t*t%e,u=f*f*t%e,l=J(u,n,e)*u%e,b=J(l,n,e)*u%e,h=J(b,ee,e)*f%e,g=J(h,o,e)*h%e,d=J(g,s,e)*g%e,p=J(d,c,e)*d%e,y=J(p,a,e)*p%e,v=J(y,c,e)*d%e,S=J(v,n,e)*u%e,$=J(S,i,e)*g%e,L=J($,r,e)*f%e,E=J(L,ee,e);if(!Oe.eql(Oe.sqr(E),t))throw new Error("Cannot find square root");return E}const Oe=is(le,void 0,void 0,{sqrt:lr}),qt=ws({a:BigInt(0),b:BigInt(7),Fp:Oe,n:te,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:t=>{const e=te,n=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),r=-cr*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),o=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),s=n,i=BigInt("0x100000000000000000000000000000000"),c=Cn(s*t,e),a=Cn(-r*t,e);let f=W(t-c*n-a*o,e),u=W(-c*r-a*s,e);const l=f>i,b=u>i;if(l&&(f=e-f),b&&(u=e-u),f>i||u>i)throw new Error("splitScalar: Endomorphism failed, k="+t);return{k1neg:l,k1:f,k2neg:b,k2:u}}}},Ce),fe=BigInt(0),fr=t=>typeof t=="bigint"&&fe<t&&t<le,bs=t=>typeof t=="bigint"&&fe<t&&t<te,Nn={};function ne(t,...e){let n=Nn[t];if(n===void 0){const r=Ce(Uint8Array.from(t,o=>o.charCodeAt(0)));n=It(r,r),Nn[t]=n}return Ce(It(n,...e))}const Je=t=>t.toRawBytes(!0).slice(1),He=t=>xt(t,32),_e=t=>W(t,le),Ft=t=>W(t,te),Ye=qt.ProjectivePoint,ms=(t,e,n)=>Ye.BASE.multiplyAndAddUnsafe(t,e,n);function Me(t){let e=qt.utils.normPrivateKeyToScalar(t),n=Ye.fromPrivateKey(e);return{scalar:n.hasEvenY()?e:Ft(-e),bytes:Je(n)}}function ur(t){if(!fr(t))throw new Error("bad x: need 0 < x < p");const e=_e(t*t),n=_e(e*t+BigInt(7));let r=lr(n);r%ee!==fe&&(r=_e(-r));const o=new Ye(t,r,cr);return o.assertValidity(),o}function dr(...t){return Ft(Z(ne("BIP0340/challenge",...t)))}function Es(t){return Me(t).bytes}function vs(t,e,n=Xn(32)){const r=z("message",t),{bytes:o,scalar:s}=Me(e),i=z("auxRand",n,32),c=He(s^Z(ne("BIP0340/aux",i))),a=ne("BIP0340/nonce",c,o,r),f=Ft(Z(a));if(f===fe)throw new Error("sign failed: k is zero");const{bytes:u,scalar:l}=Me(f),b=dr(u,o,r),h=new Uint8Array(64);if(h.set(u,0),h.set(He(Ft(l+b*s)),32),!hr(h,r,o))throw new Error("sign: Invalid signature produced");return h}function hr(t,e,n){const r=z("signature",t,64),o=z("message",e),s=z("publicKey",n,32);try{const i=ur(Z(s)),c=Z(r.subarray(0,32));if(!fr(c))return!1;const a=Z(r.subarray(32,64));if(!bs(a))return!1;const f=dr(He(c),Je(i),o),u=ms(i,a,Ft(-f));return!(!u||!u.hasEvenY()||u.toAffine().x!==c)}catch{return!1}}const zt={getPublicKey:Es,sign:vs,verify:hr,utils:{randomPrivateKey:qt.utils.randomPrivateKey,lift_x:ur,pointToBytes:Je,numberToBytesBE:xt,bytesToNumberBE:Z,taggedHash:ne,mod:W}},Ie=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Xe=t=>t instanceof Uint8Array,Le=t=>new DataView(t.buffer,t.byteOffset,t.byteLength),rt=(t,e)=>t<<32-e|t>>>e,xs=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;if(!xs)throw new Error("Non little-endian hardware is not supported");const As=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function K(t){if(!Xe(t))throw new Error("Uint8Array expected");let e="";for(let n=0;n<t.length;n++)e+=As[t[n]];return e}function Lt(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);const e=t.length;if(e%2)throw new Error("padded hex string expected, got unpadded hex of length "+e);const n=new Uint8Array(e/2);for(let r=0;r<n.length;r++){const o=r*2,s=t.slice(o,o+2),i=Number.parseInt(s,16);if(Number.isNaN(i)||i<0)throw new Error("Invalid byte sequence");n[r]=i}return n}function Bs(t){if(typeof t!="string")throw new Error(`utf8ToBytes expected string, got ${typeof t}`);return new Uint8Array(new TextEncoder().encode(t))}function Zt(t){if(typeof t=="string"&&(t=Bs(t)),!Xe(t))throw new Error(`expected Uint8Array, got ${typeof t}`);return t}function ue(...t){const e=new Uint8Array(t.reduce((r,o)=>r+o.length,0));let n=0;return t.forEach(r=>{if(!Xe(r))throw new Error("Uint8Array expected");e.set(r,n),n+=r.length}),e}class pr{clone(){return this._cloneInto()}}function gr(t){const e=r=>t().update(Zt(r)).digest(),n=t();return e.outputLen=n.outputLen,e.blockLen=n.blockLen,e.create=()=>t(),e}function yr(t=32){if(Ie&&typeof Ie.getRandomValues=="function")return Ie.getRandomValues(new Uint8Array(t));throw new Error("crypto.getRandomValues must be defined")}function Pe(t){if(!Number.isSafeInteger(t)||t<0)throw new Error(`Wrong positive integer: ${t}`)}function Ss(t){if(typeof t!="boolean")throw new Error(`Expected boolean, not ${t}`)}function wr(t,...e){if(!(t instanceof Uint8Array))throw new Error("Expected Uint8Array");if(e.length>0&&!e.includes(t.length))throw new Error(`Expected Uint8Array of length ${e}, not of length=${t.length}`)}function _s(t){if(typeof t!="function"||typeof t.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");Pe(t.outputLen),Pe(t.blockLen)}function Is(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function Ls(t,e){wr(t);const n=e.outputLen;if(t.length<n)throw new Error(`digestInto() expects output buffer of length at least ${n}`)}const ot={number:Pe,bool:Ss,bytes:wr,hash:_s,exists:Is,output:Ls};function ks(t,e,n,r){if(typeof t.setBigUint64=="function")return t.setBigUint64(e,n,r);const o=BigInt(32),s=BigInt(4294967295),i=Number(n>>o&s),c=Number(n&s),a=r?4:0,f=r?0:4;t.setUint32(e+a,i,r),t.setUint32(e+f,c,r)}class Us extends pr{constructor(e,n,r,o){super(),this.blockLen=e,this.outputLen=n,this.padOffset=r,this.isLE=o,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=Le(this.buffer)}update(e){ot.exists(this);const{view:n,buffer:r,blockLen:o}=this;e=Zt(e);const s=e.length;for(let i=0;i<s;){const c=Math.min(o-this.pos,s-i);if(c===o){const a=Le(e);for(;o<=s-i;i+=o)this.process(a,i);continue}r.set(e.subarray(i,i+c),this.pos),this.pos+=c,i+=c,this.pos===o&&(this.process(n,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){ot.exists(this),ot.output(e,this),this.finished=!0;const{buffer:n,view:r,blockLen:o,isLE:s}=this;let{pos:i}=this;n[i++]=128,this.buffer.subarray(i).fill(0),this.padOffset>o-i&&(this.process(r,0),i=0);for(let l=i;l<o;l++)n[l]=0;ks(r,o-8,BigInt(this.length*8),s),this.process(r,0);const c=Le(e),a=this.outputLen;if(a%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const f=a/4,u=this.get();if(f>u.length)throw new Error("_sha2: outputLen bigger than state");for(let l=0;l<f;l++)c.setUint32(4*l,u[l],s)}digest(){const{buffer:e,outputLen:n}=this;this.digestInto(e);const r=e.slice(0,n);return this.destroy(),r}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:n,buffer:r,length:o,finished:s,destroyed:i,pos:c}=this;return e.length=o,e.pos=c,e.finished=s,e.destroyed=i,o%n&&e.buffer.set(r),e}}const $s=(t,e,n)=>t&e^~t&n,Ts=(t,e,n)=>t&e^t&n^e&n,Cs=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),bt=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),mt=new Uint32Array(64);let br=class extends Us{constructor(){super(64,32,8,!1),this.A=bt[0]|0,this.B=bt[1]|0,this.C=bt[2]|0,this.D=bt[3]|0,this.E=bt[4]|0,this.F=bt[5]|0,this.G=bt[6]|0,this.H=bt[7]|0}get(){const{A:e,B:n,C:r,D:o,E:s,F:i,G:c,H:a}=this;return[e,n,r,o,s,i,c,a]}set(e,n,r,o,s,i,c,a){this.A=e|0,this.B=n|0,this.C=r|0,this.D=o|0,this.E=s|0,this.F=i|0,this.G=c|0,this.H=a|0}process(e,n){for(let l=0;l<16;l++,n+=4)mt[l]=e.getUint32(n,!1);for(let l=16;l<64;l++){const b=mt[l-15],h=mt[l-2],g=rt(b,7)^rt(b,18)^b>>>3,d=rt(h,17)^rt(h,19)^h>>>10;mt[l]=d+mt[l-7]+g+mt[l-16]|0}let{A:r,B:o,C:s,D:i,E:c,F:a,G:f,H:u}=this;for(let l=0;l<64;l++){const b=rt(c,6)^rt(c,11)^rt(c,25),h=u+b+$s(c,a,f)+Cs[l]+mt[l]|0,d=(rt(r,2)^rt(r,13)^rt(r,22))+Ts(r,o,s)|0;u=f,f=a,a=c,c=i+h|0,i=s,s=o,o=r,r=h+d|0}r=r+this.A|0,o=o+this.B|0,s=s+this.C|0,i=i+this.D|0,c=c+this.E|0,a=a+this.F|0,f=f+this.G|0,u=u+this.H|0,this.set(r,o,s,i,c,a,f,u)}roundClean(){mt.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}};class Ns extends br{constructor(){super(),this.A=-1056596264,this.B=914150663,this.C=812702999,this.D=-150054599,this.E=-4191439,this.F=1750603025,this.G=1694076839,this.H=-1090891868,this.outputLen=28}}const jt=gr(()=>new br);gr(()=>new Ns);/*! scure-base - MIT License (c) 2022 Paul Miller (paulmillr.com) */function Dt(t){if(!Number.isSafeInteger(t))throw new Error(`Wrong integer: ${t}`)}function ft(...t){const e=(o,s)=>i=>o(s(i)),n=Array.from(t).reverse().reduce((o,s)=>o?e(o,s.encode):s.encode,void 0),r=t.reduce((o,s)=>o?e(o,s.decode):s.decode,void 0);return{encode:n,decode:r}}function ut(t){return{encode:e=>{if(!Array.isArray(e)||e.length&&typeof e[0]!="number")throw new Error("alphabet.encode input should be an array of numbers");return e.map(n=>{if(Dt(n),n<0||n>=t.length)throw new Error(`Digit index outside alphabet: ${n} (alphabet: ${t.length})`);return t[n]})},decode:e=>{if(!Array.isArray(e)||e.length&&typeof e[0]!="string")throw new Error("alphabet.decode input should be array of strings");return e.map(n=>{if(typeof n!="string")throw new Error(`alphabet.decode: not string element=${n}`);const r=t.indexOf(n);if(r===-1)throw new Error(`Unknown letter: "${n}". Allowed: ${t}`);return r})}}}function dt(t=""){if(typeof t!="string")throw new Error("join separator should be string");return{encode:e=>{if(!Array.isArray(e)||e.length&&typeof e[0]!="string")throw new Error("join.encode input should be array of strings");for(let n of e)if(typeof n!="string")throw new Error(`join.encode: non-string input=${n}`);return e.join(t)},decode:e=>{if(typeof e!="string")throw new Error("join.decode input should be string");return e.split(t)}}}function de(t,e="="){if(Dt(t),typeof e!="string")throw new Error("padding chr should be string");return{encode(n){if(!Array.isArray(n)||n.length&&typeof n[0]!="string")throw new Error("padding.encode input should be array of strings");for(let r of n)if(typeof r!="string")throw new Error(`padding.encode: non-string input=${r}`);for(;n.length*t%8;)n.push(e);return n},decode(n){if(!Array.isArray(n)||n.length&&typeof n[0]!="string")throw new Error("padding.encode input should be array of strings");for(let o of n)if(typeof o!="string")throw new Error(`padding.decode: non-string input=${o}`);let r=n.length;if(r*t%8)throw new Error("Invalid padding: string should have whole number of bytes");for(;r>0&&n[r-1]===e;r--)if(!((r-1)*t%8))throw new Error("Invalid padding: string has too much padding");return n.slice(0,r)}}}function mr(t){if(typeof t!="function")throw new Error("normalize fn should be function");return{encode:e=>e,decode:e=>t(e)}}function Rn(t,e,n){if(e<2)throw new Error(`convertRadix: wrong from=${e}, base cannot be less than 2`);if(n<2)throw new Error(`convertRadix: wrong to=${n}, base cannot be less than 2`);if(!Array.isArray(t))throw new Error("convertRadix: data should be array");if(!t.length)return[];let r=0;const o=[],s=Array.from(t);for(s.forEach(i=>{if(Dt(i),i<0||i>=e)throw new Error(`Wrong integer: ${i}`)});;){let i=0,c=!0;for(let a=r;a<s.length;a++){const f=s[a],u=e*i+f;if(!Number.isSafeInteger(u)||e*i/e!==i||u-f!==e*i)throw new Error("convertRadix: carry overflow");if(i=u%n,s[a]=Math.floor(u/n),!Number.isSafeInteger(s[a])||s[a]*n+i!==u)throw new Error("convertRadix: carry overflow");if(c)s[a]?c=!1:r=a;else continue}if(o.push(i),c)break}for(let i=0;i<t.length-1&&t[i]===0;i++)o.push(0);return o.reverse()}const Er=(t,e)=>e?Er(e,t%e):t,re=(t,e)=>t+(e-Er(t,e));function qe(t,e,n,r){if(!Array.isArray(t))throw new Error("convertRadix2: data should be array");if(e<=0||e>32)throw new Error(`convertRadix2: wrong from=${e}`);if(n<=0||n>32)throw new Error(`convertRadix2: wrong to=${n}`);if(re(e,n)>32)throw new Error(`convertRadix2: carry overflow from=${e} to=${n} carryBits=${re(e,n)}`);let o=0,s=0;const i=2**n-1,c=[];for(const a of t){if(Dt(a),a>=2**e)throw new Error(`convertRadix2: invalid data word=${a} from=${e}`);if(o=o<<e|a,s+e>32)throw new Error(`convertRadix2: carry overflow pos=${s} from=${e}`);for(s+=e;s>=n;s-=n)c.push((o>>s-n&i)>>>0);o&=2**s-1}if(o=o<<n-s&i,!r&&s>=e)throw new Error("Excess padding");if(!r&&o)throw new Error(`Non-zero padding: ${o}`);return r&&s>0&&c.push(o>>>0),c}function Rs(t){return Dt(t),{encode:e=>{if(!(e instanceof Uint8Array))throw new Error("radix.encode input should be Uint8Array");return Rn(Array.from(e),2**8,t)},decode:e=>{if(!Array.isArray(e)||e.length&&typeof e[0]!="number")throw new Error("radix.decode input should be array of strings");return Uint8Array.from(Rn(e,t,2**8))}}}function At(t,e=!1){if(Dt(t),t<=0||t>32)throw new Error("radix2: bits should be in (0..32]");if(re(8,t)>32||re(t,8)>32)throw new Error("radix2: carry overflow");return{encode:n=>{if(!(n instanceof Uint8Array))throw new Error("radix2.encode input should be Uint8Array");return qe(Array.from(n),8,t,!e)},decode:n=>{if(!Array.isArray(n)||n.length&&typeof n[0]!="number")throw new Error("radix2.decode input should be array of strings");return Uint8Array.from(qe(n,t,8,e))}}}function On(t){if(typeof t!="function")throw new Error("unsafeWrapper fn should be function");return function(...e){try{return t.apply(null,e)}catch{}}}const Os=ft(At(4),ut("0123456789ABCDEF"),dt("")),Hs=ft(At(5),ut("ABCDEFGHIJKLMNOPQRSTUVWXYZ234567"),de(5),dt(""));ft(At(5),ut("0123456789ABCDEFGHIJKLMNOPQRSTUV"),de(5),dt(""));ft(At(5),ut("0123456789ABCDEFGHJKMNPQRSTVWXYZ"),dt(""),mr(t=>t.toUpperCase().replace(/O/g,"0").replace(/[IL]/g,"1")));const lt=ft(At(6),ut("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"),de(6),dt("")),Ms=ft(At(6),ut("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"),de(6),dt("")),Qe=t=>ft(Rs(58),ut(t),dt("")),je=Qe("123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz");Qe("123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ");Qe("rpshnaf39wBUDNEGHJKLM4PQRST7VWXYZ2bcdeCg65jkm8oFqi1tuvAxyz");const Hn=[0,2,3,5,6,7,9,10,11],Ps={encode(t){let e="";for(let n=0;n<t.length;n+=8){const r=t.subarray(n,n+8);e+=je.encode(r).padStart(Hn[r.length],"1")}return e},decode(t){let e=[];for(let n=0;n<t.length;n+=11){const r=t.slice(n,n+11),o=Hn.indexOf(r.length),s=je.decode(r);for(let i=0;i<s.length-o;i++)if(s[i]!==0)throw new Error("base58xmr: wrong padding");e=e.concat(Array.from(s.slice(s.length-o)))}return Uint8Array.from(e)}},De=ft(ut("qpzry9x8gf2tvdw0s3jn54khce6mua7l"),dt("")),Mn=[996825010,642813549,513874426,1027748829,705979059];function Kt(t){const e=t>>25;let n=(t&33554431)<<5;for(let r=0;r<Mn.length;r++)(e>>r&1)===1&&(n^=Mn[r]);return n}function Pn(t,e,n=1){const r=t.length;let o=1;for(let s=0;s<r;s++){const i=t.charCodeAt(s);if(i<33||i>126)throw new Error(`Invalid prefix (${t})`);o=Kt(o)^i>>5}o=Kt(o);for(let s=0;s<r;s++)o=Kt(o)^t.charCodeAt(s)&31;for(let s of e)o=Kt(o)^s;for(let s=0;s<6;s++)o=Kt(o);return o^=n,De.encode(qe([o%2**30],30,5,!1))}function vr(t){const e=t==="bech32"?1:734539939,n=At(5),r=n.decode,o=n.encode,s=On(r);function i(u,l,b=90){if(typeof u!="string")throw new Error(`bech32.encode prefix should be string, not ${typeof u}`);if(!Array.isArray(l)||l.length&&typeof l[0]!="number")throw new Error(`bech32.encode words should be array of numbers, not ${typeof l}`);const h=u.length+7+l.length;if(b!==!1&&h>b)throw new TypeError(`Length ${h} exceeds limit ${b}`);return u=u.toLowerCase(),`${u}1${De.encode(l)}${Pn(u,l,e)}`}function c(u,l=90){if(typeof u!="string")throw new Error(`bech32.decode input should be string, not ${typeof u}`);if(u.length<8||l!==!1&&u.length>l)throw new TypeError(`Wrong string length: ${u.length} (${u}). Expected (8..${l})`);const b=u.toLowerCase();if(u!==b&&u!==u.toUpperCase())throw new Error("String must be lowercase or uppercase");u=b;const h=u.lastIndexOf("1");if(h===0||h===-1)throw new Error('Letter "1" must be present between prefix and data only');const g=u.slice(0,h),d=u.slice(h+1);if(d.length<6)throw new Error("Data must be at least 6 characters long");const p=De.decode(d).slice(0,-6),y=Pn(g,p,e);if(!d.endsWith(y))throw new Error(`Invalid checksum in ${u}: expected "${y}"`);return{prefix:g,words:p}}const a=On(c);function f(u){const{prefix:l,words:b}=c(u,!1);return{prefix:l,words:b,bytes:r(b)}}return{encode:i,decode:c,decodeToBytes:f,decodeUnsafe:a,fromWords:r,fromWordsUnsafe:s,toWords:o}}const Pt=vr("bech32");vr("bech32m");const qs={encode:t=>new TextDecoder().decode(t),decode:t=>new TextEncoder().encode(t)},js=ft(At(4),ut("0123456789abcdef"),dt(""),mr(t=>{if(typeof t!="string"||t.length%2)throw new TypeError(`hex.decode: expected string, got ${typeof t} with length ${t.length}`);return t.toLowerCase()})),Ds={utf8:qs,hex:js,base16:Os,base32:Hs,base64:lt,base64url:Ms,base58:je,base58xmr:Ps};`${Object.keys(Ds).join(", ")}`;function ke(t){if(!Number.isSafeInteger(t)||t<0)throw new Error(`positive integer expected, not ${t}`)}function qn(t){if(typeof t!="boolean")throw new Error(`boolean expected, not ${t}`)}function Ws(t){return t instanceof Uint8Array||t!=null&&typeof t=="object"&&t.constructor.name==="Uint8Array"}function at(t,...e){if(!Ws(t))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(t.length))throw new Error(`Uint8Array expected of length ${e}, not of length=${t.length}`)}/*! noble-ciphers - MIT License (c) 2023 Paul Miller (paulmillr.com) */const V=t=>new Uint32Array(t.buffer,t.byteOffset,Math.floor(t.byteLength/4)),zs=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;if(!zs)throw new Error("Non little-endian hardware is not supported");function Ks(t,e){if(e==null||typeof e!="object")throw new Error("options must be defined");return Object.assign(t,e)}function Vs(t,e){if(t.length!==e.length)return!1;let n=0;for(let r=0;r<t.length;r++)n|=t[r]^e[r];return n===0}const Fs=(t,e)=>(Object.assign(e,t),e),vt=16,Zs=283;function tn(t){return t<<1^Zs&-(t>>7)}function Ot(t,e){let n=0;for(;e>0;e>>=1)n^=t&-(e&1),t=tn(t);return n}const We=(()=>{let t=new Uint8Array(256);for(let n=0,r=1;n<256;n++,r^=tn(r))t[n]=r;const e=new Uint8Array(256);e[0]=99;for(let n=0;n<255;n++){let r=t[255-n];r|=r<<8,e[t[n]]=(r^r>>4^r>>5^r>>6^r>>7^99)&255}return e})(),Gs=We.map((t,e)=>We.indexOf(e)),Js=t=>t<<24|t>>>8,Ue=t=>t<<8|t>>>24;function xr(t,e){if(t.length!==256)throw new Error("Wrong sbox length");const n=new Uint32Array(256).map((f,u)=>e(t[u])),r=n.map(Ue),o=r.map(Ue),s=o.map(Ue),i=new Uint32Array(256*256),c=new Uint32Array(256*256),a=new Uint16Array(256*256);for(let f=0;f<256;f++)for(let u=0;u<256;u++){const l=f*256+u;i[l]=n[f]^r[u],c[l]=o[f]^s[u],a[l]=t[f]<<8|t[u]}return{sbox:t,sbox2:a,T0:n,T1:r,T2:o,T3:s,T01:i,T23:c}}const en=xr(We,t=>Ot(t,3)<<24|t<<16|t<<8|Ot(t,2)),Ar=xr(Gs,t=>Ot(t,11)<<24|Ot(t,13)<<16|Ot(t,9)<<8|Ot(t,14)),Ys=(()=>{const t=new Uint8Array(16);for(let e=0,n=1;e<16;e++,n=tn(n))t[e]=n;return t})();function Br(t){at(t);const e=t.length;if(![16,24,32].includes(e))throw new Error(`aes: wrong key size: should be 16, 24 or 32, got: ${e}`);const{sbox2:n}=en,r=V(t),o=r.length,s=c=>st(n,c,c,c,c),i=new Uint32Array(e+28);i.set(r);for(let c=o;c<i.length;c++){let a=i[c-1];c%o===0?a=s(Js(a))^Ys[c/o-1]:o>6&&c%o===4&&(a=s(a)),i[c]=i[c-o]^a}return i}function Xs(t){const e=Br(t),n=e.slice(),r=e.length,{sbox2:o}=en,{T0:s,T1:i,T2:c,T3:a}=Ar;for(let f=0;f<r;f+=4)for(let u=0;u<4;u++)n[f+u]=e[r-f-4+u];e.fill(0);for(let f=4;f<r-4;f++){const u=n[f],l=st(o,u,u,u,u);n[f]=s[l&255]^i[l>>>8&255]^c[l>>>16&255]^a[l>>>24]}return n}function Et(t,e,n,r,o,s){return t[n<<8&65280|r>>>8&255]^e[o>>>8&65280|s>>>24&255]}function st(t,e,n,r,o){return t[e&255|n&65280]|t[r>>>16&255|o>>>16&65280]<<16}function jn(t,e,n,r,o){const{sbox2:s,T01:i,T23:c}=en;let a=0;e^=t[a++],n^=t[a++],r^=t[a++],o^=t[a++];const f=t.length/4-2;for(let g=0;g<f;g++){const d=t[a++]^Et(i,c,e,n,r,o),p=t[a++]^Et(i,c,n,r,o,e),y=t[a++]^Et(i,c,r,o,e,n),v=t[a++]^Et(i,c,o,e,n,r);e=d,n=p,r=y,o=v}const u=t[a++]^st(s,e,n,r,o),l=t[a++]^st(s,n,r,o,e),b=t[a++]^st(s,r,o,e,n),h=t[a++]^st(s,o,e,n,r);return{s0:u,s1:l,s2:b,s3:h}}function Qs(t,e,n,r,o){const{sbox2:s,T01:i,T23:c}=Ar;let a=0;e^=t[a++],n^=t[a++],r^=t[a++],o^=t[a++];const f=t.length/4-2;for(let g=0;g<f;g++){const d=t[a++]^Et(i,c,e,o,r,n),p=t[a++]^Et(i,c,n,e,o,r),y=t[a++]^Et(i,c,r,n,e,o),v=t[a++]^Et(i,c,o,r,n,e);e=d,n=p,r=y,o=v}const u=t[a++]^st(s,e,o,r,n),l=t[a++]^st(s,n,e,o,r),b=t[a++]^st(s,r,n,e,o),h=t[a++]^st(s,o,r,n,e);return{s0:u,s1:l,s2:b,s3:h}}function Sr(t,e){if(!e)return new Uint8Array(t);if(at(e),e.length<t)throw new Error(`aes: wrong destination length, expected at least ${t}, got: ${e.length}`);return e}function ti(t){if(at(t),t.length%vt!==0)throw new Error(`aes/(cbc-ecb).decrypt ciphertext should consist of blocks with size ${vt}`)}function ei(t,e,n){let r=t.length;const o=r%vt;if(!e&&o!==0)throw new Error("aec/(cbc-ecb): unpadded plaintext with disabled padding");const s=V(t);if(e){let a=vt-o;a||(a=vt),r=r+a}const i=Sr(r,n),c=V(i);return{b:s,o:c,out:i}}function ni(t,e){if(!e)return t;const n=t.length;if(!n)throw new Error("aes/pcks5: empty ciphertext not allowed");const r=t[n-1];if(r<=0||r>16)throw new Error(`aes/pcks5: wrong padding byte: ${r}`);const o=t.subarray(0,-r);for(let s=0;s<r;s++)if(t[n-s-1]!==r)throw new Error("aes/pcks5: wrong padding");return o}function ri(t){const e=new Uint8Array(16),n=V(e);e.set(t);const r=vt-t.length;for(let o=vt-r;o<vt;o++)e[o]=r;return n}const _r=Fs({blockSize:16,nonceLength:16},function(e,n,r={}){at(e),at(n,16);const o=!r.disablePadding;return{encrypt:(s,i)=>{const c=Br(e),{b:a,o:f,out:u}=ei(s,o,i),l=V(n);let b=l[0],h=l[1],g=l[2],d=l[3],p=0;for(;p+4<=a.length;)b^=a[p+0],h^=a[p+1],g^=a[p+2],d^=a[p+3],{s0:b,s1:h,s2:g,s3:d}=jn(c,b,h,g,d),f[p++]=b,f[p++]=h,f[p++]=g,f[p++]=d;if(o){const y=ri(s.subarray(p*4));b^=y[0],h^=y[1],g^=y[2],d^=y[3],{s0:b,s1:h,s2:g,s3:d}=jn(c,b,h,g,d),f[p++]=b,f[p++]=h,f[p++]=g,f[p++]=d}return c.fill(0),u},decrypt:(s,i)=>{ti(s);const c=Xs(e),a=V(n),f=Sr(s.length,i),u=V(s),l=V(f);let b=a[0],h=a[1],g=a[2],d=a[3];for(let p=0;p+4<=u.length;){const y=b,v=h,S=g,$=d;b=u[p+0],h=u[p+1],g=u[p+2],d=u[p+3];const{s0:L,s1:E,s2:x,s3:A}=Qs(c,b,h,g,d);l[p++]=L^y,l[p++]=E^v,l[p++]=x^S,l[p++]=A^$}return c.fill(0),ni(f,o)}}}),Ir=t=>Uint8Array.from(t.split("").map(e=>e.charCodeAt(0))),oi=Ir("expand 16-byte k"),si=Ir("expand 32-byte k"),ii=V(oi),Lr=V(si);Lr.slice();function C(t,e){return t<<e|t>>>32-e}function ze(t){return t.byteOffset%4===0}const Yt=64,ai=16,kr=2**32-1,Dn=new Uint32Array;function ci(t,e,n,r,o,s,i,c){const a=o.length,f=new Uint8Array(Yt),u=V(f),l=ze(o)&&ze(s),b=l?V(o):Dn,h=l?V(s):Dn;for(let g=0;g<a;i++){if(t(e,n,r,u,i,c),i>=kr)throw new Error("arx: counter overflow");const d=Math.min(Yt,a-g);if(l&&d===Yt){const p=g/4;if(g%4!==0)throw new Error("arx: invalid block position");for(let y=0,v;y<ai;y++)v=p+y,h[v]=b[v]^u[y];g+=Yt;continue}for(let p=0,y;p<d;p++)y=g+p,s[y]=o[y]^f[p];g+=d}}function li(t,e){const{allowShortKeys:n,extendNonceFn:r,counterLength:o,counterRight:s,rounds:i}=Ks({allowShortKeys:!1,counterLength:8,counterRight:!1,rounds:20},e);if(typeof t!="function")throw new Error("core must be a function");return ke(o),ke(i),qn(s),qn(n),(c,a,f,u,l=0)=>{at(c),at(a),at(f);const b=f.length;if(u||(u=new Uint8Array(b)),at(u),ke(l),l<0||l>=kr)throw new Error("arx: counter overflow");if(u.length<b)throw new Error(`arx: output (${u.length}) is shorter than data (${b})`);const h=[];let g=c.length,d,p;if(g===32)d=c.slice(),h.push(d),p=Lr;else if(g===16&&n)d=new Uint8Array(32),d.set(c),d.set(c,16),p=ii,h.push(d);else throw new Error(`arx: invalid 32-byte key, got length=${g}`);ze(a)||(a=a.slice(),h.push(a));const y=V(d);if(r){if(a.length!==24)throw new Error("arx: extended nonce must be 24 bytes");r(p,y,V(a.subarray(0,16)),y),a=a.subarray(16)}const v=16-o;if(v!==a.length)throw new Error(`arx: nonce must be ${v} or 16 bytes`);if(v!==12){const $=new Uint8Array(12);$.set(a,s?0:12-a.length),a=$,h.push(a)}const S=V(a);for(ci(t,p,y,S,f,u,l,i);h.length>0;)h.pop().fill(0);return u}}function fi(t,e,n,r,o,s=20){let i=t[0],c=t[1],a=t[2],f=t[3],u=e[0],l=e[1],b=e[2],h=e[3],g=e[4],d=e[5],p=e[6],y=e[7],v=o,S=n[0],$=n[1],L=n[2],E=i,x=c,A=a,M=f,U=u,_=l,R=b,O=h,q=g,w=d,m=p,B=y,k=v,I=S,T=$,H=L;for(let X=0;X<s;X+=2)E=E+U|0,k=C(k^E,16),q=q+k|0,U=C(U^q,12),E=E+U|0,k=C(k^E,8),q=q+k|0,U=C(U^q,7),x=x+_|0,I=C(I^x,16),w=w+I|0,_=C(_^w,12),x=x+_|0,I=C(I^x,8),w=w+I|0,_=C(_^w,7),A=A+R|0,T=C(T^A,16),m=m+T|0,R=C(R^m,12),A=A+R|0,T=C(T^A,8),m=m+T|0,R=C(R^m,7),M=M+O|0,H=C(H^M,16),B=B+H|0,O=C(O^B,12),M=M+O|0,H=C(H^M,8),B=B+H|0,O=C(O^B,7),E=E+_|0,H=C(H^E,16),m=m+H|0,_=C(_^m,12),E=E+_|0,H=C(H^E,8),m=m+H|0,_=C(_^m,7),x=x+R|0,k=C(k^x,16),B=B+k|0,R=C(R^B,12),x=x+R|0,k=C(k^x,8),B=B+k|0,R=C(R^B,7),A=A+O|0,I=C(I^A,16),q=q+I|0,O=C(O^q,12),A=A+O|0,I=C(I^A,8),q=q+I|0,O=C(O^q,7),M=M+U|0,T=C(T^M,16),w=w+T|0,U=C(U^w,12),M=M+U|0,T=C(T^M,8),w=w+T|0,U=C(U^w,7);let N=0;r[N++]=i+E|0,r[N++]=c+x|0,r[N++]=a+A|0,r[N++]=f+M|0,r[N++]=u+U|0,r[N++]=l+_|0,r[N++]=b+R|0,r[N++]=h+O|0,r[N++]=g+q|0,r[N++]=d+w|0,r[N++]=p+m|0,r[N++]=y+B|0,r[N++]=v+k|0,r[N++]=S+I|0,r[N++]=$+T|0,r[N++]=L+H|0}const Ur=li(fi,{counterRight:!1,counterLength:4,allowShortKeys:!1});class $r extends pr{constructor(e,n){super(),this.finished=!1,this.destroyed=!1,ot.hash(e);const r=Zt(n);if(this.iHash=e.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const o=this.blockLen,s=new Uint8Array(o);s.set(r.length>o?e.create().update(r).digest():r);for(let i=0;i<s.length;i++)s[i]^=54;this.iHash.update(s),this.oHash=e.create();for(let i=0;i<s.length;i++)s[i]^=106;this.oHash.update(s),s.fill(0)}update(e){return ot.exists(this),this.iHash.update(e),this}digestInto(e){ot.exists(this),ot.bytes(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){const e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));const{oHash:n,iHash:r,finished:o,destroyed:s,blockLen:i,outputLen:c}=this;return e=e,e.finished=o,e.destroyed=s,e.blockLen=i,e.outputLen=c,e.oHash=n._cloneInto(e.oHash),e.iHash=r._cloneInto(e.iHash),e}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}const he=(t,e,n)=>new $r(t,e).update(n).digest();he.create=(t,e)=>new $r(t,e);function ui(t,e,n){return ot.hash(t),he(t,Zt(n),Zt(e))}const $e=new Uint8Array([0]),Wn=new Uint8Array;function di(t,e,n,r=32){if(ot.hash(t),ot.number(r),r>255*t.outputLen)throw new Error("Length should be <= 255*HashLen");const o=Math.ceil(r/t.outputLen);n===void 0&&(n=Wn);const s=new Uint8Array(o*t.outputLen),i=he.create(t,e),c=i._cloneInto(),a=new Uint8Array(i.outputLen);for(let f=0;f<o;f++)$e[0]=f+1,c.update(f===0?Wn:a).update(n).update($e).digestInto(a),s.set(a,t.outputLen*f),i._cloneInto(c);return i.destroy(),c.destroy(),a.fill(0),$e.fill(0),s.slice(0,r)}var hi=Object.defineProperty,P=(t,e)=>{for(var n in e)hi(t,n,{get:e[n],enumerable:!0})},Ct=Symbol("verified"),pi=t=>t instanceof Object;function nn(t){if(!pi(t)||typeof t.kind!="number"||typeof t.content!="string"||typeof t.created_at!="number"||typeof t.pubkey!="string"||!t.pubkey.match(/^[a-f0-9]{64}$/)||!Array.isArray(t.tags))return!1;for(let e=0;e<t.tags.length;e++){let n=t.tags[e];if(!Array.isArray(n))return!1;for(let r=0;r<n.length;r++)if(typeof n[r]!="string")return!1}return!0}var gi={};P(gi,{Queue:()=>mi,QueueNode:()=>Tr,binarySearch:()=>rn,bytesToHex:()=>K,hexToBytes:()=>Lt,insertEventIntoAscendingList:()=>bi,insertEventIntoDescendingList:()=>wi,normalizeURL:()=>yi,utf8Decoder:()=>ct,utf8Encoder:()=>tt});var ct=new TextDecoder("utf-8"),tt=new TextEncoder;function yi(t){try{t.indexOf("://")===-1&&(t="wss://"+t);let e=new URL(t);return e.pathname=e.pathname.replace(/\/+/g,"/"),e.pathname.endsWith("/")&&(e.pathname=e.pathname.slice(0,-1)),(e.port==="80"&&e.protocol==="ws:"||e.port==="443"&&e.protocol==="wss:")&&(e.port=""),e.searchParams.sort(),e.hash="",e.toString()}catch{throw new Error(`Invalid URL: ${t}`)}}function wi(t,e){const[n,r]=rn(t,o=>e.id===o.id?0:e.created_at===o.created_at?-1:o.created_at-e.created_at);return r||t.splice(n,0,e),t}function bi(t,e){const[n,r]=rn(t,o=>e.id===o.id?0:e.created_at===o.created_at?-1:e.created_at-o.created_at);return r||t.splice(n,0,e),t}function rn(t,e){let n=0,r=t.length-1;for(;n<=r;){const o=Math.floor((n+r)/2),s=e(t[o]);if(s===0)return[o,!0];s<0?r=o-1:n=o+1}return[n,!1]}var Tr=class{constructor(t){gt(this,"value");gt(this,"next",null);gt(this,"prev",null);this.value=t}},mi=class{constructor(){gt(this,"first");gt(this,"last");this.first=null,this.last=null}enqueue(t){const e=new Tr(t);return this.last?this.last===this.first?(this.last=e,this.last.prev=this.first,this.first.next=e):(e.prev=this.last,this.last.next=e,this.last=e):(this.first=e,this.last=e),!0}dequeue(){if(!this.first)return null;if(this.first===this.last){const e=this.first;return this.first=null,this.last=null,e.value}const t=this.first;return this.first=t.next,this.first&&(this.first.prev=null),t.value}},Ei=class{generateSecretKey(){return zt.utils.randomPrivateKey()}getPublicKey(t){return K(zt.getPublicKey(t))}finalizeEvent(t,e){const n=t;return n.pubkey=K(zt.getPublicKey(e)),n.id=Xt(n),n.sig=K(zt.sign(Xt(n),e)),n[Ct]=!0,n}verifyEvent(t){if(typeof t[Ct]=="boolean")return t[Ct];const e=Xt(t);if(e!==t.id)return t[Ct]=!1,!1;try{const n=zt.verify(t.sig,e,t.pubkey);return t[Ct]=n,n}catch{return t[Ct]=!1,!1}}};function vi(t){if(!nn(t))throw new Error("can't serialize event with wrong or missing properties");return JSON.stringify([0,t.pubkey,t.created_at,t.kind,t.tags,t.content])}function Xt(t){let e=jt(tt.encode(vi(t)));return K(e)}var pe=new Ei,Cr=pe.generateSecretKey,ge=pe.getPublicKey,et=pe.finalizeEvent,ye=pe.verifyEvent,xi={};P(xi,{Application:()=>va,BadgeAward:()=>Ui,BadgeDefinition:()=>pa,BlockedRelaysList:()=>Xi,BookmarkList:()=>Gi,Bookmarksets:()=>ua,Calendar:()=>La,CalendarEventRSVP:()=>ka,ChannelCreation:()=>Pr,ChannelHideMessage:()=>Dr,ChannelMessage:()=>jr,ChannelMetadata:()=>qr,ChannelMuteUser:()=>Wr,ClassifiedListing:()=>Ba,ClientAuth:()=>Kr,CommunitiesList:()=>Ji,CommunityDefinition:()=>Ta,CommunityPostApproval:()=>Mi,Contacts:()=>Ii,CreateOrUpdateProduct:()=>wa,CreateOrUpdateStall:()=>ya,Curationsets:()=>da,Date:()=>_a,DirectMessageRelaysList:()=>na,DraftClassifiedListing:()=>Sa,DraftLong:()=>ma,Emojisets:()=>Ea,EncryptedDirectMessage:()=>Li,EventDeletion:()=>ki,FileMetadata:()=>Ti,FileServerPreference:()=>ra,Followsets:()=>ca,GenericRepost:()=>ln,Genericlists:()=>la,GiftWrap:()=>zr,HTTPAuth:()=>fn,Handlerinformation:()=>$a,Handlerrecommendation:()=>Ua,Highlights:()=>Ki,InterestsList:()=>ta,Interestsets:()=>ga,JobFeedback:()=>ji,JobRequest:()=>Pi,JobResult:()=>qi,Label:()=>Hi,LightningPubRPC:()=>sa,LiveChatMessage:()=>Ci,LiveEvent:()=>xa,LongFormArticle:()=>ba,Metadata:()=>Si,Mutelist:()=>Vi,NWCWalletInfo:()=>oa,NWCWalletRequest:()=>Vr,NWCWalletResponse:()=>ia,NostrConnect:()=>aa,OpenTimestamps:()=>$i,Pinlist:()=>Fi,PrivateDirectMessage:()=>Mr,ProblemTracker:()=>Ni,ProfileBadges:()=>ha,PublicChatsList:()=>Yi,Reaction:()=>cn,RecommendRelay:()=>_i,RelayList:()=>Zi,Relaysets:()=>fa,Report:()=>Ri,Reporting:()=>Oi,Repost:()=>an,Seal:()=>Hr,SearchRelaysList:()=>Qi,ShortTextNote:()=>Or,Time:()=>Ia,UserEmojiList:()=>ea,UserStatuses:()=>Aa,Zap:()=>zi,ZapGoal:()=>Di,ZapRequest:()=>Wi,classifyKind:()=>Ai,isAddressableKind:()=>sn,isEphemeralKind:()=>Rr,isKind:()=>Bi,isRegularKind:()=>Nr,isReplaceableKind:()=>on});function Nr(t){return 1e3<=t&&t<1e4||[1,2,4,5,6,7,8,16,40,41,42,43,44].includes(t)}function on(t){return[0,3].includes(t)||1e4<=t&&t<2e4}function Rr(t){return 2e4<=t&&t<3e4}function sn(t){return 3e4<=t&&t<4e4}function Ai(t){return Nr(t)?"regular":on(t)?"replaceable":Rr(t)?"ephemeral":sn(t)?"parameterized":"unknown"}function Bi(t,e){const n=e instanceof Array?e:[e];return nn(t)&&n.includes(t.kind)||!1}var Si=0,Or=1,_i=2,Ii=3,Li=4,ki=5,an=6,cn=7,Ui=8,Hr=13,Mr=14,ln=16,Pr=40,qr=41,jr=42,Dr=43,Wr=44,$i=1040,zr=1059,Ti=1063,Ci=1311,Ni=1971,Ri=1984,Oi=1984,Hi=1985,Mi=4550,Pi=5999,qi=6999,ji=7e3,Di=9041,Wi=9734,zi=9735,Ki=9802,Vi=1e4,Fi=10001,Zi=10002,Gi=10003,Ji=10004,Yi=10005,Xi=10006,Qi=10007,ta=10015,ea=10030,na=10050,ra=10096,oa=13194,sa=21e3,Kr=22242,Vr=23194,ia=23195,aa=24133,fn=27235,ca=3e4,la=30001,fa=30002,ua=30003,da=30004,ha=30008,pa=30009,ga=30015,ya=30017,wa=30018,ba=30023,ma=30024,Ea=30030,va=30078,xa=30311,Aa=30315,Ba=30402,Sa=30403,_a=31922,Ia=31923,La=31924,ka=31925,Ua=31989,$a=31990,Ta=34550,Ca={};P(Ca,{getHex64:()=>un,getInt:()=>Fr,getSubscriptionId:()=>Na,matchEventId:()=>Ra,matchEventKind:()=>Ha,matchEventPubkey:()=>Oa});function un(t,e){let n=e.length+3,r=t.indexOf(`"${e}":`)+n,o=t.slice(r).indexOf('"')+r+1;return t.slice(o,o+64)}function Fr(t,e){let n=e.length,r=t.indexOf(`"${e}":`)+n+3,o=t.slice(r),s=Math.min(o.indexOf(","),o.indexOf("}"));return parseInt(o.slice(0,s),10)}function Na(t){let e=t.slice(0,22).indexOf('"EVENT"');if(e===-1)return null;let n=t.slice(e+7+1).indexOf('"');if(n===-1)return null;let r=e+7+1+n,o=t.slice(r+1,80).indexOf('"');if(o===-1)return null;let s=r+1+o;return t.slice(r+1,s)}function Ra(t,e){return e===un(t,"id")}function Oa(t,e){return e===un(t,"pubkey")}function Ha(t,e){return e===Fr(t,"kind")}var Ma={};P(Ma,{makeAuthEvent:()=>Pa});function Pa(t,e){return{kind:Kr,created_at:Math.floor(Date.now()/1e3),tags:[["relay",t],["challenge",e]],content:""}}var qa;try{qa=WebSocket}catch{}var ja;try{ja=WebSocket}catch{}var Gt={};P(Gt,{BECH32_REGEX:()=>Zr,Bech32MaxSize:()=>dn,NostrTypeGuard:()=>Da,decode:()=>we,decodeNostrURI:()=>za,encodeBytes:()=>me,naddrEncode:()=>Ja,neventEncode:()=>Ga,noteEncode:()=>Fa,nprofileEncode:()=>Za,npubEncode:()=>Va,nsecEncode:()=>Ka});var Da={isNProfile:t=>/^nprofile1[a-z\d]+$/.test(t||""),isNEvent:t=>/^nevent1[a-z\d]+$/.test(t||""),isNAddr:t=>/^naddr1[a-z\d]+$/.test(t||""),isNSec:t=>/^nsec1[a-z\d]{58}$/.test(t||""),isNPub:t=>/^npub1[a-z\d]{58}$/.test(t||""),isNote:t=>/^note1[a-z\d]+$/.test(t||""),isNcryptsec:t=>/^ncryptsec1[a-z\d]+$/.test(t||"")},dn=5e3,Zr=/[\x21-\x7E]{1,83}1[023456789acdefghjklmnpqrstuvwxyz]{6,}/;function Wa(t){const e=new Uint8Array(4);return e[0]=t>>24&255,e[1]=t>>16&255,e[2]=t>>8&255,e[3]=t&255,e}function za(t){try{return t.startsWith("nostr:")&&(t=t.substring(6)),we(t)}catch{return{type:"invalid",data:null}}}function we(t){var o,s,i,c,a,f,u;let{prefix:e,words:n}=Pt.decode(t,dn),r=new Uint8Array(Pt.fromWords(n));switch(e){case"nprofile":{let l=Te(r);if(!((o=l[0])!=null&&o[0]))throw new Error("missing TLV 0 for nprofile");if(l[0][0].length!==32)throw new Error("TLV 0 should be 32 bytes");return{type:"nprofile",data:{pubkey:K(l[0][0]),relays:l[1]?l[1].map(b=>ct.decode(b)):[]}}}case"nevent":{let l=Te(r);if(!((s=l[0])!=null&&s[0]))throw new Error("missing TLV 0 for nevent");if(l[0][0].length!==32)throw new Error("TLV 0 should be 32 bytes");if(l[2]&&l[2][0].length!==32)throw new Error("TLV 2 should be 32 bytes");if(l[3]&&l[3][0].length!==4)throw new Error("TLV 3 should be 4 bytes");return{type:"nevent",data:{id:K(l[0][0]),relays:l[1]?l[1].map(b=>ct.decode(b)):[],author:(i=l[2])!=null&&i[0]?K(l[2][0]):void 0,kind:(c=l[3])!=null&&c[0]?parseInt(K(l[3][0]),16):void 0}}}case"naddr":{let l=Te(r);if(!((a=l[0])!=null&&a[0]))throw new Error("missing TLV 0 for naddr");if(!((f=l[2])!=null&&f[0]))throw new Error("missing TLV 2 for naddr");if(l[2][0].length!==32)throw new Error("TLV 2 should be 32 bytes");if(!((u=l[3])!=null&&u[0]))throw new Error("missing TLV 3 for naddr");if(l[3][0].length!==4)throw new Error("TLV 3 should be 4 bytes");return{type:"naddr",data:{identifier:ct.decode(l[0][0]),pubkey:K(l[2][0]),kind:parseInt(K(l[3][0]),16),relays:l[1]?l[1].map(b=>ct.decode(b)):[]}}}case"nsec":return{type:e,data:r};case"npub":case"note":return{type:e,data:K(r)};default:throw new Error(`unknown prefix ${e}`)}}function Te(t){let e={},n=t;for(;n.length>0;){let r=n[0],o=n[1],s=n.slice(2,2+o);if(n=n.slice(2+o),s.length<o)throw new Error(`not enough data to read on TLV ${r}`);e[r]=e[r]||[],e[r].push(s)}return e}function Ka(t){return me("nsec",t)}function Va(t){return me("npub",Lt(t))}function Fa(t){return me("note",Lt(t))}function be(t,e){let n=Pt.toWords(e);return Pt.encode(t,n,dn)}function me(t,e){return be(t,e)}function Za(t){let e=hn({0:[Lt(t.pubkey)],1:(t.relays||[]).map(n=>tt.encode(n))});return be("nprofile",e)}function Ga(t){let e;t.kind!==void 0&&(e=Wa(t.kind));let n=hn({0:[Lt(t.id)],1:(t.relays||[]).map(r=>tt.encode(r)),2:t.author?[Lt(t.author)]:[],3:e?[new Uint8Array(e)]:[]});return be("nevent",n)}function Ja(t){let e=new ArrayBuffer(4);new DataView(e).setUint32(0,t.kind,!1);let n=hn({0:[tt.encode(t.identifier)],1:(t.relays||[]).map(r=>tt.encode(r)),2:[Lt(t.pubkey)],3:[new Uint8Array(e)]});return be("naddr",n)}function hn(t){let e=[];return Object.entries(t).reverse().forEach(([n,r])=>{r.forEach(o=>{let s=new Uint8Array(o.length+2);s.set([parseInt(n)],0),s.set([o.length],1),s.set(o,2),e.push(s)})}),ue(...e)}var Ya={};P(Ya,{decrypt:()=>Xa,encrypt:()=>Gr});function Gr(t,e,n){const r=t instanceof Uint8Array?K(t):t,o=qt.getSharedSecret(r,"02"+e),s=Jr(o);let i=Uint8Array.from(yr(16)),c=tt.encode(n),a=_r(s,i).encrypt(c),f=lt.encode(new Uint8Array(a)),u=lt.encode(new Uint8Array(i.buffer));return`${f}?iv=${u}`}function Xa(t,e,n){const r=t instanceof Uint8Array?K(t):t;let[o,s]=n.split("?iv="),i=qt.getSharedSecret(r,"02"+e),c=Jr(i),a=lt.decode(s),f=lt.decode(o),u=_r(c,a).decrypt(f);return ct.decode(u)}function Jr(t){return t.slice(1,33)}var Qa={};P(Qa,{NIP05_REGEX:()=>pn,isNip05:()=>tc,isValid:()=>rc,queryProfile:()=>Yr,searchDomain:()=>nc,useFetchImplementation:()=>ec});var pn=/^(?:([\w.+-]+)@)?([\w_-]+(\.[\w_-]+)+)$/,tc=t=>pn.test(t||""),Ee;try{Ee=fetch}catch{}function ec(t){Ee=t}async function nc(t,e=""){try{const n=`https://${t}/.well-known/nostr.json?name=${e}`,r=await Ee(n,{redirect:"manual"});if(r.status!==200)throw Error("Wrong response code");return(await r.json()).names}catch{return{}}}async function Yr(t){var o;const e=t.match(pn);if(!e)return null;const[,n="_",r]=e;try{const s=`https://${r}/.well-known/nostr.json?name=${n}`,i=await Ee(s,{redirect:"manual"});if(i.status!==200)throw Error("Wrong response code");const c=await i.json(),a=c.names[n];return a?{pubkey:a,relays:(o=c.relays)==null?void 0:o[a]}:null}catch{return null}}async function rc(t,e){const n=await Yr(e);return n?n.pubkey===t:!1}var oc={};P(oc,{parse:()=>sc});function sc(t){const e={reply:void 0,root:void 0,mentions:[],profiles:[],quotes:[]};let n,r;for(let o=t.tags.length-1;o>=0;o--){const s=t.tags[o];if(s[0]==="e"&&s[1]){const[i,c,a,f,u]=s,l={id:c,relays:a?[a]:[],author:u};if(f==="root"){e.root=l;continue}if(f==="reply"){e.reply=l;continue}if(f==="mention"){e.mentions.push(l);continue}n?r=l:n=l,e.mentions.push(l);continue}if(s[0]==="q"&&s[1]){const[i,c,a]=s;e.quotes.push({id:c,relays:a?[a]:[]})}if(s[0]==="p"&&s[1]){e.profiles.push({pubkey:s[1],relays:s[2]?[s[2]]:[]});continue}}return e.root||(e.root=r||n||e.reply),e.reply||(e.reply=n||e.root),[e.reply,e.root].forEach(o=>{if(!o)return;let s=e.mentions.indexOf(o);if(s!==-1&&e.mentions.splice(s,1),o.author){let i=e.profiles.find(c=>c.pubkey===o.author);i&&i.relays&&(o.relays||(o.relays=[]),i.relays.forEach(c=>{var a;((a=o.relays)==null?void 0:a.indexOf(c))===-1&&o.relays.push(c)}),i.relays=o.relays)}}),e.mentions.forEach(o=>{if(o.author){let s=e.profiles.find(i=>i.pubkey===o.author);s&&s.relays&&(o.relays||(o.relays=[]),s.relays.forEach(i=>{o.relays.indexOf(i)===-1&&o.relays.push(i)}),s.relays=o.relays)}}),e}var ic={};P(ic,{fetchRelayInformation:()=>cc,useFetchImplementation:()=>ac});var Xr;try{Xr=fetch}catch{}function ac(t){Xr=t}async function cc(t){return await(await fetch(t.replace("ws://","http://").replace("wss://","https://"),{headers:{Accept:"application/nostr+json"}})).json()}var lc={};P(lc,{fastEventHash:()=>to,getPow:()=>Qr,minePow:()=>fc});function Qr(t){let e=0;for(let n=0;n<64;n+=8){const r=parseInt(t.substring(n,n+8),16);if(r===0)e+=32;else{e+=Math.clz32(r);break}}return e}function fc(t,e){let n=0;const r=t,o=["nonce",n.toString(),e.toString()];for(r.tags.push(o);;){const s=Math.floor(new Date().getTime()/1e3);if(s!==r.created_at&&(n=0,r.created_at=s),o[1]=(++n).toString(),r.id=to(r),Qr(r.id)>=e)break}return r}function to(t){return K(jt(tt.encode(JSON.stringify([0,t.pubkey,t.created_at,t.kind,t.tags,t.content]))))}var uc={};P(uc,{unwrapEvent:()=>Ac,unwrapManyEvents:()=>Bc,wrapEvent:()=>po,wrapManyEvents:()=>xc});var dc={};P(dc,{createRumor:()=>lo,createSeal:()=>fo,createWrap:()=>uo,unwrapEvent:()=>mn,unwrapManyEvents:()=>ho,wrapEvent:()=>oe,wrapManyEvents:()=>Ec});var hc={};P(hc,{decrypt:()=>bn,encrypt:()=>wn,getConversationKey:()=>gn,v2:()=>bc});var eo=1,no=65535;function gn(t,e){const n=qt.getSharedSecret(t,"02"+e).subarray(1,33);return ui(jt,n,"nip44-v2")}function ro(t,e){const n=di(jt,t,e,76);return{chacha_key:n.subarray(0,32),chacha_nonce:n.subarray(32,44),hmac_key:n.subarray(44,76)}}function yn(t){if(!Number.isSafeInteger(t)||t<1)throw new Error("expected positive integer");if(t<=32)return 32;const e=1<<Math.floor(Math.log2(t-1))+1,n=e<=256?32:e/8;return n*(Math.floor((t-1)/n)+1)}function pc(t){if(!Number.isSafeInteger(t)||t<eo||t>no)throw new Error("invalid plaintext size: must be between 1 and 65535 bytes");const e=new Uint8Array(2);return new DataView(e.buffer).setUint16(0,t,!1),e}function gc(t){const e=tt.encode(t),n=e.length,r=pc(n),o=new Uint8Array(yn(n)-n);return ue(r,e,o)}function yc(t){const e=new DataView(t.buffer).getUint16(0),n=t.subarray(2,2+e);if(e<eo||e>no||n.length!==e||t.length!==2+yn(e))throw new Error("invalid padding");return ct.decode(n)}function oo(t,e,n){if(n.length!==32)throw new Error("AAD associated data must be 32 bytes");const r=ue(n,e);return he(jt,t,r)}function wc(t){if(typeof t!="string")throw new Error("payload must be a valid string");const e=t.length;if(e<132||e>87472)throw new Error("invalid payload length: "+e);if(t[0]==="#")throw new Error("unknown encryption version");let n;try{n=lt.decode(t)}catch(s){throw new Error("invalid base64: "+s.message)}const r=n.length;if(r<99||r>65603)throw new Error("invalid data length: "+r);const o=n[0];if(o!==2)throw new Error("unknown encryption version "+o);return{nonce:n.subarray(1,33),ciphertext:n.subarray(33,-32),mac:n.subarray(-32)}}function wn(t,e,n=yr(32)){const{chacha_key:r,chacha_nonce:o,hmac_key:s}=ro(e,n),i=gc(t),c=Ur(r,o,i),a=oo(s,c,n);return lt.encode(ue(new Uint8Array([2]),n,c,a))}function bn(t,e){const{nonce:n,ciphertext:r,mac:o}=wc(t),{chacha_key:s,chacha_nonce:i,hmac_key:c}=ro(e,n),a=oo(c,r,n);if(!Vs(a,o))throw new Error("invalid MAC");const f=Ur(s,i,r);return yc(f)}var bc={utils:{getConversationKey:gn,calcPaddedLen:yn},encrypt:wn,decrypt:bn},mc=2*24*60*60,so=()=>Math.round(Date.now()/1e3),io=()=>Math.round(so()-Math.random()*mc),ao=(t,e)=>gn(t,e),co=(t,e,n)=>wn(JSON.stringify(t),ao(e,n)),zn=(t,e)=>JSON.parse(bn(t.content,ao(e,t.pubkey)));function lo(t,e){const n={created_at:so(),content:"",tags:[],...t,pubkey:ge(e)};return n.id=Xt(n),n}function fo(t,e,n){return et({kind:Hr,content:co(t,e,n),created_at:io(),tags:[]},e)}function uo(t,e){const n=Cr();return et({kind:zr,content:co(t,n,e),created_at:io(),tags:[["p",e]]},n)}function oe(t,e,n){const r=lo(t,e),o=fo(r,e,n);return uo(o,n)}function Ec(t,e,n){if(!n||n.length===0)throw new Error("At least one recipient is required.");const r=ge(e),o=[oe(t,e,r)];return n.forEach(s=>{o.push(oe(t,e,s))}),o}function mn(t,e){const n=zn(t,e);return zn(n,e)}function ho(t,e){let n=[];return t.forEach(r=>{n.push(mn(r,e))}),n.sort((r,o)=>r.created_at-o.created_at),n}function vc(t,e,n,r){const o={created_at:Math.ceil(Date.now()/1e3),kind:Mr,tags:[],content:e};return(Array.isArray(t)?t:[t]).forEach(({publicKey:i,relayUrl:c})=>{o.tags.push(c?["p",i,c]:["p",i])}),r&&o.tags.push(["e",r.eventId,r.relayUrl||"","reply"]),n&&o.tags.push(["subject",n]),o}function po(t,e,n,r,o){const s=vc(e,n,r,o);return oe(s,t,e.publicKey)}function xc(t,e,n,r,o){if(!e||e.length===0)throw new Error("At least one recipient is required.");return[{publicKey:ge(t)},...e].map(i=>po(t,i,n,r,o))}var Ac=mn,Bc=ho,Sc={};P(Sc,{finishRepostEvent:()=>_c,getRepostedEvent:()=>Ic,getRepostedEventPointer:()=>go});function _c(t,e,n,r){var i;let o;const s=[...t.tags??[],["e",e.id,n],["p",e.pubkey]];return e.kind===Or?o=an:(o=ln,s.push(["k",String(e.kind)])),et({kind:o,tags:s,content:t.content===""||(i=e.tags)!=null&&i.find(c=>c[0]==="-")?"":JSON.stringify(e),created_at:t.created_at},r)}function go(t){if(![an,ln].includes(t.kind))return;let e,n;for(let r=t.tags.length-1;r>=0&&(e===void 0||n===void 0);r--){const o=t.tags[r];o.length>=2&&(o[0]==="e"&&e===void 0?e=o:o[0]==="p"&&n===void 0&&(n=o))}if(e!==void 0)return{id:e[1],relays:[e[2],n==null?void 0:n[2]].filter(r=>typeof r=="string"),author:n==null?void 0:n[1]}}function Ic(t,{skipVerification:e}={}){const n=go(t);if(n===void 0||t.content==="")return;let r;try{r=JSON.parse(t.content)}catch{return}if(r.id===n.id&&!(!e&&!ye(r)))return r}var Lc={};P(Lc,{NOSTR_URI_REGEX:()=>En,parse:()=>Uc,test:()=>kc});var En=new RegExp(`nostr:(${Zr.source})`);function kc(t){return typeof t=="string"&&new RegExp(`^${En.source}$`).test(t)}function Uc(t){const e=t.match(new RegExp(`^${En.source}$`));if(!e)throw new Error(`Invalid Nostr URI: ${t}`);return{uri:e[0],value:e[1],decoded:we(e[1])}}var $c={};P($c,{finishReactionEvent:()=>Tc,getReactedEventPointer:()=>Cc});function Tc(t,e,n){const r=e.tags.filter(o=>o.length>=2&&(o[0]==="e"||o[0]==="p"));return et({...t,kind:cn,tags:[...t.tags??[],...r,["e",e.id],["p",e.pubkey]],content:t.content??"+"},n)}function Cc(t){if(t.kind!==cn)return;let e,n;for(let r=t.tags.length-1;r>=0&&(e===void 0||n===void 0);r--){const o=t.tags[r];o.length>=2&&(o[0]==="e"&&e===void 0?e=o:o[0]==="p"&&n===void 0&&(n=o))}if(!(e===void 0||n===void 0))return{id:e[1],relays:[e[2],n[2]].filter(r=>r!==void 0),author:n[1]}}var Nc={};P(Nc,{parse:()=>Oc});var Rc=/\W/m,Kn=/\W |\W$|$|,| /m;function*Oc(t){const e=t.length;let n=0,r=0;for(;r<e;){let o=t.indexOf(":",r);if(o===-1)break;if(t.substring(o-5,o)==="nostr"){const s=t.substring(o+60).match(Rc),i=s?o+60+s.index:e;try{let c,{data:a,type:f}=we(t.substring(o+1,i));switch(f){case"npub":c={pubkey:a};break;case"nsec":case"note":r=i+1;continue;default:c=a}n!==o-5&&(yield{type:"text",text:t.substring(n,o-5)}),yield{type:"reference",pointer:c},r=i,n=r;continue}catch{r=o+1;continue}}else if(t.substring(o-5,o)==="https"||t.substring(o-4,o)==="http"){const s=t.substring(o+4).match(Kn),i=s?o+4+s.index:e,c=t[o-1]==="s"?5:4;try{let a=new URL(t.substring(o-c,i));if(a.hostname.indexOf(".")===-1)throw new Error("invalid url");if(n!==o-c&&(yield{type:"text",text:t.substring(n,o-c)}),a.pathname.endsWith(".png")||a.pathname.endsWith(".jpg")||a.pathname.endsWith(".jpeg")||a.pathname.endsWith(".gif")||a.pathname.endsWith(".webp")){yield{type:"image",url:a.toString()},r=i,n=r;continue}if(a.pathname.endsWith(".mp4")||a.pathname.endsWith(".avi")||a.pathname.endsWith(".webm")||a.pathname.endsWith(".mkv")){yield{type:"video",url:a.toString()},r=i,n=r;continue}if(a.pathname.endsWith(".mp3")||a.pathname.endsWith(".aac")||a.pathname.endsWith(".ogg")||a.pathname.endsWith(".opus")){yield{type:"audio",url:a.toString()},r=i,n=r;continue}yield{type:"url",url:a.toString()},r=i,n=r;continue}catch{r=i+1;continue}}else if(t.substring(o-3,o)==="wss"||t.substring(o-2,o)==="ws"){const s=t.substring(o+4).match(Kn),i=s?o+4+s.index:e,c=t[o-1]==="s"?3:2;try{let a=new URL(t.substring(o-c,i));if(a.hostname.indexOf(".")===-1)throw new Error("invalid ws url");n!==o-c&&(yield{type:"text",text:t.substring(n,o-c)}),yield{type:"relay",url:a.toString()},r=i,n=r;continue}catch{r=i+1;continue}}else{r=o+1;continue}}n!==e&&(yield{type:"text",text:t.substring(n)})}var Hc={};P(Hc,{channelCreateEvent:()=>Mc,channelHideMessageEvent:()=>jc,channelMessageEvent:()=>qc,channelMetadataEvent:()=>Pc,channelMuteUserEvent:()=>Dc});var Mc=(t,e)=>{let n;if(typeof t.content=="object")n=JSON.stringify(t.content);else if(typeof t.content=="string")n=t.content;else return;return et({kind:Pr,tags:[...t.tags??[]],content:n,created_at:t.created_at},e)},Pc=(t,e)=>{let n;if(typeof t.content=="object")n=JSON.stringify(t.content);else if(typeof t.content=="string")n=t.content;else return;return et({kind:qr,tags:[["e",t.channel_create_event_id],...t.tags??[]],content:n,created_at:t.created_at},e)},qc=(t,e)=>{const n=[["e",t.channel_create_event_id,t.relay_url,"root"]];return t.reply_to_channel_message_event_id&&n.push(["e",t.reply_to_channel_message_event_id,t.relay_url,"reply"]),et({kind:jr,tags:[...n,...t.tags??[]],content:t.content,created_at:t.created_at},e)},jc=(t,e)=>{let n;if(typeof t.content=="object")n=JSON.stringify(t.content);else if(typeof t.content=="string")n=t.content;else return;return et({kind:Dr,tags:[["e",t.channel_message_event_id],...t.tags??[]],content:n,created_at:t.created_at},e)},Dc=(t,e)=>{let n;if(typeof t.content=="object")n=JSON.stringify(t.content);else if(typeof t.content=="string")n=t.content;else return;return et({kind:Wr,tags:[["p",t.pubkey_to_mute],...t.tags??[]],content:n,created_at:t.created_at},e)},Wc={};P(Wc,{EMOJI_SHORTCODE_REGEX:()=>yo,matchAll:()=>zc,regex:()=>vn,replaceAll:()=>Kc});var yo=/:(\w+):/,vn=()=>new RegExp(`\\B${yo.source}\\B`,"g");function*zc(t){const e=t.matchAll(vn());for(const n of e)try{const[r,o]=n;yield{shortcode:r,name:o,start:n.index,end:n.index+r.length}}catch{}}function Kc(t,e){return t.replaceAll(vn(),(n,r)=>e({shortcode:n,name:r}))}var Vc={};P(Vc,{useFetchImplementation:()=>Fc,validateGithub:()=>Zc});var xn;try{xn=fetch}catch{}function Fc(t){xn=t}async function Zc(t,e,n){try{return await(await xn(`https://gist.github.com/${e}/${n}/raw`)).text()===`Verifying that I control the following Nostr public key: ${t}`}catch{return!1}}var Gc={};P(Gc,{makeNwcRequestEvent:()=>Yc,parseConnectionString:()=>Jc});function Jc(t){const{host:e,pathname:n,searchParams:r}=new URL(t),o=n||e,s=r.get("relay"),i=r.get("secret");if(!o||!s||!i)throw new Error("invalid connection string");return{pubkey:o,relay:s,secret:i}}async function Yc(t,e,n){const o=Gr(e,t,JSON.stringify({method:"pay_invoice",params:{invoice:n}})),s={kind:Vr,created_at:Math.round(Date.now()/1e3),content:o,tags:[["p",t]]};return et(s,e)}var Xc={};P(Xc,{normalizeIdentifier:()=>Qc});function Qc(t){return t=t.trim().toLowerCase(),t=t.normalize("NFKC"),Array.from(t).map(e=>new RegExp("\\p{Letter}","u").test(e)||new RegExp("\\p{Number}","u").test(e)?e:"-").join("")}var tl={};P(tl,{getSatoshisAmountFromBolt11:()=>il,getZapEndpoint:()=>nl,makeZapReceipt:()=>sl,makeZapRequest:()=>rl,useFetchImplementation:()=>el,validateZapRequest:()=>ol});var An;try{An=fetch}catch{}function el(t){An=t}async function nl(t){try{let e="",{lud06:n,lud16:r}=JSON.parse(t.content);if(n){let{words:i}=Pt.decode(n,1e3),c=Pt.fromWords(i);e=ct.decode(c)}else if(r){let[i,c]=r.split("@");e=new URL(`/.well-known/lnurlp/${i}`,`https://${c}`).toString()}else return null;let s=await(await An(e)).json();if(s.allowsNostr&&s.nostrPubkey)return s.callback}catch{}return null}function rl(t){let e={kind:9734,created_at:Math.round(Date.now()/1e3),content:t.comment||"",tags:[["p","pubkey"in t?t.pubkey:t.event.pubkey],["amount",t.amount.toString()],["relays",...t.relays]]};if("event"in t){if(on(t.event.kind)){const n=["a",`${t.event.kind}:${t.event.pubkey}:`];e.tags.push(n)}else if(sn(t.event.kind)){let n=t.event.tags.find(([o,s])=>o==="d"&&s);if(!n)throw new Error("d tag not found or is empty");const r=["a",`${t.event.kind}:${t.event.pubkey}:${n[1]}`];e.tags.push(r)}e.tags.push(["k",t.event.kind.toString()])}return e}function ol(t){let e;try{e=JSON.parse(t)}catch{return"Invalid zap request JSON."}if(!nn(e))return"Zap request is not a valid Nostr event.";if(!ye(e))return"Invalid signature on zap request.";let n=e.tags.find(([s,i])=>s==="p"&&i);if(!n)return"Zap request doesn't have a 'p' tag.";if(!n[1].match(/^[a-f0-9]{64}$/))return"Zap request 'p' tag is not valid hex.";let r=e.tags.find(([s,i])=>s==="e"&&i);return r&&!r[1].match(/^[a-f0-9]{64}$/)?"Zap request 'e' tag is not valid hex.":e.tags.find(([s,i])=>s==="relays"&&i)?null:"Zap request doesn't have a 'relays' tag."}function sl({zapRequest:t,preimage:e,bolt11:n,paidAt:r}){let o=JSON.parse(t),s=o.tags.filter(([c])=>c==="e"||c==="p"||c==="a"),i={kind:9735,created_at:Math.round(r.getTime()/1e3),content:"",tags:[...s,["P",o.pubkey],["bolt11",n],["description",t]]};return e&&i.tags.push(["preimage",e]),i}function il(t){if(t.length<50)return 0;t=t.substring(0,50);const e=t.lastIndexOf("1");if(e===-1)return 0;const n=t.substring(0,e);if(!n.startsWith("lnbc"))return 0;const r=n.substring(4);if(r.length<1)return 0;const o=r[r.length-1],s=o.charCodeAt(0)-48,i=s>=0&&s<=9;let c=r.length-1;if(i&&c++,c<1)return 0;const a=parseInt(r.substring(0,c));switch(o){case"m":return a*1e5;case"u":return a*100;case"n":return a/10;case"p":return a/1e4;default:return a*1e8}}var al={};P(al,{getToken:()=>cl,hashPayload:()=>Bn,unpackEventFromToken:()=>bo,validateEvent:()=>Bo,validateEventKind:()=>Eo,validateEventMethodTag:()=>xo,validateEventPayloadTag:()=>Ao,validateEventTimestamp:()=>mo,validateEventUrlTag:()=>vo,validateToken:()=>ll});var wo="Nostr ";async function cl(t,e,n,r=!1,o){const s={kind:fn,tags:[["u",t],["method",e]],created_at:Math.round(new Date().getTime()/1e3),content:""};o&&s.tags.push(["payload",Bn(o)]);const i=await n(s);return(r?wo:"")+lt.encode(tt.encode(JSON.stringify(i)))}async function ll(t,e,n){const r=await bo(t).catch(s=>{throw s});return await Bo(r,e,n).catch(s=>{throw s})}async function bo(t){if(!t)throw new Error("Missing token");t=t.replace(wo,"");const e=ct.decode(lt.decode(t));if(!e||e.length===0||!e.startsWith("{"))throw new Error("Invalid token");return JSON.parse(e)}function mo(t){return t.created_at?Math.round(new Date().getTime()/1e3)-t.created_at<60:!1}function Eo(t){return t.kind===fn}function vo(t,e){const n=t.tags.find(r=>r[0]==="u");return n?n.length>0&&n[1]===e:!1}function xo(t,e){const n=t.tags.find(r=>r[0]==="method");return n?n.length>0&&n[1].toLowerCase()===e.toLowerCase():!1}function Bn(t){const e=jt(tt.encode(JSON.stringify(t)));return K(e)}function Ao(t,e){const n=t.tags.find(o=>o[0]==="payload");if(!n)return!1;const r=Bn(e);return n.length>0&&n[1]===r}async function Bo(t,e,n,r){if(!ye(t))throw new Error("Invalid nostr event, signature invalid");if(!Eo(t))throw new Error("Invalid nostr event, kind invalid");if(!mo(t))throw new Error("Invalid nostr event, created_at timestamp invalid");if(!vo(t,e))throw new Error("Invalid nostr event, url tag invalid");if(!xo(t,n))throw new Error("Invalid nostr event, method tag invalid");if(r&&typeof r=="object"&&Object.keys(r).length>0&&!Ao(t,r))throw new Error("Invalid nostr event, payload tag does not match request body hash");return!0}function fl(t="token"){try{return se.keyFromNsec(localStorage.getItem(t))}catch{const e=se.randomKey();return localStorage.setItem(t,e.sec),e}}const se={keyFromNsec:t=>({pub:ul(t),sec:t,sign:e=>So(e,t)}),randomKey:()=>{const t=Gt.nsecEncode(Cr());return se.keyFromNsec(t)},checkEvent:t=>ye(t)};function ul(t){const e=Gt.decode(t);if(e.type!=="nsec")throw new Error("Invalid secret key");const n=Gt.npubEncode(ge(e.data));if(n.startsWith("npub1"))return n;throw new Error("Invalid public key")}const So=(t,e)=>{let n={kind:1,tags:[],content:t,created_at:Math.floor(Date.now()/1e3)};return et(n,Gt.decode(e).data)},F=(t,e,n="",r)=>{const o=document.createElement(t);return o.innerText=e,n&&o.classList.add(...n.split(".").filter(s=>s)),r&&Object.entries(r).forEach(([s,i])=>{s==="children"?i.forEach(c=>o.appendChild(c)):s==="eventListeners"?Object.entries(i).forEach(([c,a])=>{o.addEventListener(c,a)}):s==="color"||s==="background"?o.style[s]=i:o[s]=i}),o},Vn=t=>{const e=F("div","","popup-background");return e.appendChild(t),document.body.appendChild(e),e.onclick=()=>{e.remove()},t.classList.add("popup-dialog"),e.appendChild(F("div","close","popup-close",{onclick:()=>{e.remove()}})),t.onclick=n=>{n.stopPropagation()},()=>e.remove()};class Fn{constructor(e){gt(this,"value");gt(this,"listeners",[]);this.value=e}get(){return this.value}set(e,n=!1){if(!(!n&&e===this.value)){for(const r of this.listeners)r(e);this.value=e}}update(e,n=!1){const r=e(this.value);this.set(r,n)}subscribe(e){this.listeners.push(e),e(this.value)}subscribeLater(e){this.listeners.push(e)}}const _o=async t=>{const e=await crypto.subtle.digest("SHA-256",new TextEncoder().encode(t));return Array.from(new Uint8Array(e)).map(r=>r.toString(16).padStart(2,"0")).join("")};async function Zn(t,e,n){async function r(s){const i=So(JSON.stringify(s),n.sec),c=await fetch(t,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)});if(c.ok)return JSON.parse(await c.json());throw new Error("Failed to send request:"+c.status)}const o=await hl(e);return await r({pubkey:n.pub,tag:"publish",app:o}),await r({pubkey:n.pub,tag:"host",appHash:o.hash,allowed:!0}),async(s,i,c=null)=>{const a=await dl(i,o),f={tag:"call",pubkey:n.pub,appHash:o.hash,lamHash:a,host:s,argument:c};return await r(f)}}function Io(t,e){return _o(t+e)}async function dl(t,e){const n=await Io(t.toString(),e.hash);if(!Object.values(e.apiHashes).includes(n))throw new Error("illegal lambda");return n}async function hl(t){const e=t.getCtx.toString(),n=Object.fromEntries(Object.entries(t.api).map(([s,i])=>[s,i.toString()])),r=await _o(JSON.stringify({getCtx:e,api:n})),o={};for(const[s,i]of Object.entries(n))o[s]=await Io(i.toString(),r);return{getCtx:e,api:n,hash:r,apiHashes:o}}const Nt=se.keyFromNsec("nsec1qp3y43jmsdr665dc2gxmaxm6e5pqtyhqdr3zsfa902j2vr3tcpysrwnux0"),Vt=document.body,G={getCtx:t=>({msgs:t.getTable("msgs",[]),username:t.getTable("username","anonynmous"),followers:t.getTable("followers",[]),follows:t.getTable("follows",[])}),api:{sendMsg:async(t,e)=>{const n={self:t.self,other:t.other,content:e};await t.msgs.update(r=>[...r,n]),await t.msgs.other.update(r=>[...r,n])},seeMsgs:(t,e)=>t.msgs.get(),setUsername:(t,e)=>t.username.set(e),getUsername:(t,e)=>t.username.other.get(),follow:async t=>{t.followers.other.update(e=>[...e,t.self]),t.follows.update(e=>[...e,t.other])},unfollow:async t=>{t.followers.other.update(e=>e.filter(n=>n!==t.self)),t.follows.update(e=>e.filter(n=>n!==t.other))},getFollowers:t=>t.followers.other.get(),getFollows:t=>t.follows.other.get()}};let ie="https://lamboxserver.duckdns.org";ie="http://localhost:8080";ie="https://lambox.chickenkiller.com/";const Rt=fl();(async()=>(await Zn(ie,G,Nt).then(async t=>{t(Nt.pub,G.api.setUsername,"bob")}),Zn(ie,G,Rt).then(async t=>{const e=F("h1","Logged in as ");Vt.appendChild(e);const n=F("button","","");n.onclick=()=>{const h=F("div",""),g=Vn(h);h.appendChild(F("h2","Change Username"));const d=F("input","");d.value=o.get(),d.addEventListener("keydown",async p=>{p.key==="Enter"&&(t(Rt.pub,G.api.setUsername,d.value).then(()=>{o.set(d.value)}),g())}),d.focus(),h.appendChild(d)},e.appendChild(n);const r=new Fn(Nt.pub),o=new Fn("anonynmous");t(Rt.pub,G.api.getUsername).then(h=>{o.set(h)}),o.subscribe(h=>{n.innerHTML=h});const s=new Map,i=async h=>{if(s.has(h))return s.get(h);const g=await t(h,G.api.getUsername);return s.set(h,g),g},c=F("button","chatting with","",{onclick:()=>{const h=F("div","");h.appendChild(F("h2","active users"));const g=Vn(h);s.forEach((d,p)=>{const y=F("p",d,"",{onclick:async()=>{r.set(p),u(),g()}});h.appendChild(y)})}});Vt.appendChild(c),r.subscribe(async h=>{i(h).then(g=>{c.innerHTML=`Chatting with ${g}`})});const a=F("div","");Vt.appendChild(a);const f=F("input","");f.setAttribute("type","text"),f.setAttribute("placeholder","Type a message"),Vt.appendChild(f),t(Nt.pub,G.api.follow).then(()=>{console.log("following bob"),t(Nt.pub,G.api.getFollowers).then(h=>{h.forEach(i),console.log("followers",h)}),t(Nt.pub,G.api.getFollows).then(h=>{h.forEach(i),console.log("follows",h)}),t(Rt.pub,G.api.getFollowers).then(h=>{h.forEach(i),console.log("my followers",h)}),t(Rt.pub,G.api.getFollows).then(h=>{h.forEach(i),console.log("my follows",h)})});const u=()=>t(Rt.pub,G.api.seeMsgs).then(async h=>{a.innerText="";for(let g of h){if(g.self!==r.get()&&g.other!==r.get())continue;const d=await i(g.self),p=await i(g.other);a.appendChild(F("p",`${d} -> ${p}: ${g.content}`))}});async function l(){const h=f.value;h&&(await t(r.get(),G.api.sendMsg,h),u(),f.value="")}const b=F("button","send");b.onclick=()=>l(),f.addEventListener("keydown",async h=>{h.key==="Enter"&&!h.shiftKey&&(h.preventDefault(),await l())}),Vt.appendChild(b),u()})))();
